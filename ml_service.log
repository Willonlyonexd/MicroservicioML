#12025-05-29 23:49:41.442 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-29 23:49:41.442 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-29 23:49:41.789 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-29 23:49:41.790 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.18 segundos
2025-05-29 23:51:14.049 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-29 23:51:14.050 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-29 23:51:14.284 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-29 23:51:14.285 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-29 23:51:17.181 | INFO     | __main__:main:260 - Iniciando Restaurant ML Microservice v0.1.0
2025-05-29 23:51:17.182 | INFO     | __main__:main:261 - Modo desarrollo: True
2025-05-29 23:51:17.183 | INFO     | __main__:test_connections:17 - Probando conexiones a bases de datos...
2025-05-29 23:51:17.184 | INFO     | __main__:test_connections:24 - Conexión a MongoDB funciona correctamente: versión 8.0.6
2025-05-29 23:51:17.187 | DEBUG    | utils:wrapper:35 - Función execute_query ejecutada en 0.00 segundos
2025-05-29 23:51:17.187 | INFO     | __main__:test_connections:33 - Conexión a PostgreSQL funciona correctamente
2025-05-29 23:51:17.189 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedidos
2025-05-29 23:51:17.190 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_hora_-1' creado en raw_pedidos
2025-05-29 23:51:17.192 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_detalle_id_1' creado en raw_pedido_detalles
2025-05-29 23:51:17.194 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedido_detalles
2025-05-29 23:51:17.196 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_pedido_detalles
2025-05-29 23:51:17.197 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_productos
2025-05-29 23:51:17.199 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en raw_productos
2025-05-29 23:51:17.200 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_1_producto_id_1' creado en ventas_diarias
2025-05-29 23:51:17.201 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en ventas_diarias
2025-05-29 23:51:17.203 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en ventas_diarias
2025-05-29 23:51:17.204 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_table_name_1' creado en sync_status
2025-05-29 23:51:17.205 | INFO     | db.models:create_indexes:145 - Índices creados para todas las colecciones
2025-05-29 23:51:17.205 | INFO     | __main__:main:276 - Sincronización desactivada. Usando datos existentes en MongoDB para ML.
2025-05-29 23:51:17.206 | INFO     | __main__:run_ml_forecast:109 - Iniciando módulo de forecasting...
2025-05-29 23:51:17.206 | INFO     | __main__:run_ml_forecast:133 - Iniciando entrenamiento de nuevo modelo general...
2025-05-29 23:51:17.207 | INFO     | __main__:run_ml_forecast:146 - Entrenando en CPU
2025-05-29 23:51:23.029 | INFO     | __main__:run_ml_forecast:153 - Entrenamiento del modelo general completado en 5.82 segundos
2025-05-29 23:51:23.030 | INFO     | __main__:run_ml_forecast:157 - Guardando modelo general entrenado...
2025-05-29 23:51:23.072 | INFO     | __main__:run_ml_forecast:160 - Modelo general guardado en models/forecast
2025-05-29 23:51:23.073 | INFO     | __main__:run_ml_forecast:167 - Iniciando entrenamiento de modelos para los top 10 productos...
2025-05-29 23:51:23.298 | INFO     | __main__:run_ml_forecast:178 - Entrenamiento de 0/0 modelos de productos completado en 0.22 segundos
2025-05-29 23:51:23.299 | INFO     | __main__:run_ml_forecast:192 - Generando predicciones generales...
2025-05-29 23:51:23.706 | INFO     | __main__:run_ml_forecast:194 - Predicciones generales generadas para los próximos 7 días
2025-05-29 23:51:23.707 | INFO     | __main__:run_ml_forecast:197 - Guardando predicciones generales en MongoDB...
2025-05-29 23:51:23.715 | INFO     | __main__:run_ml_forecast:221 - Generando visualización de predicciones generales...
2025-05-29 23:51:25.015 | INFO     | __main__:run_ml_forecast:226 - Visualización general guardada en plots\forecast_20250529_235124.png
2025-05-29 23:51:25.016 | INFO     | __main__:run_ml_forecast:244 - Proceso de forecasting completado exitosamente
2025-05-29 23:51:25.019 | INFO     | __main__:main:288 - Módulo ML ejecutado correctamente. Resultados disponibles en MongoDB.
2025-05-29 23:51:25.022 | INFO     | __main__:main:294 - Modo desarrollo: Programa en ejecución. Presiona Ctrl+C para terminar.
2025-05-30 00:01:58.556 | INFO     | __main__:main:299 - Programa interrumpido por el usuario
2025-05-30 00:01:58.556 | INFO     | __main__:main:303 - Servicio finalizado. Cerrando conexiones...
2025-05-30 00:01:58.558 | INFO     | etl.extract:close:328 - Conexión a PostgreSQL cerrada
2025-05-30 00:01:58.560 | INFO     | db.mongo_client:close:194 - Conexión a MongoDB cerrada
2025-05-30 00:02:02.239 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:02:02.239 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-30 00:02:02.483 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:02:02.484 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-30 00:02:26.762 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:02:26.763 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-30 00:02:27.011 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:02:27.012 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-30 00:04:28.873 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:04:28.874 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-30 00:04:29.104 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:04:29.104 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-30 00:07:00.813 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:07:00.814 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.04 segundos
2025-05-30 00:07:01.043 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:07:01.044 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-30 00:11:24.209 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:11:24.209 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-30 00:11:24.440 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:11:24.440 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-30 00:12:01.035 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:12:01.036 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-30 00:12:01.275 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:12:01.275 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-30 00:12:46.398 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:12:46.399 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-30 00:12:46.647 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:12:46.648 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.08 segundos
2025-05-30 00:13:33.847 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:13:33.847 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-30 00:13:34.243 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:13:34.245 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.12 segundos
2025-05-30 00:15:58.679 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:15:58.680 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-30 00:15:58.925 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:15:58.926 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-30 00:16:55.456 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:16:55.457 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.03 segundos
2025-05-30 00:16:55.684 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:16:55.684 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.06 segundos
2025-05-30 00:20:47.143 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:20:47.143 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-30 00:20:47.366 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:20:47.367 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.06 segundos
2025-05-30 00:27:03.042 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:27:03.042 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.04 segundos
2025-05-30 00:27:03.269 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:27:03.270 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-30 00:29:11.807 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 00:29:11.807 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.03 segundos
2025-05-30 00:29:12.061 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 00:29:12.062 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-30 00:29:15.226 | INFO     | __main__:main:309 - Iniciando Restaurant ML Microservice v0.1.0
2025-05-30 00:29:15.227 | INFO     | __main__:main:310 - Modo desarrollo: True
2025-05-30 00:29:15.228 | INFO     | __main__:test_connections:63 - Probando conexiones a bases de datos...
2025-05-30 00:29:15.230 | INFO     | __main__:test_connections:70 - Conexión a MongoDB funciona correctamente: versión 8.0.6
2025-05-30 00:29:15.232 | DEBUG    | utils:wrapper:35 - Función execute_query ejecutada en 0.00 segundos
2025-05-30 00:29:15.233 | INFO     | __main__:test_connections:79 - Conexión a PostgreSQL funciona correctamente
2025-05-30 00:29:15.234 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedidos
2025-05-30 00:29:15.236 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_hora_-1' creado en raw_pedidos
2025-05-30 00:29:15.237 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_detalle_id_1' creado en raw_pedido_detalles
2025-05-30 00:29:15.238 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedido_detalles
2025-05-30 00:29:15.240 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_pedido_detalles
2025-05-30 00:29:15.242 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_productos
2025-05-30 00:29:15.243 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en raw_productos
2025-05-30 00:29:15.244 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_1_producto_id_1' creado en ventas_diarias
2025-05-30 00:29:15.246 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en ventas_diarias
2025-05-30 00:29:15.247 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en ventas_diarias
2025-05-30 00:29:15.248 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_table_name_1' creado en sync_status
2025-05-30 00:29:15.249 | INFO     | db.models:create_indexes:145 - Índices creados para todas las colecciones
2025-05-30 00:29:15.249 | INFO     | __main__:main:325 - Sincronización desactivada. Usando datos existentes en MongoDB para ML.
2025-05-30 00:29:15.250 | INFO     | __main__:run_ml_forecast:155 - Iniciando módulo de forecasting...
2025-05-30 00:29:15.250 | INFO     | __main__:diagnosticar_datos_disponibles:19 - === DIAGNÓSTICO DE DATOS EN MONGODB ===
2025-05-30 00:29:15.252 | INFO     | __main__:diagnosticar_datos_disponibles:23 - Colecciones disponibles: ['sync_status', 'raw_usuarios', 'ml_predicciones', 'raw_clientes', 'raw_productos', 'raw_reservas', 'ventas_diarias', 'raw_pedidos', 'raw_mesas', 'raw_cuenta_mesas', 'raw_pedido_detalles', 'raw_ventas', 'raw_categorias', '1']
2025-05-30 00:29:15.262 | INFO     | __main__:diagnosticar_datos_disponibles:29 - Colección raw_pedidos: 7449 documentos
2025-05-30 00:29:15.264 | INFO     | __main__:diagnosticar_datos_disponibles:34 - Ejemplo de raw_pedidos: ['_id', 'pedido_id', 'cuenta_mesa_id', 'dia_semana', 'etl_timestamp', 'fecha', 'fecha_hora', 'hora', 'nota', 'tenant_id', 'total']
2025-05-30 00:29:15.274 | INFO     | __main__:diagnosticar_datos_disponibles:29 - Colección raw_pedido_detalles: 25943 documentos
2025-05-30 00:29:15.276 | INFO     | __main__:diagnosticar_datos_disponibles:34 - Ejemplo de raw_pedido_detalles: ['_id', 'pedido_detalle_id', 'cantidad', 'estado', 'etl_timestamp', 'nota', 'pedido_id', 'precio_unitario', 'producto_id', 'subtotal', 'tenant_id']
2025-05-30 00:29:15.278 | INFO     | __main__:diagnosticar_datos_disponibles:29 - Colección raw_productos: 31 documentos
2025-05-30 00:29:15.280 | INFO     | __main__:diagnosticar_datos_disponibles:34 - Ejemplo de raw_productos: ['_id', 'producto_id', 'activo', 'categoria_id', 'codigo', 'costo', 'descripcion', 'etl_timestamp', 'imagen_url', 'nombre', 'precio', 'preparacion_minutos', 'stock', 'tenant_id', 'unidad_medida']
2025-05-30 00:29:15.281 | INFO     | __main__:diagnosticar_datos_disponibles:40 - Ejemplos de productos disponibles: [ObjectId('68387a1b34901322cba5f918'), ObjectId('6838818a34901322cba600eb'), ObjectId('6838818a34901322cba600ec'), ObjectId('6838818a34901322cba600ed'), ObjectId('6838818a34901322cba600ee')]
2025-05-30 00:29:15.304 | INFO     | __main__:diagnosticar_datos_disponibles:52 - Pedido 6838818934901322cba5f91a tiene 0 detalles
2025-05-30 00:29:15.305 | INFO     | __main__:diagnosticar_datos_disponibles:59 - === FIN DEL DIAGNÓSTICO ===
2025-05-30 00:29:15.306 | INFO     | __main__:run_ml_forecast:182 - Iniciando entrenamiento de nuevo modelo general...
2025-05-30 00:29:15.307 | INFO     | __main__:run_ml_forecast:195 - Entrenando en CPU
2025-05-30 00:29:22.916 | INFO     | __main__:run_ml_forecast:202 - Entrenamiento del modelo general completado en 7.61 segundos
2025-05-30 00:29:22.916 | INFO     | __main__:run_ml_forecast:206 - Guardando modelo general entrenado...
2025-05-30 00:29:22.975 | INFO     | __main__:run_ml_forecast:209 - Modelo general guardado en models/forecast
2025-05-30 00:29:22.975 | INFO     | __main__:run_ml_forecast:216 - Iniciando entrenamiento de modelos para los top 10 productos...
2025-05-30 00:29:23.102 | INFO     | __main__:run_ml_forecast:227 - Entrenamiento de 0/10 modelos de productos completado en 0.13 segundos
2025-05-30 00:29:23.102 | INFO     | __main__:run_ml_forecast:241 - Generando predicciones generales...
2025-05-30 00:29:23.450 | INFO     | __main__:run_ml_forecast:243 - Predicciones generales generadas para los próximos 7 días
2025-05-30 00:29:23.451 | INFO     | __main__:run_ml_forecast:246 - Guardando predicciones generales en MongoDB...
2025-05-30 00:29:23.468 | INFO     | __main__:run_ml_forecast:270 - Generando visualización de predicciones generales...
2025-05-30 00:29:24.556 | INFO     | __main__:run_ml_forecast:275 - Visualización general guardada en plots\forecast_20250530_002924.png
2025-05-30 00:29:24.558 | INFO     | __main__:run_ml_forecast:293 - Proceso de forecasting completado exitosamente
2025-05-30 00:29:24.559 | INFO     | __main__:main:337 - Módulo ML ejecutado correctamente. Resultados disponibles en MongoDB.
2025-05-30 00:29:24.560 | INFO     | __main__:main:343 - Modo desarrollo: Programa en ejecución. Presiona Ctrl+C para terminar.
2025-05-30 15:39:28.462 | ERROR    | db.mongo_client:_connect:37 - No se pudo conectar a MongoDB: localhost:27017: [WinError 10061] No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión, Timeout: 5.0s, Topology Description: <TopologyDescription id: 683a096b9f86104cd16488d6, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [WinError 10061] No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión')>]>
2025-05-30 15:40:40.857 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-30 15:40:40.858 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.04 segundos
2025-05-30 15:40:41.190 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-30 15:40:41.191 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.10 segundos
2025-05-30 15:40:46.149 | INFO     | __main__:main:309 - Iniciando Restaurant ML Microservice v0.1.0
2025-05-30 15:40:46.149 | INFO     | __main__:main:310 - Modo desarrollo: True
2025-05-30 15:40:46.150 | INFO     | __main__:test_connections:63 - Probando conexiones a bases de datos...
2025-05-30 15:40:46.151 | INFO     | __main__:test_connections:70 - Conexión a MongoDB funciona correctamente: versión 8.0.6
2025-05-30 15:40:46.153 | DEBUG    | utils:wrapper:35 - Función execute_query ejecutada en 0.00 segundos
2025-05-30 15:40:46.155 | INFO     | __main__:test_connections:79 - Conexión a PostgreSQL funciona correctamente
2025-05-30 15:40:46.159 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedidos
2025-05-30 15:40:46.161 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_hora_-1' creado en raw_pedidos
2025-05-30 15:40:46.163 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_detalle_id_1' creado en raw_pedido_detalles
2025-05-30 15:40:46.165 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedido_detalles
2025-05-30 15:40:46.166 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_pedido_detalles
2025-05-30 15:40:46.168 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_productos
2025-05-30 15:40:46.169 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en raw_productos
2025-05-30 15:40:46.171 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_1_producto_id_1' creado en ventas_diarias
2025-05-30 15:40:46.172 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en ventas_diarias
2025-05-30 15:40:46.173 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en ventas_diarias
2025-05-30 15:40:46.174 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_table_name_1' creado en sync_status
2025-05-30 15:40:46.174 | INFO     | db.models:create_indexes:145 - Índices creados para todas las colecciones
2025-05-30 15:40:46.175 | INFO     | __main__:main:325 - Sincronización desactivada. Usando datos existentes en MongoDB para ML.
2025-05-30 15:40:46.175 | INFO     | __main__:run_ml_forecast:155 - Iniciando módulo de forecasting...
2025-05-30 15:40:46.176 | INFO     | __main__:diagnosticar_datos_disponibles:19 - === DIAGNÓSTICO DE DATOS EN MONGODB ===
2025-05-30 15:40:46.178 | INFO     | __main__:diagnosticar_datos_disponibles:23 - Colecciones disponibles: ['sync_status', 'raw_usuarios', 'ml_predicciones', 'raw_clientes', 'raw_productos', 'raw_reservas', 'ventas_diarias', 'predicciones_ventas', 'raw_pedidos', 'raw_mesas', 'raw_cuenta_mesas', 'raw_pedido_detalles', 'raw_ventas', 'raw_categorias', '1']
2025-05-30 15:40:46.195 | INFO     | __main__:diagnosticar_datos_disponibles:29 - Colección raw_pedidos: 7449 documentos
2025-05-30 15:40:46.197 | INFO     | __main__:diagnosticar_datos_disponibles:34 - Ejemplo de raw_pedidos: ['_id', 'pedido_id', 'cuenta_mesa_id', 'dia_semana', 'etl_timestamp', 'fecha', 'fecha_hora', 'hora', 'nota', 'tenant_id', 'total']
2025-05-30 15:40:46.225 | INFO     | __main__:diagnosticar_datos_disponibles:29 - Colección raw_pedido_detalles: 25943 documentos
2025-05-30 15:40:46.227 | INFO     | __main__:diagnosticar_datos_disponibles:34 - Ejemplo de raw_pedido_detalles: ['_id', 'pedido_detalle_id', 'cantidad', 'estado', 'etl_timestamp', 'nota', 'pedido_id', 'precio_unitario', 'producto_id', 'subtotal', 'tenant_id']
2025-05-30 15:40:46.231 | INFO     | __main__:diagnosticar_datos_disponibles:29 - Colección raw_productos: 31 documentos
2025-05-30 15:40:46.232 | INFO     | __main__:diagnosticar_datos_disponibles:34 - Ejemplo de raw_productos: ['_id', 'producto_id', 'activo', 'categoria_id', 'codigo', 'costo', 'descripcion', 'etl_timestamp', 'imagen_url', 'nombre', 'precio', 'preparacion_minutos', 'stock', 'tenant_id', 'unidad_medida']
2025-05-30 15:40:46.234 | INFO     | __main__:diagnosticar_datos_disponibles:40 - Ejemplos de productos disponibles: [ObjectId('68387a1b34901322cba5f918'), ObjectId('6838818a34901322cba600eb'), ObjectId('6838818a34901322cba600ec'), ObjectId('6838818a34901322cba600ed'), ObjectId('6838818a34901322cba600ee')]
2025-05-30 15:40:46.253 | INFO     | __main__:diagnosticar_datos_disponibles:52 - Pedido 6838818934901322cba5f91a tiene 0 detalles
2025-05-30 15:40:46.254 | INFO     | __main__:diagnosticar_datos_disponibles:59 - === FIN DEL DIAGNÓSTICO ===
2025-05-30 15:40:46.255 | INFO     | __main__:run_ml_forecast:182 - Iniciando entrenamiento de nuevo modelo general...
2025-05-30 15:40:46.257 | INFO     | __main__:run_ml_forecast:195 - Entrenando en CPU
2025-05-30 15:40:52.353 | INFO     | __main__:run_ml_forecast:202 - Entrenamiento del modelo general completado en 6.1 segundos
2025-05-30 15:40:52.355 | INFO     | __main__:run_ml_forecast:206 - Guardando modelo general entrenado...
2025-05-30 15:40:52.385 | INFO     | __main__:run_ml_forecast:209 - Modelo general guardado en models/forecast
2025-05-30 15:40:52.386 | INFO     | __main__:run_ml_forecast:216 - Iniciando entrenamiento de modelos para los top 10 productos...
2025-05-30 15:40:52.469 | INFO     | __main__:run_ml_forecast:227 - Entrenamiento de 0/10 modelos de productos completado en 0.08 segundos
2025-05-30 15:40:52.470 | INFO     | __main__:run_ml_forecast:241 - Generando predicciones generales...
2025-05-30 15:40:52.783 | INFO     | __main__:run_ml_forecast:243 - Predicciones generales generadas para los próximos 7 días
2025-05-30 15:40:52.784 | INFO     | __main__:run_ml_forecast:246 - Guardando predicciones generales en MongoDB...
2025-05-30 15:40:52.792 | INFO     | __main__:run_ml_forecast:270 - Generando visualización de predicciones generales...
2025-05-30 15:40:53.704 | INFO     | __main__:run_ml_forecast:275 - Visualización general guardada en plots\forecast_20250530_154053.png
2025-05-30 15:40:53.706 | INFO     | __main__:run_ml_forecast:293 - Proceso de forecasting completado exitosamente
2025-05-30 15:40:53.707 | INFO     | __main__:main:337 - Módulo ML ejecutado correctamente. Resultados disponibles en MongoDB.
2025-05-30 15:40:53.708 | INFO     | __main__:main:343 - Modo desarrollo: Programa en ejecución. Presiona Ctrl+C para terminar.
2025-05-30 15:44:24.427 | INFO     | __main__:main:348 - Programa interrumpido por el usuario
2025-05-30 15:44:24.428 | INFO     | __main__:main:352 - Servicio finalizado. Cerrando conexiones...
2025-05-30 15:44:24.429 | INFO     | etl.extract:close:328 - Conexión a PostgreSQL cerrada
2025-05-30 15:44:24.430 | INFO     | db.mongo_client:close:194 - Conexión a MongoDB cerrada
