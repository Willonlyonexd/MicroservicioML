#2025-05-29 13:30:50.203 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-29 13:30:50.204 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.02 segundos
2025-05-29 13:30:50.488 | INFO     | etl.extract:_connect:71 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-29 13:30:50.489 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.08 segundos
2025-05-29 13:30:50.491 | INFO     | __main__:main:160 - Iniciando Restaurant ML Microservice v0.1.0
2025-05-29 13:30:50.492 | INFO     | __main__:main:161 - Modo desarrollo: True
2025-05-29 13:30:50.492 | INFO     | __main__:test_connections:11 - Probando conexiones a bases de datos...
2025-05-29 13:30:50.493 | INFO     | __main__:test_connections:18 - Conexión a MongoDB funciona correctamente: versión 8.0.6
2025-05-29 13:30:50.495 | DEBUG    | utils:wrapper:35 - Función execute_query ejecutada en 0.00 segundos
2025-05-29 13:30:50.495 | INFO     | __main__:test_connections:27 - Conexión a PostgreSQL funciona correctamente
2025-05-29 13:30:50.497 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedidos
2025-05-29 13:30:50.498 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_hora_-1' creado en raw_pedidos
2025-05-29 13:30:50.499 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_detalle_id_1' creado en raw_pedido_detalles
2025-05-29 13:30:50.500 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedido_detalles
2025-05-29 13:30:50.502 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_pedido_detalles
2025-05-29 13:30:50.503 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_productos
2025-05-29 13:30:50.504 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en raw_productos
2025-05-29 13:30:50.506 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_1_producto_id_1' creado en ventas_diarias
2025-05-29 13:30:50.507 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en ventas_diarias
2025-05-29 13:30:50.508 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en ventas_diarias
2025-05-29 13:30:50.509 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_table_name_1' creado en sync_status
2025-05-29 13:30:50.510 | INFO     | db.models:create_indexes:145 - Índices creados para todas las colecciones
2025-05-29 13:30:50.510 | INFO     | __main__:main:182 - Modo desarrollo: Ejecutando sincronización inicial completa...
2025-05-29 13:30:50.511 | INFO     | __main__:test_sync:44 - Probando sincronización para tenant 1...
2025-05-29 13:30:50.511 | INFO     | __main__:test_sync:55 - Sincronizando tabla: pedido...
2025-05-29 13:30:50.512 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:30:50.512 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido para tenant 1
2025-05-29 13:30:50.513 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:30:50.514 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 13:30:50.515 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:30:50.516 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:30:50.516 | INFO     | etl.extract:extract_table:106 - Sincronización completa inicial para pedido
2025-05-29 13:30:50.552 | INFO     | etl.extract:extract_table:110 - Extraídos 7449 registros de pedido para tenant 1
2025-05-29 13:30:50.553 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.04 segundos
2025-05-29 13:30:50.554 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:30:50.554 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido para tenant_id=1
2025-05-29 13:30:50.571 | INFO     | etl.transform:transform_pedido:51 - Transformados 7449 registros de pedido
2025-05-29 13:30:50.572 | DEBUG    | utils:wrapper:35 - Función transform_pedido ejecutada en 0.02 segundos
2025-05-29 13:30:50.573 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 13:30:50.573 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:31:14.612 | INFO     | etl.load:load_records:106 - Cargados 7449 registros en raw_pedidos: 0 insertados, 7449 actualizados
2025-05-29 13:31:14.613 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 24.04 segundos
2025-05-29 13:31:14.613 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:31:14.615 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 13:31:14.615 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:31:14.616 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido completada: {'status': 'success', 'table': 'pedido', 'tenant_id': 1, 'records': 7449, 'inserted': 0, 'updated': 7449, 'duration_seconds': 24.103148}
2025-05-29 13:31:14.617 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 24.11 segundos
2025-05-29 13:31:14.618 | INFO     | __main__:test_sync:65 - Sincronización de pedido completada en 24.11s: 7449 registros
2025-05-29 13:31:14.618 | INFO     | __main__:test_sync:55 - Sincronizando tabla: pedido_detalle...
2025-05-29 13:31:14.619 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:31:14.619 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido_detalle para tenant 1
2025-05-29 13:31:14.620 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:31:14.621 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 13:31:14.622 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:31:14.623 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:31:14.624 | INFO     | etl.extract:extract_table:106 - Sincronización completa inicial para pedido_detalle
2025-05-29 13:31:14.733 | INFO     | etl.extract:extract_table:110 - Extraídos 25943 registros de pedido_detalle para tenant 1
2025-05-29 13:31:14.735 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.11 segundos
2025-05-29 13:31:14.735 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:31:14.736 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido_detalle para tenant_id=1
2025-05-29 13:31:14.795 | INFO     | etl.transform:transform_pedido_detalle:85 - Transformados 25943 registros de detalle de pedido
2025-05-29 13:31:14.796 | DEBUG    | utils:wrapper:35 - Función transform_pedido_detalle ejecutada en 0.06 segundos
2025-05-29 13:31:14.796 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.06 segundos
2025-05-29 13:31:14.797 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:35:08.566 | INFO     | etl.load:load_records:106 - Cargados 25943 registros en raw_pedido_detalles: 0 insertados, 25943 actualizados
2025-05-29 13:35:08.566 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 233.77 segundos
2025-05-29 13:35:08.567 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.569 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 13:35:08.569 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.570 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido_detalle completada: {'status': 'success', 'table': 'pedido_detalle', 'tenant_id': 1, 'records': 25943, 'inserted': 0, 'updated': 25943, 'duration_seconds': 233.94988}
2025-05-29 13:35:08.578 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 233.96 segundos
2025-05-29 13:35:08.579 | INFO     | __main__:test_sync:65 - Sincronización de pedido_detalle completada en 233.96s: 25943 registros
2025-05-29 13:35:08.580 | INFO     | __main__:test_sync:55 - Sincronizando tabla: producto...
2025-05-29 13:35:08.580 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:35:08.581 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de producto para tenant 1
2025-05-29 13:35:08.581 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.583 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 13:35:08.584 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.584 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:35:08.585 | INFO     | etl.extract:extract_table:106 - Sincronización completa inicial para producto
2025-05-29 13:35:08.588 | INFO     | etl.extract:extract_table:110 - Extraídos 30 registros de producto para tenant 1
2025-05-29 13:35:08.589 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:35:08.589 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:35:08.590 | DEBUG    | utils:wrapper:81 - Ejecutando transform_producto para tenant_id=1
2025-05-29 13:35:08.590 | INFO     | etl.transform:transform_producto:123 - Transformados 30 registros de producto
2025-05-29 13:35:08.591 | DEBUG    | utils:wrapper:35 - Función transform_producto ejecutada en 0.00 segundos
2025-05-29 13:35:08.591 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:35:08.592 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:35:08.611 | INFO     | etl.load:load_records:106 - Cargados 30 registros en raw_productos: 0 insertados, 30 actualizados
2025-05-29 13:35:08.612 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.02 segundos
2025-05-29 13:35:08.613 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.615 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 13:35:08.616 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.616 | INFO     | etl.sync:sync_table:98 - Sincronización de producto completada: {'status': 'success', 'table': 'producto', 'tenant_id': 1, 'records': 30, 'inserted': 0, 'updated': 30, 'duration_seconds': 0.035776}
2025-05-29 13:35:08.617 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.04 segundos
2025-05-29 13:35:08.618 | INFO     | __main__:test_sync:65 - Sincronización de producto completada en 0.04s: 30 registros
2025-05-29 13:35:08.618 | INFO     | __main__:test_sync:55 - Sincronizando tabla: cliente...
2025-05-29 13:35:08.620 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:35:08.620 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cliente para tenant 1
2025-05-29 13:35:08.621 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.622 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 13:35:08.623 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.623 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:35:08.624 | INFO     | etl.extract:extract_table:106 - Sincronización completa inicial para cliente
2025-05-29 13:35:08.627 | INFO     | etl.extract:extract_table:110 - Extraídos 167 registros de cliente para tenant 1
2025-05-29 13:35:08.629 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:35:08.630 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:35:08.631 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cliente para tenant_id=1
2025-05-29 13:35:08.632 | INFO     | etl.transform:transform_cliente:255 - Transformados 167 registros de cliente
2025-05-29 13:35:08.632 | DEBUG    | utils:wrapper:35 - Función transform_cliente ejecutada en 0.00 segundos
2025-05-29 13:35:08.633 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:35:08.634 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:35:08.752 | INFO     | etl.load:load_records:106 - Cargados 167 registros en raw_clientes: 0 insertados, 167 actualizados
2025-05-29 13:35:08.753 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.12 segundos
2025-05-29 13:35:08.754 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.755 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 13:35:08.756 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.756 | INFO     | etl.sync:sync_table:98 - Sincronización de cliente completada: {'status': 'success', 'table': 'cliente', 'tenant_id': 1, 'records': 167, 'inserted': 0, 'updated': 167, 'duration_seconds': 0.134858}
2025-05-29 13:35:08.757 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.14 segundos
2025-05-29 13:35:08.757 | INFO     | __main__:test_sync:65 - Sincronización de cliente completada en 0.14s: 167 registros
2025-05-29 13:35:08.758 | INFO     | __main__:test_sync:55 - Sincronizando tabla: mesa...
2025-05-29 13:35:08.758 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:35:08.759 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de mesa para tenant 1
2025-05-29 13:35:08.760 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.762 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 13:35:08.763 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.763 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:35:08.764 | INFO     | etl.extract:extract_table:106 - Sincronización completa inicial para mesa
2025-05-29 13:35:08.766 | INFO     | etl.extract:extract_table:110 - Extraídos 15 registros de mesa para tenant 1
2025-05-29 13:35:08.767 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 13:35:08.768 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:35:08.769 | DEBUG    | utils:wrapper:81 - Ejecutando transform_mesa para tenant_id=1
2025-05-29 13:35:08.769 | INFO     | etl.transform:transform_mesa:286 - Transformados 15 registros de mesa
2025-05-29 13:35:08.770 | DEBUG    | utils:wrapper:35 - Función transform_mesa ejecutada en 0.00 segundos
2025-05-29 13:35:08.770 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:35:08.771 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:35:08.778 | INFO     | etl.load:load_records:106 - Cargados 15 registros en raw_mesas: 0 insertados, 15 actualizados
2025-05-29 13:35:08.779 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 13:35:08.780 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.782 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 13:35:08.782 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.783 | INFO     | etl.sync:sync_table:98 - Sincronización de mesa completada: {'status': 'success', 'table': 'mesa', 'tenant_id': 1, 'records': 15, 'inserted': 0, 'updated': 15, 'duration_seconds': 0.023028}
2025-05-29 13:35:08.783 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.03 segundos
2025-05-29 13:35:08.784 | INFO     | __main__:test_sync:65 - Sincronización de mesa completada en 0.03s: 15 registros
2025-05-29 13:35:08.784 | INFO     | __main__:test_sync:55 - Sincronizando tabla: categoria...
2025-05-29 13:35:08.785 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:35:08.785 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de categoria para tenant 1
2025-05-29 13:35:08.786 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.788 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 13:35:08.788 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.789 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:35:08.789 | INFO     | etl.extract:extract_table:106 - Sincronización completa inicial para categoria
2025-05-29 13:35:08.791 | INFO     | etl.extract:extract_table:110 - Extraídos 8 registros de categoria para tenant 1
2025-05-29 13:35:08.793 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 13:35:08.793 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:35:08.794 | DEBUG    | utils:wrapper:81 - Ejecutando transform_categoria para tenant_id=1
2025-05-29 13:35:08.794 | INFO     | etl.transform:transform_categoria:153 - Transformados 8 registros de categoría
2025-05-29 13:35:08.795 | DEBUG    | utils:wrapper:35 - Función transform_categoria ejecutada en 0.00 segundos
2025-05-29 13:35:08.796 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:35:08.797 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:35:08.801 | INFO     | etl.load:load_records:106 - Cargados 8 registros en raw_categorias: 0 insertados, 8 actualizados
2025-05-29 13:35:08.801 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 13:35:08.802 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.803 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 13:35:08.804 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.804 | INFO     | etl.sync:sync_table:98 - Sincronización de categoria completada: {'status': 'success', 'table': 'categoria', 'tenant_id': 1, 'records': 8, 'inserted': 0, 'updated': 8, 'duration_seconds': 0.01753}
2025-05-29 13:35:08.805 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 13:35:08.805 | INFO     | __main__:test_sync:65 - Sincronización de categoria completada en 0.02s: 8 registros
2025-05-29 13:35:08.805 | INFO     | __main__:test_sync:55 - Sincronizando tabla: usuario...
2025-05-29 13:35:08.806 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:35:08.806 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de usuario para tenant 1
2025-05-29 13:35:08.806 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.807 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 13:35:08.808 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.808 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:35:08.809 | INFO     | etl.extract:extract_table:106 - Sincronización completa inicial para usuario
2025-05-29 13:35:08.811 | INFO     | etl.extract:extract_table:110 - Extraídos 5 registros de usuario para tenant 1
2025-05-29 13:35:08.812 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 13:35:08.813 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:35:08.814 | WARNING  | etl.transform:batch_transform:410 - No hay método de transformación específico para usuario
2025-05-29 13:35:08.814 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:35:08.814 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:35:08.817 | INFO     | etl.load:load_records:106 - Cargados 5 registros en raw_usuarios: 0 insertados, 5 actualizados
2025-05-29 13:35:08.818 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.00 segundos
2025-05-29 13:35:08.818 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.819 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 13:35:08.820 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.820 | INFO     | etl.sync:sync_table:98 - Sincronización de usuario completada: {'status': 'success', 'table': 'usuario', 'tenant_id': 1, 'records': 5, 'inserted': 0, 'updated': 5, 'duration_seconds': 0.014597}
2025-05-29 13:35:08.821 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 13:35:08.821 | INFO     | __main__:test_sync:65 - Sincronización de usuario completada en 0.02s: 5 registros
2025-05-29 13:35:08.822 | INFO     | __main__:test_sync:55 - Sincronizando tabla: cuenta_mesa...
2025-05-29 13:35:08.822 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:35:08.822 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cuenta_mesa para tenant 1
2025-05-29 13:35:08.823 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:08.824 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 13:35:08.825 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:08.825 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:35:08.825 | INFO     | etl.extract:extract_table:106 - Sincronización completa inicial para cuenta_mesa
2025-05-29 13:35:08.855 | INFO     | etl.extract:extract_table:110 - Extraídos 5000 registros de cuenta_mesa para tenant 1
2025-05-29 13:35:08.856 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.03 segundos
2025-05-29 13:35:08.857 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:35:08.857 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cuenta_mesa para tenant_id=1
2025-05-29 13:35:08.870 | INFO     | etl.transform:transform_cuenta_mesa:206 - Transformados 5000 registros de cuenta mesa
2025-05-29 13:35:08.871 | DEBUG    | utils:wrapper:35 - Función transform_cuenta_mesa ejecutada en 0.01 segundos
2025-05-29 13:35:08.872 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 13:35:08.872 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:35:20.194 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_cuenta_mesas: 0 insertados, 5000 actualizados
2025-05-29 13:35:20.194 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 11.32 segundos
2025-05-29 13:35:20.195 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:20.197 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 13:35:20.197 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:20.198 | INFO     | etl.sync:sync_table:98 - Sincronización de cuenta_mesa completada: {'status': 'success', 'table': 'cuenta_mesa', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 11.374556}
2025-05-29 13:35:20.199 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 11.38 segundos
2025-05-29 13:35:20.200 | INFO     | __main__:test_sync:65 - Sincronización de cuenta_mesa completada en 11.38s: 5000 registros
2025-05-29 13:35:20.201 | INFO     | __main__:test_sync:55 - Sincronizando tabla: reserva...
2025-05-29 13:35:20.201 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:35:20.202 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de reserva para tenant 1
2025-05-29 13:35:20.202 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:20.204 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 13:35:20.205 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:20.206 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:35:20.206 | INFO     | etl.extract:extract_table:106 - Sincronización completa inicial para reserva
2025-05-29 13:35:20.224 | INFO     | etl.extract:extract_table:110 - Extraídos 3000 registros de reserva para tenant 1
2025-05-29 13:35:20.226 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.02 segundos
2025-05-29 13:35:20.227 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:35:20.227 | DEBUG    | utils:wrapper:81 - Ejecutando transform_reserva para tenant_id=1
2025-05-29 13:35:20.236 | INFO     | etl.transform:transform_reserva:357 - Transformados 3000 registros de reserva
2025-05-29 13:35:20.237 | DEBUG    | utils:wrapper:35 - Función transform_reserva ejecutada en 0.01 segundos
2025-05-29 13:35:20.238 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 13:35:20.238 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:35:24.995 | INFO     | etl.load:load_records:106 - Cargados 3000 registros en raw_reservas: 0 insertados, 3000 actualizados
2025-05-29 13:35:24.996 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 4.76 segundos
2025-05-29 13:35:24.997 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:24.998 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 13:35:24.999 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:25.000 | INFO     | etl.sync:sync_table:98 - Sincronización de reserva completada: {'status': 'success', 'table': 'reserva', 'tenant_id': 1, 'records': 3000, 'inserted': 0, 'updated': 3000, 'duration_seconds': 4.797748}
2025-05-29 13:35:25.000 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 4.80 segundos
2025-05-29 13:35:25.001 | INFO     | __main__:test_sync:65 - Sincronización de reserva completada en 4.8s: 3000 registros
2025-05-29 13:35:25.002 | INFO     | __main__:test_sync:55 - Sincronizando tabla: venta...
2025-05-29 13:35:25.002 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:35:25.003 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de venta para tenant 1
2025-05-29 13:35:25.003 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:25.005 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 13:35:25.005 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:25.005 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:35:25.007 | INFO     | etl.extract:extract_table:106 - Sincronización completa inicial para venta
2025-05-29 13:35:25.031 | INFO     | etl.extract:extract_table:110 - Extraídos 5000 registros de venta para tenant 1
2025-05-29 13:35:25.032 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.03 segundos
2025-05-29 13:35:25.033 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:35:25.033 | DEBUG    | utils:wrapper:81 - Ejecutando transform_venta para tenant_id=1
2025-05-29 13:35:25.042 | INFO     | etl.transform:transform_venta:389 - Transformados 5000 registros de venta
2025-05-29 13:35:25.043 | DEBUG    | utils:wrapper:35 - Función transform_venta ejecutada en 0.01 segundos
2025-05-29 13:35:25.044 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 13:35:25.045 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:35:36.013 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_ventas: 0 insertados, 5000 actualizados
2025-05-29 13:35:36.014 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 10.97 segundos
2025-05-29 13:35:36.014 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:36.016 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 13:35:36.017 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:36.017 | INFO     | etl.sync:sync_table:98 - Sincronización de venta completada: {'status': 'success', 'table': 'venta', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 11.014521}
2025-05-29 13:35:36.020 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 11.02 segundos
2025-05-29 13:35:36.020 | INFO     | __main__:test_sync:65 - Sincronización de venta completada en 11.02s: 5000 registros
2025-05-29 13:35:36.021 | INFO     | __main__:test_sync:83 - Resumen de sincronización: 10 exitosas, 0 errores, 0 omitidas
2025-05-29 13:35:36.022 | INFO     | __main__:main:189 - Iniciando servicio de sincronización 24/7...
2025-05-29 13:35:36.022 | INFO     | __main__:sync_scheduled:100 - Iniciando sincronización programada cada 60 minutos para tenant 1
2025-05-29 13:35:36.023 | INFO     | __main__:sync_scheduled:107 - Ejecutando sincronización programada...
2025-05-29 13:35:36.023 | INFO     | __main__:sync_scheduled:116 - Realizando sincronización incremental...
2025-05-29 13:35:36.024 | DEBUG    | utils:wrapper:81 - Ejecutando sync_all_tables para tenant_id=1
2025-05-29 13:35:36.025 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:35:36.025 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido para tenant 1
2025-05-29 13:35:36.026 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:35:36.028 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:36.028 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:31:14.614000
2025-05-29 13:35:36.029 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:35:36.030 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 13:35:36.031 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:35:36.031 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:35:36.032 | INFO     | etl.extract:extract_table:114 - Sincronización incremental para pedido (última sincronización: 2025-05-29 17:31:14.614000)
2025-05-29 13:35:36.037 | ERROR    | etl.extract:extract_table:167 - Error al extraer datos de pedido: (psycopg2.errors.UndefinedColumn) no existe la columna «id»
LINE 1: SELECT id FROM pedido WHERE tenant_id = 1
               ^

[SQL: SELECT id FROM pedido WHERE tenant_id = %(tenant_id)s]
[parameters: {'tenant_id': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 13:35:36.039 | INFO     | etl.extract:extract_table:172 - Intentando extracción completa como respaldo para pedido
2025-05-29 13:35:36.078 | INFO     | etl.extract:extract_table:176 - Extracción de respaldo completada: 7449 registros de pedido
2025-05-29 13:35:36.079 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.05 segundos
2025-05-29 13:35:36.080 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:35:36.080 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido para tenant_id=1
2025-05-29 13:35:36.099 | INFO     | etl.transform:transform_pedido:51 - Transformados 7449 registros de pedido
2025-05-29 13:35:36.100 | DEBUG    | utils:wrapper:35 - Función transform_pedido ejecutada en 0.02 segundos
2025-05-29 13:35:36.101 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 13:35:36.101 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:36:01.762 | INFO     | etl.load:load_records:106 - Cargados 7449 registros en raw_pedidos: 0 insertados, 7449 actualizados
2025-05-29 13:36:01.762 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 25.66 segundos
2025-05-29 13:36:01.763 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:36:01.765 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 13:36:01.766 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:36:01.766 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido completada: {'status': 'success', 'table': 'pedido', 'tenant_id': 1, 'records': 7449, 'inserted': 0, 'updated': 7449, 'duration_seconds': 25.73692}
2025-05-29 13:36:01.767 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 25.74 segundos
2025-05-29 13:36:01.768 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:36:01.769 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido_detalle para tenant 1
2025-05-29 13:36:01.769 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:36:01.771 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:36:01.772 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:35:08.568000
2025-05-29 13:36:01.773 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:36:01.775 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 13:36:01.776 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:36:01.776 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:36:01.777 | INFO     | etl.extract:extract_table:114 - Sincronización incremental para pedido_detalle (última sincronización: 2025-05-29 17:35:08.568000)
2025-05-29 13:36:01.779 | ERROR    | etl.extract:extract_table:167 - Error al extraer datos de pedido_detalle: (psycopg2.errors.UndefinedColumn) no existe la columna «id»
LINE 1: SELECT id FROM pedido_detalle WHERE tenant_id = 1
               ^

[SQL: SELECT id FROM pedido_detalle WHERE tenant_id = %(tenant_id)s]
[parameters: {'tenant_id': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 13:36:01.781 | INFO     | etl.extract:extract_table:172 - Intentando extracción completa como respaldo para pedido_detalle
2025-05-29 13:36:01.892 | INFO     | etl.extract:extract_table:176 - Extracción de respaldo completada: 25943 registros de pedido_detalle
2025-05-29 13:36:01.892 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.12 segundos
2025-05-29 13:36:01.893 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:36:01.894 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido_detalle para tenant_id=1
2025-05-29 13:36:01.936 | INFO     | etl.transform:transform_pedido_detalle:85 - Transformados 25943 registros de detalle de pedido
2025-05-29 13:36:01.937 | DEBUG    | utils:wrapper:35 - Función transform_pedido_detalle ejecutada en 0.04 segundos
2025-05-29 13:36:01.938 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.05 segundos
2025-05-29 13:36:01.938 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:39:59.872 | INFO     | etl.load:load_records:106 - Cargados 25943 registros en raw_pedido_detalles: 0 insertados, 25943 actualizados
2025-05-29 13:39:59.872 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 237.93 segundos
2025-05-29 13:39:59.873 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:39:59.875 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 13:39:59.876 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:39:59.877 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido_detalle completada: {'status': 'success', 'table': 'pedido_detalle', 'tenant_id': 1, 'records': 25943, 'inserted': 0, 'updated': 25943, 'duration_seconds': 238.103669}
2025-05-29 13:39:59.877 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 238.11 segundos
2025-05-29 13:39:59.878 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:39:59.878 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de producto para tenant 1
2025-05-29 13:39:59.879 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:39:59.880 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:39:59.881 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:35:08.614000
2025-05-29 13:39:59.882 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:39:59.883 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 13:39:59.885 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:39:59.886 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:39:59.886 | INFO     | etl.extract:extract_table:114 - Sincronización incremental para producto (última sincronización: 2025-05-29 17:35:08.614000)
2025-05-29 13:39:59.888 | ERROR    | etl.extract:extract_table:167 - Error al extraer datos de producto: (psycopg2.errors.UndefinedColumn) no existe la columna «id»
LINE 1: SELECT id FROM producto WHERE tenant_id = 1
               ^

[SQL: SELECT id FROM producto WHERE tenant_id = %(tenant_id)s]
[parameters: {'tenant_id': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 13:39:59.890 | INFO     | etl.extract:extract_table:172 - Intentando extracción completa como respaldo para producto
2025-05-29 13:39:59.891 | INFO     | etl.extract:extract_table:176 - Extracción de respaldo completada: 30 registros de producto
2025-05-29 13:39:59.893 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:39:59.893 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:39:59.894 | DEBUG    | utils:wrapper:81 - Ejecutando transform_producto para tenant_id=1
2025-05-29 13:39:59.895 | INFO     | etl.transform:transform_producto:123 - Transformados 30 registros de producto
2025-05-29 13:39:59.895 | DEBUG    | utils:wrapper:35 - Función transform_producto ejecutada en 0.00 segundos
2025-05-29 13:39:59.896 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:39:59.896 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:39:59.919 | INFO     | etl.load:load_records:106 - Cargados 30 registros en raw_productos: 0 insertados, 30 actualizados
2025-05-29 13:39:59.919 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.02 segundos
2025-05-29 13:39:59.920 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:39:59.921 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 13:39:59.922 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:39:59.922 | INFO     | etl.sync:sync_table:98 - Sincronización de producto completada: {'status': 'success', 'table': 'producto', 'tenant_id': 1, 'records': 30, 'inserted': 0, 'updated': 30, 'duration_seconds': 0.040092}
2025-05-29 13:39:59.923 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.05 segundos
2025-05-29 13:39:59.923 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:39:59.924 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cliente para tenant 1
2025-05-29 13:39:59.924 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:39:59.926 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:39:59.927 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:35:08.754000
2025-05-29 13:39:59.928 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:39:59.930 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 13:39:59.930 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:39:59.931 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:39:59.932 | INFO     | etl.extract:extract_table:114 - Sincronización incremental para cliente (última sincronización: 2025-05-29 17:35:08.754000)
2025-05-29 13:39:59.934 | ERROR    | etl.extract:extract_table:167 - Error al extraer datos de cliente: (psycopg2.errors.UndefinedColumn) no existe la columna «id»
LINE 1: SELECT id FROM cliente WHERE tenant_id = 1
               ^

[SQL: SELECT id FROM cliente WHERE tenant_id = %(tenant_id)s]
[parameters: {'tenant_id': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 13:39:59.936 | INFO     | etl.extract:extract_table:172 - Intentando extracción completa como respaldo para cliente
2025-05-29 13:39:59.938 | INFO     | etl.extract:extract_table:176 - Extracción de respaldo completada: 167 registros de cliente
2025-05-29 13:39:59.939 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:39:59.939 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:39:59.940 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cliente para tenant_id=1
2025-05-29 13:39:59.941 | INFO     | etl.transform:transform_cliente:255 - Transformados 167 registros de cliente
2025-05-29 13:39:59.941 | DEBUG    | utils:wrapper:35 - Función transform_cliente ejecutada en 0.00 segundos
2025-05-29 13:39:59.942 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:39:59.942 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:40:00.080 | INFO     | etl.load:load_records:106 - Cargados 167 registros en raw_clientes: 0 insertados, 167 actualizados
2025-05-29 13:40:00.082 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.14 segundos
2025-05-29 13:40:00.083 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:00.084 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 13:40:00.085 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.086 | INFO     | etl.sync:sync_table:98 - Sincronización de cliente completada: {'status': 'success', 'table': 'cliente', 'tenant_id': 1, 'records': 167, 'inserted': 0, 'updated': 167, 'duration_seconds': 0.158063}
2025-05-29 13:40:00.087 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.16 segundos
2025-05-29 13:40:00.088 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:40:00.088 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de mesa para tenant 1
2025-05-29 13:40:00.089 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:40:00.091 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.091 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:35:08.780000
2025-05-29 13:40:00.092 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:00.094 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 13:40:00.095 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.095 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:40:00.096 | INFO     | etl.extract:extract_table:114 - Sincronización incremental para mesa (última sincronización: 2025-05-29 17:35:08.780000)
2025-05-29 13:40:00.098 | ERROR    | etl.extract:extract_table:167 - Error al extraer datos de mesa: (psycopg2.errors.UndefinedColumn) no existe la columna «id»
LINE 1: SELECT id FROM mesa WHERE tenant_id = 1
               ^

[SQL: SELECT id FROM mesa WHERE tenant_id = %(tenant_id)s]
[parameters: {'tenant_id': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 13:40:00.100 | INFO     | etl.extract:extract_table:172 - Intentando extracción completa como respaldo para mesa
2025-05-29 13:40:00.101 | INFO     | etl.extract:extract_table:176 - Extracción de respaldo completada: 15 registros de mesa
2025-05-29 13:40:00.103 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:40:00.104 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:40:00.105 | DEBUG    | utils:wrapper:81 - Ejecutando transform_mesa para tenant_id=1
2025-05-29 13:40:00.105 | INFO     | etl.transform:transform_mesa:286 - Transformados 15 registros de mesa
2025-05-29 13:40:00.106 | DEBUG    | utils:wrapper:35 - Función transform_mesa ejecutada en 0.00 segundos
2025-05-29 13:40:00.107 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:40:00.107 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:40:00.114 | INFO     | etl.load:load_records:106 - Cargados 15 registros en raw_mesas: 0 insertados, 15 actualizados
2025-05-29 13:40:00.115 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 13:40:00.116 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:00.118 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 13:40:00.118 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.119 | INFO     | etl.sync:sync_table:98 - Sincronización de mesa completada: {'status': 'success', 'table': 'mesa', 'tenant_id': 1, 'records': 15, 'inserted': 0, 'updated': 15, 'duration_seconds': 0.026824}
2025-05-29 13:40:00.119 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.03 segundos
2025-05-29 13:40:00.120 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:40:00.120 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de categoria para tenant 1
2025-05-29 13:40:00.121 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:40:00.122 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.122 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:35:08.802000
2025-05-29 13:40:00.123 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:00.124 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 13:40:00.125 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.126 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:40:00.126 | INFO     | etl.extract:extract_table:114 - Sincronización incremental para categoria (última sincronización: 2025-05-29 17:35:08.802000)
2025-05-29 13:40:00.128 | ERROR    | etl.extract:extract_table:167 - Error al extraer datos de categoria: (psycopg2.errors.UndefinedColumn) no existe la columna «id»
LINE 1: SELECT id FROM categoria WHERE tenant_id = 1
               ^

[SQL: SELECT id FROM categoria WHERE tenant_id = %(tenant_id)s]
[parameters: {'tenant_id': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 13:40:00.129 | INFO     | etl.extract:extract_table:172 - Intentando extracción completa como respaldo para categoria
2025-05-29 13:40:00.130 | INFO     | etl.extract:extract_table:176 - Extracción de respaldo completada: 8 registros de categoria
2025-05-29 13:40:00.130 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 13:40:00.131 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:40:00.131 | DEBUG    | utils:wrapper:81 - Ejecutando transform_categoria para tenant_id=1
2025-05-29 13:40:00.132 | INFO     | etl.transform:transform_categoria:153 - Transformados 8 registros de categoría
2025-05-29 13:40:00.132 | DEBUG    | utils:wrapper:35 - Función transform_categoria ejecutada en 0.00 segundos
2025-05-29 13:40:00.133 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:40:00.134 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:40:00.138 | INFO     | etl.load:load_records:106 - Cargados 8 registros en raw_categorias: 0 insertados, 8 actualizados
2025-05-29 13:40:00.139 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 13:40:00.140 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:00.141 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 13:40:00.142 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.142 | INFO     | etl.sync:sync_table:98 - Sincronización de categoria completada: {'status': 'success', 'table': 'categoria', 'tenant_id': 1, 'records': 8, 'inserted': 0, 'updated': 8, 'duration_seconds': 0.018776}
2025-05-29 13:40:00.143 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 13:40:00.143 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:40:00.144 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de usuario para tenant 1
2025-05-29 13:40:00.144 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:40:00.146 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.146 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:35:08.818000
2025-05-29 13:40:00.147 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:00.148 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 13:40:00.148 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.149 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:40:00.150 | INFO     | etl.extract:extract_table:114 - Sincronización incremental para usuario (última sincronización: 2025-05-29 17:35:08.818000)
2025-05-29 13:40:00.151 | ERROR    | etl.extract:extract_table:167 - Error al extraer datos de usuario: (psycopg2.errors.UndefinedColumn) no existe la columna «id»
LINE 1: SELECT id FROM usuario WHERE tenant_id = 1
               ^

[SQL: SELECT id FROM usuario WHERE tenant_id = %(tenant_id)s]
[parameters: {'tenant_id': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 13:40:00.152 | INFO     | etl.extract:extract_table:172 - Intentando extracción completa como respaldo para usuario
2025-05-29 13:40:00.153 | INFO     | etl.extract:extract_table:176 - Extracción de respaldo completada: 5 registros de usuario
2025-05-29 13:40:00.154 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:40:00.155 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:40:00.155 | WARNING  | etl.transform:batch_transform:410 - No hay método de transformación específico para usuario
2025-05-29 13:40:00.156 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:40:00.156 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:40:00.160 | INFO     | etl.load:load_records:106 - Cargados 5 registros en raw_usuarios: 0 insertados, 5 actualizados
2025-05-29 13:40:00.161 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 13:40:00.161 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:00.163 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 13:40:00.163 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.165 | INFO     | etl.sync:sync_table:98 - Sincronización de usuario completada: {'status': 'success', 'table': 'usuario', 'tenant_id': 1, 'records': 5, 'inserted': 0, 'updated': 5, 'duration_seconds': 0.017992}
2025-05-29 13:40:00.165 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 13:40:00.166 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:40:00.167 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cuenta_mesa para tenant 1
2025-05-29 13:40:00.167 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:40:00.169 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.169 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:35:20.196000
2025-05-29 13:40:00.170 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:00.171 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 13:40:00.172 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:00.172 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:40:00.173 | INFO     | etl.extract:extract_table:114 - Sincronización incremental para cuenta_mesa (última sincronización: 2025-05-29 17:35:20.196000)
2025-05-29 13:40:00.174 | ERROR    | etl.extract:extract_table:167 - Error al extraer datos de cuenta_mesa: (psycopg2.errors.UndefinedColumn) no existe la columna «id»
LINE 1: SELECT id FROM cuenta_mesa WHERE tenant_id = 1
               ^

[SQL: SELECT id FROM cuenta_mesa WHERE tenant_id = %(tenant_id)s]
[parameters: {'tenant_id': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 13:40:00.175 | INFO     | etl.extract:extract_table:172 - Intentando extracción completa como respaldo para cuenta_mesa
2025-05-29 13:40:00.206 | INFO     | etl.extract:extract_table:176 - Extracción de respaldo completada: 5000 registros de cuenta_mesa
2025-05-29 13:40:00.208 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.04 segundos
2025-05-29 13:40:00.208 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:40:00.209 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cuenta_mesa para tenant_id=1
2025-05-29 13:40:00.223 | INFO     | etl.transform:transform_cuenta_mesa:206 - Transformados 5000 registros de cuenta mesa
2025-05-29 13:40:00.224 | DEBUG    | utils:wrapper:35 - Función transform_cuenta_mesa ejecutada en 0.01 segundos
2025-05-29 13:40:00.224 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 13:40:00.225 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:40:11.635 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_cuenta_mesas: 0 insertados, 5000 actualizados
2025-05-29 13:40:11.636 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 11.41 segundos
2025-05-29 13:40:11.636 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:11.637 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 13:40:11.638 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:11.638 | INFO     | etl.sync:sync_table:98 - Sincronización de cuenta_mesa completada: {'status': 'success', 'table': 'cuenta_mesa', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 11.468091}
2025-05-29 13:40:11.639 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 11.47 segundos
2025-05-29 13:40:11.639 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:40:11.640 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de reserva para tenant 1
2025-05-29 13:40:11.640 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:40:11.642 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:11.642 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:35:24.998000
2025-05-29 13:40:11.643 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:11.644 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 13:40:11.645 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:11.646 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:40:11.647 | INFO     | etl.extract:extract_table:114 - Sincronización incremental para reserva (última sincronización: 2025-05-29 17:35:24.998000)
2025-05-29 13:40:11.649 | ERROR    | etl.extract:extract_table:167 - Error al extraer datos de reserva: (psycopg2.errors.UndefinedColumn) no existe la columna «id»
LINE 1: SELECT id FROM reserva WHERE tenant_id = 1
               ^

[SQL: SELECT id FROM reserva WHERE tenant_id = %(tenant_id)s]
[parameters: {'tenant_id': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 13:40:11.651 | INFO     | etl.extract:extract_table:172 - Intentando extracción completa como respaldo para reserva
2025-05-29 13:40:11.668 | INFO     | etl.extract:extract_table:176 - Extracción de respaldo completada: 3000 registros de reserva
2025-05-29 13:40:11.670 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.02 segundos
2025-05-29 13:40:11.671 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:40:11.671 | DEBUG    | utils:wrapper:81 - Ejecutando transform_reserva para tenant_id=1
2025-05-29 13:40:11.679 | INFO     | etl.transform:transform_reserva:357 - Transformados 3000 registros de reserva
2025-05-29 13:40:11.679 | DEBUG    | utils:wrapper:35 - Función transform_reserva ejecutada en 0.01 segundos
2025-05-29 13:40:11.679 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 13:40:11.680 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:40:16.354 | INFO     | etl.load:load_records:106 - Cargados 3000 registros en raw_reservas: 0 insertados, 3000 actualizados
2025-05-29 13:40:16.355 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 4.68 segundos
2025-05-29 13:40:16.356 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:16.358 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 13:40:16.358 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:16.359 | INFO     | etl.sync:sync_table:98 - Sincronización de reserva completada: {'status': 'success', 'table': 'reserva', 'tenant_id': 1, 'records': 3000, 'inserted': 0, 'updated': 3000, 'duration_seconds': 4.716044}
2025-05-29 13:40:16.360 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 4.72 segundos
2025-05-29 13:40:16.360 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:40:16.361 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de venta para tenant 1
2025-05-29 13:40:16.361 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:40:16.363 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:16.363 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:35:36.015000
2025-05-29 13:40:16.364 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:16.366 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 13:40:16.366 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:16.367 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:40:16.367 | INFO     | etl.extract:extract_table:114 - Sincronización incremental para venta (última sincronización: 2025-05-29 17:35:36.015000)
2025-05-29 13:40:16.369 | ERROR    | etl.extract:extract_table:167 - Error al extraer datos de venta: (psycopg2.errors.UndefinedColumn) no existe la columna «id»
LINE 1: SELECT id FROM venta WHERE tenant_id = 1
               ^

[SQL: SELECT id FROM venta WHERE tenant_id = %(tenant_id)s]
[parameters: {'tenant_id': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 13:40:16.370 | INFO     | etl.extract:extract_table:172 - Intentando extracción completa como respaldo para venta
2025-05-29 13:40:16.392 | INFO     | etl.extract:extract_table:176 - Extracción de respaldo completada: 5000 registros de venta
2025-05-29 13:40:16.393 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.03 segundos
2025-05-29 13:40:16.394 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:40:16.394 | DEBUG    | utils:wrapper:81 - Ejecutando transform_venta para tenant_id=1
2025-05-29 13:40:16.405 | INFO     | etl.transform:transform_venta:389 - Transformados 5000 registros de venta
2025-05-29 13:40:16.407 | DEBUG    | utils:wrapper:35 - Función transform_venta ejecutada en 0.01 segundos
2025-05-29 13:40:16.408 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 13:40:16.408 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:40:28.067 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_ventas: 0 insertados, 5000 actualizados
2025-05-29 13:40:28.068 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 11.66 segundos
2025-05-29 13:40:28.069 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:40:28.070 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 13:40:28.071 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:40:28.071 | INFO     | etl.sync:sync_table:98 - Sincronización de venta completada: {'status': 'success', 'table': 'venta', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 11.706532}
2025-05-29 13:40:28.072 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 11.71 segundos
2025-05-29 13:40:28.072 | DEBUG    | utils:wrapper:35 - Función sync_all_tables ejecutada en 292.05 segundos
2025-05-29 13:40:28.073 | INFO     | __main__:sync_scheduled:135 - Sincronización completada en 292.05s: 10 tablas exitosas, 0 errores, 0 omitidas, 46617 registros procesados
2025-05-29 13:40:28.073 | INFO     | __main__:sync_scheduled:142 - Próxima sincronización programada a las 2025-05-29 14:40:28 (en 60 minutos)
2025-05-29 13:40:34.092 | INFO     | __main__:sync_scheduled:146 - Sincronización programada interrumpida por el usuario
2025-05-29 13:40:34.092 | INFO     | __main__:main:196 - Servicio finalizado. Cerrando conexiones...
2025-05-29 13:40:34.094 | INFO     | etl.extract:close:281 - Conexión a PostgreSQL cerrada
2025-05-29 13:40:34.095 | INFO     | db.mongo_client:close:194 - Conexión a MongoDB cerrada
2025-05-29 13:47:10.267 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-29 13:47:10.268 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.04 segundos
2025-05-29 13:47:10.498 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-29 13:47:10.498 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-29 13:47:10.501 | INFO     | __main__:main:160 - Iniciando Restaurant ML Microservice v0.1.0
2025-05-29 13:47:10.502 | INFO     | __main__:main:161 - Modo desarrollo: True
2025-05-29 13:47:10.502 | INFO     | __main__:test_connections:11 - Probando conexiones a bases de datos...
2025-05-29 13:47:10.504 | INFO     | __main__:test_connections:18 - Conexión a MongoDB funciona correctamente: versión 8.0.6
2025-05-29 13:47:10.506 | DEBUG    | utils:wrapper:35 - Función execute_query ejecutada en 0.00 segundos
2025-05-29 13:47:10.506 | INFO     | __main__:test_connections:27 - Conexión a PostgreSQL funciona correctamente
2025-05-29 13:47:10.508 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedidos
2025-05-29 13:47:10.509 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_hora_-1' creado en raw_pedidos
2025-05-29 13:47:10.511 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_detalle_id_1' creado en raw_pedido_detalles
2025-05-29 13:47:10.512 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedido_detalles
2025-05-29 13:47:10.513 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_pedido_detalles
2025-05-29 13:47:10.514 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_productos
2025-05-29 13:47:10.515 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en raw_productos
2025-05-29 13:47:10.516 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_1_producto_id_1' creado en ventas_diarias
2025-05-29 13:47:10.517 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en ventas_diarias
2025-05-29 13:47:10.518 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en ventas_diarias
2025-05-29 13:47:10.518 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_table_name_1' creado en sync_status
2025-05-29 13:47:10.519 | INFO     | db.models:create_indexes:145 - Índices creados para todas las colecciones
2025-05-29 13:47:10.519 | INFO     | __main__:main:182 - Modo desarrollo: Ejecutando sincronización inicial completa...
2025-05-29 13:47:10.519 | INFO     | __main__:test_sync:44 - Probando sincronización para tenant 1...
2025-05-29 13:47:10.520 | INFO     | __main__:test_sync:55 - Sincronizando tabla: pedido...
2025-05-29 13:47:10.520 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:47:10.521 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido para tenant 1
2025-05-29 13:47:10.521 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:47:10.523 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 13:47:10.524 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:47:10.524 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:47:10.525 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para pedido
2025-05-29 13:47:10.560 | INFO     | etl.extract:_extract_all:197 - Extraídos 7449 registros de pedido para tenant 1
2025-05-29 13:47:10.562 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.04 segundos
2025-05-29 13:47:10.562 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.04 segundos
2025-05-29 13:47:10.563 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:47:10.563 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido para tenant_id=1
2025-05-29 13:47:10.579 | INFO     | etl.transform:transform_pedido:51 - Transformados 7449 registros de pedido
2025-05-29 13:47:10.580 | DEBUG    | utils:wrapper:35 - Función transform_pedido ejecutada en 0.02 segundos
2025-05-29 13:47:10.580 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 13:47:10.581 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:47:38.583 | INFO     | etl.load:load_records:106 - Cargados 7449 registros en raw_pedidos: 0 insertados, 7449 actualizados
2025-05-29 13:47:38.584 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 28.00 segundos
2025-05-29 13:47:38.584 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:47:38.585 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 13:47:38.586 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:47:38.586 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido completada: {'status': 'success', 'table': 'pedido', 'tenant_id': 1, 'records': 7449, 'inserted': 0, 'updated': 7449, 'duration_seconds': 28.065098}
2025-05-29 13:47:38.588 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 28.07 segundos
2025-05-29 13:47:38.588 | INFO     | __main__:test_sync:65 - Sincronización de pedido completada en 28.07s: 7449 registros
2025-05-29 13:47:38.589 | INFO     | __main__:test_sync:55 - Sincronizando tabla: pedido_detalle...
2025-05-29 13:47:38.589 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:47:38.589 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido_detalle para tenant 1
2025-05-29 13:47:38.590 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:47:38.591 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 13:47:38.592 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:47:38.593 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:47:38.593 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para pedido_detalle
2025-05-29 13:47:38.701 | INFO     | etl.extract:_extract_all:197 - Extraídos 25943 registros de pedido_detalle para tenant 1
2025-05-29 13:47:38.703 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.11 segundos
2025-05-29 13:47:38.703 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.11 segundos
2025-05-29 13:47:38.703 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:47:38.704 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido_detalle para tenant_id=1
2025-05-29 13:47:38.765 | INFO     | etl.transform:transform_pedido_detalle:85 - Transformados 25943 registros de detalle de pedido
2025-05-29 13:47:38.766 | DEBUG    | utils:wrapper:35 - Función transform_pedido_detalle ejecutada en 0.06 segundos
2025-05-29 13:47:38.766 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.06 segundos
2025-05-29 13:47:38.767 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:51:57.447 | INFO     | etl.load:load_records:106 - Cargados 25943 registros en raw_pedido_detalles: 0 insertados, 25943 actualizados
2025-05-29 13:51:57.448 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 258.68 segundos
2025-05-29 13:51:57.448 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.450 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 13:51:57.450 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.451 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido_detalle completada: {'status': 'success', 'table': 'pedido_detalle', 'tenant_id': 1, 'records': 25943, 'inserted': 0, 'updated': 25943, 'duration_seconds': 258.861173}
2025-05-29 13:51:57.457 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 258.87 segundos
2025-05-29 13:51:57.459 | INFO     | __main__:test_sync:65 - Sincronización de pedido_detalle completada en 258.87s: 25943 registros
2025-05-29 13:51:57.459 | INFO     | __main__:test_sync:55 - Sincronizando tabla: producto...
2025-05-29 13:51:57.460 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:51:57.460 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de producto para tenant 1
2025-05-29 13:51:57.461 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.462 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 13:51:57.463 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.464 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:51:57.465 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para producto
2025-05-29 13:51:57.467 | INFO     | etl.extract:_extract_all:197 - Extraídos 30 registros de producto para tenant 1
2025-05-29 13:51:57.468 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 13:51:57.469 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:51:57.469 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:51:57.470 | DEBUG    | utils:wrapper:81 - Ejecutando transform_producto para tenant_id=1
2025-05-29 13:51:57.470 | INFO     | etl.transform:transform_producto:123 - Transformados 30 registros de producto
2025-05-29 13:51:57.470 | DEBUG    | utils:wrapper:35 - Función transform_producto ejecutada en 0.00 segundos
2025-05-29 13:51:57.471 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:51:57.472 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:51:57.490 | INFO     | etl.load:load_records:106 - Cargados 30 registros en raw_productos: 0 insertados, 30 actualizados
2025-05-29 13:51:57.490 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.02 segundos
2025-05-29 13:51:57.491 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.493 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 13:51:57.494 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.495 | INFO     | etl.sync:sync_table:98 - Sincronización de producto completada: {'status': 'success', 'table': 'producto', 'tenant_id': 1, 'records': 30, 'inserted': 0, 'updated': 30, 'duration_seconds': 0.034663}
2025-05-29 13:51:57.495 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.04 segundos
2025-05-29 13:51:57.496 | INFO     | __main__:test_sync:65 - Sincronización de producto completada en 0.04s: 30 registros
2025-05-29 13:51:57.496 | INFO     | __main__:test_sync:55 - Sincronizando tabla: cliente...
2025-05-29 13:51:57.497 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:51:57.497 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cliente para tenant 1
2025-05-29 13:51:57.498 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.501 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 13:51:57.501 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.501 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:51:57.502 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para cliente
2025-05-29 13:51:57.505 | INFO     | etl.extract:_extract_all:197 - Extraídos 167 registros de cliente para tenant 1
2025-05-29 13:51:57.506 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 13:51:57.507 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:51:57.507 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:51:57.508 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cliente para tenant_id=1
2025-05-29 13:51:57.509 | INFO     | etl.transform:transform_cliente:255 - Transformados 167 registros de cliente
2025-05-29 13:51:57.510 | DEBUG    | utils:wrapper:35 - Función transform_cliente ejecutada en 0.00 segundos
2025-05-29 13:51:57.510 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:51:57.511 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:51:57.607 | INFO     | etl.load:load_records:106 - Cargados 167 registros en raw_clientes: 0 insertados, 167 actualizados
2025-05-29 13:51:57.608 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.10 segundos
2025-05-29 13:51:57.608 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.610 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 13:51:57.610 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.611 | INFO     | etl.sync:sync_table:98 - Sincronización de cliente completada: {'status': 'success', 'table': 'cliente', 'tenant_id': 1, 'records': 167, 'inserted': 0, 'updated': 167, 'duration_seconds': 0.112302}
2025-05-29 13:51:57.611 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.11 segundos
2025-05-29 13:51:57.612 | INFO     | __main__:test_sync:65 - Sincronización de cliente completada en 0.11s: 167 registros
2025-05-29 13:51:57.612 | INFO     | __main__:test_sync:55 - Sincronizando tabla: mesa...
2025-05-29 13:51:57.613 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:51:57.613 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de mesa para tenant 1
2025-05-29 13:51:57.614 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.615 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 13:51:57.616 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.617 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:51:57.617 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para mesa
2025-05-29 13:51:57.619 | INFO     | etl.extract:_extract_all:197 - Extraídos 15 registros de mesa para tenant 1
2025-05-29 13:51:57.619 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 13:51:57.620 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 13:51:57.620 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:51:57.621 | DEBUG    | utils:wrapper:81 - Ejecutando transform_mesa para tenant_id=1
2025-05-29 13:51:57.621 | INFO     | etl.transform:transform_mesa:286 - Transformados 15 registros de mesa
2025-05-29 13:51:57.621 | DEBUG    | utils:wrapper:35 - Función transform_mesa ejecutada en 0.00 segundos
2025-05-29 13:51:57.622 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:51:57.622 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:51:57.630 | INFO     | etl.load:load_records:106 - Cargados 15 registros en raw_mesas: 0 insertados, 15 actualizados
2025-05-29 13:51:57.631 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 13:51:57.631 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.632 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 13:51:57.633 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.633 | INFO     | etl.sync:sync_table:98 - Sincronización de mesa completada: {'status': 'success', 'table': 'mesa', 'tenant_id': 1, 'records': 15, 'inserted': 0, 'updated': 15, 'duration_seconds': 0.019329}
2025-05-29 13:51:57.634 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 13:51:57.634 | INFO     | __main__:test_sync:65 - Sincronización de mesa completada en 0.02s: 15 registros
2025-05-29 13:51:57.635 | INFO     | __main__:test_sync:55 - Sincronizando tabla: categoria...
2025-05-29 13:51:57.635 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:51:57.635 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de categoria para tenant 1
2025-05-29 13:51:57.636 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.637 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 13:51:57.637 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.638 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:51:57.638 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para categoria
2025-05-29 13:51:57.640 | INFO     | etl.extract:_extract_all:197 - Extraídos 8 registros de categoria para tenant 1
2025-05-29 13:51:57.641 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 13:51:57.642 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 13:51:57.642 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:51:57.643 | DEBUG    | utils:wrapper:81 - Ejecutando transform_categoria para tenant_id=1
2025-05-29 13:51:57.644 | INFO     | etl.transform:transform_categoria:153 - Transformados 8 registros de categoría
2025-05-29 13:51:57.644 | DEBUG    | utils:wrapper:35 - Función transform_categoria ejecutada en 0.00 segundos
2025-05-29 13:51:57.644 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:51:57.645 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:51:57.649 | INFO     | etl.load:load_records:106 - Cargados 8 registros en raw_categorias: 0 insertados, 8 actualizados
2025-05-29 13:51:57.650 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 13:51:57.650 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.651 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 13:51:57.652 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.652 | INFO     | etl.sync:sync_table:98 - Sincronización de categoria completada: {'status': 'success', 'table': 'categoria', 'tenant_id': 1, 'records': 8, 'inserted': 0, 'updated': 8, 'duration_seconds': 0.016147}
2025-05-29 13:51:57.653 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 13:51:57.653 | INFO     | __main__:test_sync:65 - Sincronización de categoria completada en 0.02s: 8 registros
2025-05-29 13:51:57.653 | INFO     | __main__:test_sync:55 - Sincronizando tabla: usuario...
2025-05-29 13:51:57.654 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:51:57.654 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de usuario para tenant 1
2025-05-29 13:51:57.655 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.656 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 13:51:57.657 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.657 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:51:57.658 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para usuario
2025-05-29 13:51:57.660 | INFO     | etl.extract:_extract_all:197 - Extraídos 5 registros de usuario para tenant 1
2025-05-29 13:51:57.661 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 13:51:57.661 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 13:51:57.662 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:51:57.662 | WARNING  | etl.transform:batch_transform:410 - No hay método de transformación específico para usuario
2025-05-29 13:51:57.663 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:51:57.663 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:51:57.666 | INFO     | etl.load:load_records:106 - Cargados 5 registros en raw_usuarios: 0 insertados, 5 actualizados
2025-05-29 13:51:57.667 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.00 segundos
2025-05-29 13:51:57.667 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.669 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 13:51:57.669 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.670 | INFO     | etl.sync:sync_table:98 - Sincronización de usuario completada: {'status': 'success', 'table': 'usuario', 'tenant_id': 1, 'records': 5, 'inserted': 0, 'updated': 5, 'duration_seconds': 0.015}
2025-05-29 13:51:57.670 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 13:51:57.670 | INFO     | __main__:test_sync:65 - Sincronización de usuario completada en 0.02s: 5 registros
2025-05-29 13:51:57.671 | INFO     | __main__:test_sync:55 - Sincronizando tabla: cuenta_mesa...
2025-05-29 13:51:57.671 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:51:57.672 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cuenta_mesa para tenant 1
2025-05-29 13:51:57.672 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:51:57.674 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 13:51:57.675 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:51:57.675 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:51:57.676 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para cuenta_mesa
2025-05-29 13:51:57.703 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de cuenta_mesa para tenant 1
2025-05-29 13:51:57.704 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.03 segundos
2025-05-29 13:51:57.705 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.03 segundos
2025-05-29 13:51:57.705 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:51:57.706 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cuenta_mesa para tenant_id=1
2025-05-29 13:51:57.719 | INFO     | etl.transform:transform_cuenta_mesa:206 - Transformados 5000 registros de cuenta mesa
2025-05-29 13:51:57.720 | DEBUG    | utils:wrapper:35 - Función transform_cuenta_mesa ejecutada en 0.01 segundos
2025-05-29 13:51:57.720 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 13:51:57.721 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:52:09.759 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_cuenta_mesas: 0 insertados, 5000 actualizados
2025-05-29 13:52:09.759 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 12.04 segundos
2025-05-29 13:52:09.760 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:52:09.761 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 13:52:09.762 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:52:09.763 | INFO     | etl.sync:sync_table:98 - Sincronización de cuenta_mesa completada: {'status': 'success', 'table': 'cuenta_mesa', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 12.091108}
2025-05-29 13:52:09.765 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 12.09 segundos
2025-05-29 13:52:09.766 | INFO     | __main__:test_sync:65 - Sincronización de cuenta_mesa completada en 12.1s: 5000 registros
2025-05-29 13:52:09.766 | INFO     | __main__:test_sync:55 - Sincronizando tabla: reserva...
2025-05-29 13:52:09.767 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:52:09.767 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de reserva para tenant 1
2025-05-29 13:52:09.768 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:52:09.770 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 13:52:09.772 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:52:09.772 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:52:09.773 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para reserva
2025-05-29 13:52:09.791 | INFO     | etl.extract:_extract_all:197 - Extraídos 3000 registros de reserva para tenant 1
2025-05-29 13:52:09.792 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.02 segundos
2025-05-29 13:52:09.793 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.02 segundos
2025-05-29 13:52:09.793 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:52:09.794 | DEBUG    | utils:wrapper:81 - Ejecutando transform_reserva para tenant_id=1
2025-05-29 13:52:09.801 | INFO     | etl.transform:transform_reserva:357 - Transformados 3000 registros de reserva
2025-05-29 13:52:09.802 | DEBUG    | utils:wrapper:35 - Función transform_reserva ejecutada en 0.01 segundos
2025-05-29 13:52:09.802 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 13:52:09.803 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:52:14.584 | INFO     | etl.load:load_records:106 - Cargados 3000 registros en raw_reservas: 0 insertados, 3000 actualizados
2025-05-29 13:52:14.584 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 4.78 segundos
2025-05-29 13:52:14.585 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:52:14.586 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 13:52:14.587 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:52:14.587 | INFO     | etl.sync:sync_table:98 - Sincronización de reserva completada: {'status': 'success', 'table': 'reserva', 'tenant_id': 1, 'records': 3000, 'inserted': 0, 'updated': 3000, 'duration_seconds': 4.818246}
2025-05-29 13:52:14.588 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 4.82 segundos
2025-05-29 13:52:14.589 | INFO     | __main__:test_sync:65 - Sincronización de reserva completada en 4.82s: 3000 registros
2025-05-29 13:52:14.590 | INFO     | __main__:test_sync:55 - Sincronizando tabla: venta...
2025-05-29 13:52:14.590 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:52:14.591 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de venta para tenant 1
2025-05-29 13:52:14.591 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:52:14.593 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 13:52:14.594 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:52:14.595 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:52:14.595 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para venta
2025-05-29 13:52:14.623 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de venta para tenant 1
2025-05-29 13:52:14.624 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.03 segundos
2025-05-29 13:52:14.624 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.03 segundos
2025-05-29 13:52:14.625 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:52:14.627 | DEBUG    | utils:wrapper:81 - Ejecutando transform_venta para tenant_id=1
2025-05-29 13:52:14.637 | INFO     | etl.transform:transform_venta:389 - Transformados 5000 registros de venta
2025-05-29 13:52:14.638 | DEBUG    | utils:wrapper:35 - Función transform_venta ejecutada en 0.01 segundos
2025-05-29 13:52:14.638 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 13:52:14.639 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:52:27.013 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_ventas: 0 insertados, 5000 actualizados
2025-05-29 13:52:27.013 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 12.37 segundos
2025-05-29 13:52:27.014 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:52:27.016 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 13:52:27.016 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:52:27.017 | INFO     | etl.sync:sync_table:98 - Sincronización de venta completada: {'status': 'success', 'table': 'venta', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 12.42597}
2025-05-29 13:52:27.018 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 12.43 segundos
2025-05-29 13:52:27.018 | INFO     | __main__:test_sync:65 - Sincronización de venta completada en 12.43s: 5000 registros
2025-05-29 13:52:27.019 | INFO     | __main__:test_sync:83 - Resumen de sincronización: 10 exitosas, 0 errores, 0 omitidas
2025-05-29 13:52:27.020 | INFO     | __main__:main:189 - Iniciando servicio de sincronización 24/7...
2025-05-29 13:52:27.020 | INFO     | __main__:sync_scheduled:100 - Iniciando sincronización programada cada 60 minutos para tenant 1
2025-05-29 13:52:27.021 | INFO     | __main__:sync_scheduled:107 - Ejecutando sincronización programada...
2025-05-29 13:52:27.021 | INFO     | __main__:sync_scheduled:116 - Realizando sincronización incremental...
2025-05-29 13:52:27.022 | DEBUG    | utils:wrapper:81 - Ejecutando sync_all_tables para tenant_id=1
2025-05-29 13:52:27.023 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:52:27.023 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido para tenant 1
2025-05-29 13:52:27.024 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:52:27.026 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:52:27.026 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:47:38.585000
2025-05-29 13:52:27.027 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:52:27.028 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 13:52:27.029 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:52:27.029 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:52:27.030 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para pedido (última: 2025-05-29 17:47:38.585000)
2025-05-29 13:52:27.051 | INFO     | etl.extract:extract_table:152 - Análisis para pedido: 7449 registros en PostgreSQL, 7449 en MongoDB
2025-05-29 13:52:27.052 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para pedido por eficiencia
2025-05-29 13:52:27.126 | INFO     | etl.extract:_extract_all:197 - Extraídos 7449 registros de pedido para tenant 1
2025-05-29 13:52:27.128 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.07 segundos
2025-05-29 13:52:27.129 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.10 segundos
2025-05-29 13:52:27.130 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:52:27.130 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido para tenant_id=1
2025-05-29 13:52:27.147 | INFO     | etl.transform:transform_pedido:51 - Transformados 7449 registros de pedido
2025-05-29 13:52:27.148 | DEBUG    | utils:wrapper:35 - Función transform_pedido ejecutada en 0.02 segundos
2025-05-29 13:52:27.148 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 13:52:27.149 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:52:55.171 | INFO     | etl.load:load_records:106 - Cargados 7449 registros en raw_pedidos: 0 insertados, 7449 actualizados
2025-05-29 13:52:55.172 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 28.02 segundos
2025-05-29 13:52:55.172 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:52:55.174 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 13:52:55.174 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:52:55.175 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido completada: {'status': 'success', 'table': 'pedido', 'tenant_id': 1, 'records': 7449, 'inserted': 0, 'updated': 7449, 'duration_seconds': 28.148084}
2025-05-29 13:52:55.176 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 28.15 segundos
2025-05-29 13:52:55.177 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:52:55.177 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido_detalle para tenant 1
2025-05-29 13:52:55.178 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:52:55.179 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:52:55.180 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:51:57.449000
2025-05-29 13:52:55.180 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:52:55.182 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 13:52:55.183 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:52:55.184 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:52:55.184 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para pedido_detalle (última: 2025-05-29 17:51:57.449000)
2025-05-29 13:52:55.262 | INFO     | etl.extract:extract_table:152 - Análisis para pedido_detalle: 25943 registros en PostgreSQL, 25943 en MongoDB
2025-05-29 13:52:55.263 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para pedido_detalle por eficiencia
2025-05-29 13:52:55.370 | INFO     | etl.extract:_extract_all:197 - Extraídos 25943 registros de pedido_detalle para tenant 1
2025-05-29 13:52:55.372 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.11 segundos
2025-05-29 13:52:55.373 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.19 segundos
2025-05-29 13:52:55.374 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:52:55.374 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido_detalle para tenant_id=1
2025-05-29 13:52:55.414 | INFO     | etl.transform:transform_pedido_detalle:85 - Transformados 25943 registros de detalle de pedido
2025-05-29 13:52:55.415 | DEBUG    | utils:wrapper:35 - Función transform_pedido_detalle ejecutada en 0.04 segundos
2025-05-29 13:52:55.415 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.04 segundos
2025-05-29 13:52:55.416 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:57:37.747 | INFO     | etl.load:load_records:106 - Cargados 25943 registros en raw_pedido_detalles: 0 insertados, 25943 actualizados
2025-05-29 13:57:37.747 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 282.33 segundos
2025-05-29 13:57:37.748 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.749 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 13:57:37.750 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.750 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido_detalle completada: {'status': 'success', 'table': 'pedido_detalle', 'tenant_id': 1, 'records': 25943, 'inserted': 0, 'updated': 25943, 'duration_seconds': 282.570065}
2025-05-29 13:57:37.756 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 282.58 segundos
2025-05-29 13:57:37.757 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:57:37.757 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de producto para tenant 1
2025-05-29 13:57:37.758 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:57:37.760 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.761 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:51:57.492000
2025-05-29 13:57:37.761 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.763 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 13:57:37.764 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.764 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:57:37.765 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para producto (última: 2025-05-29 17:51:57.492000)
2025-05-29 13:57:37.767 | INFO     | etl.extract:extract_table:152 - Análisis para producto: 30 registros en PostgreSQL, 30 en MongoDB
2025-05-29 13:57:37.768 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para producto por eficiencia
2025-05-29 13:57:37.770 | INFO     | etl.extract:_extract_all:197 - Extraídos 30 registros de producto para tenant 1
2025-05-29 13:57:37.771 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 13:57:37.772 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:57:37.772 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:57:37.773 | DEBUG    | utils:wrapper:81 - Ejecutando transform_producto para tenant_id=1
2025-05-29 13:57:37.773 | INFO     | etl.transform:transform_producto:123 - Transformados 30 registros de producto
2025-05-29 13:57:37.774 | DEBUG    | utils:wrapper:35 - Función transform_producto ejecutada en 0.00 segundos
2025-05-29 13:57:37.774 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:57:37.775 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:57:37.796 | INFO     | etl.load:load_records:106 - Cargados 30 registros en raw_productos: 0 insertados, 30 actualizados
2025-05-29 13:57:37.797 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.02 segundos
2025-05-29 13:57:37.797 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.799 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 13:57:37.800 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.800 | INFO     | etl.sync:sync_table:98 - Sincronización de producto completada: {'status': 'success', 'table': 'producto', 'tenant_id': 1, 'records': 30, 'inserted': 0, 'updated': 30, 'duration_seconds': 0.03897}
2025-05-29 13:57:37.801 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.04 segundos
2025-05-29 13:57:37.801 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:57:37.802 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cliente para tenant 1
2025-05-29 13:57:37.802 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:57:37.804 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.804 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:51:57.609000
2025-05-29 13:57:37.805 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.806 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 13:57:37.806 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.806 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:57:37.807 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para cliente (última: 2025-05-29 17:51:57.609000)
2025-05-29 13:57:37.811 | INFO     | etl.extract:extract_table:152 - Análisis para cliente: 167 registros en PostgreSQL, 167 en MongoDB
2025-05-29 13:57:37.812 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para cliente por eficiencia
2025-05-29 13:57:37.814 | INFO     | etl.extract:_extract_all:197 - Extraídos 167 registros de cliente para tenant 1
2025-05-29 13:57:37.814 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 13:57:37.815 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:57:37.815 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:57:37.816 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cliente para tenant_id=1
2025-05-29 13:57:37.816 | INFO     | etl.transform:transform_cliente:255 - Transformados 167 registros de cliente
2025-05-29 13:57:37.817 | DEBUG    | utils:wrapper:35 - Función transform_cliente ejecutada en 0.00 segundos
2025-05-29 13:57:37.817 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:57:37.817 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:57:37.912 | INFO     | etl.load:load_records:106 - Cargados 167 registros en raw_clientes: 0 insertados, 167 actualizados
2025-05-29 13:57:37.913 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.10 segundos
2025-05-29 13:57:37.914 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.916 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 13:57:37.917 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.917 | INFO     | etl.sync:sync_table:98 - Sincronización de cliente completada: {'status': 'success', 'table': 'cliente', 'tenant_id': 1, 'records': 167, 'inserted': 0, 'updated': 167, 'duration_seconds': 0.111667}
2025-05-29 13:57:37.918 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.12 segundos
2025-05-29 13:57:37.919 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:57:37.919 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de mesa para tenant 1
2025-05-29 13:57:37.920 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:57:37.921 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.922 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:51:57.631000
2025-05-29 13:57:37.922 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.924 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 13:57:37.924 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.925 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:57:37.925 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para mesa (última: 2025-05-29 17:51:57.631000)
2025-05-29 13:57:37.928 | INFO     | etl.extract:extract_table:152 - Análisis para mesa: 15 registros en PostgreSQL, 15 en MongoDB
2025-05-29 13:57:37.929 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para mesa por eficiencia
2025-05-29 13:57:37.930 | INFO     | etl.extract:_extract_all:197 - Extraídos 15 registros de mesa para tenant 1
2025-05-29 13:57:37.931 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 13:57:37.932 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:57:37.932 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:57:37.933 | DEBUG    | utils:wrapper:81 - Ejecutando transform_mesa para tenant_id=1
2025-05-29 13:57:37.933 | INFO     | etl.transform:transform_mesa:286 - Transformados 15 registros de mesa
2025-05-29 13:57:37.934 | DEBUG    | utils:wrapper:35 - Función transform_mesa ejecutada en 0.00 segundos
2025-05-29 13:57:37.934 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:57:37.934 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:57:37.940 | INFO     | etl.load:load_records:106 - Cargados 15 registros en raw_mesas: 0 insertados, 15 actualizados
2025-05-29 13:57:37.940 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 13:57:37.941 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.942 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 13:57:37.943 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.944 | INFO     | etl.sync:sync_table:98 - Sincronización de mesa completada: {'status': 'success', 'table': 'mesa', 'tenant_id': 1, 'records': 15, 'inserted': 0, 'updated': 15, 'duration_seconds': 0.022203}
2025-05-29 13:57:37.945 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.03 segundos
2025-05-29 13:57:37.945 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:57:37.945 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de categoria para tenant 1
2025-05-29 13:57:37.945 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:57:37.947 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.947 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:51:57.650000
2025-05-29 13:57:37.948 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.949 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 13:57:37.949 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.950 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:57:37.950 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para categoria (última: 2025-05-29 17:51:57.650000)
2025-05-29 13:57:37.953 | INFO     | etl.extract:extract_table:152 - Análisis para categoria: 8 registros en PostgreSQL, 8 en MongoDB
2025-05-29 13:57:37.953 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para categoria por eficiencia
2025-05-29 13:57:37.955 | INFO     | etl.extract:_extract_all:197 - Extraídos 8 registros de categoria para tenant 1
2025-05-29 13:57:37.955 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 13:57:37.956 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:57:37.957 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:57:37.957 | DEBUG    | utils:wrapper:81 - Ejecutando transform_categoria para tenant_id=1
2025-05-29 13:57:37.958 | INFO     | etl.transform:transform_categoria:153 - Transformados 8 registros de categoría
2025-05-29 13:57:37.959 | DEBUG    | utils:wrapper:35 - Función transform_categoria ejecutada en 0.00 segundos
2025-05-29 13:57:37.959 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:57:37.960 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:57:37.965 | INFO     | etl.load:load_records:106 - Cargados 8 registros en raw_categorias: 0 insertados, 8 actualizados
2025-05-29 13:57:37.966 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 13:57:37.966 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.968 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 13:57:37.968 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.969 | INFO     | etl.sync:sync_table:98 - Sincronización de categoria completada: {'status': 'success', 'table': 'categoria', 'tenant_id': 1, 'records': 8, 'inserted': 0, 'updated': 8, 'duration_seconds': 0.020265}
2025-05-29 13:57:37.969 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 13:57:37.970 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:57:37.970 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de usuario para tenant 1
2025-05-29 13:57:37.970 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:57:37.971 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.972 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:51:57.668000
2025-05-29 13:57:37.972 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.973 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 13:57:37.974 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.975 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:57:37.975 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para usuario (última: 2025-05-29 17:51:57.668000)
2025-05-29 13:57:37.978 | INFO     | etl.extract:extract_table:152 - Análisis para usuario: 5 registros en PostgreSQL, 5 en MongoDB
2025-05-29 13:57:37.978 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para usuario por eficiencia
2025-05-29 13:57:37.980 | INFO     | etl.extract:_extract_all:197 - Extraídos 5 registros de usuario para tenant 1
2025-05-29 13:57:37.980 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 13:57:37.981 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 13:57:37.981 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:57:37.982 | WARNING  | etl.transform:batch_transform:410 - No hay método de transformación específico para usuario
2025-05-29 13:57:37.982 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 13:57:37.982 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:57:37.985 | INFO     | etl.load:load_records:106 - Cargados 5 registros en raw_usuarios: 0 insertados, 5 actualizados
2025-05-29 13:57:37.986 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.00 segundos
2025-05-29 13:57:37.986 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.987 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 13:57:37.988 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.988 | INFO     | etl.sync:sync_table:98 - Sincronización de usuario completada: {'status': 'success', 'table': 'usuario', 'tenant_id': 1, 'records': 5, 'inserted': 0, 'updated': 5, 'duration_seconds': 0.01617}
2025-05-29 13:57:37.989 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 13:57:37.989 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:57:37.989 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cuenta_mesa para tenant 1
2025-05-29 13:57:37.990 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:57:37.991 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.992 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:52:09.761000
2025-05-29 13:57:37.992 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:37.994 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 13:57:37.994 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:37.994 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:57:37.995 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para cuenta_mesa (última: 2025-05-29 17:52:09.761000)
2025-05-29 13:57:38.010 | INFO     | etl.extract:extract_table:152 - Análisis para cuenta_mesa: 5000 registros en PostgreSQL, 5000 en MongoDB
2025-05-29 13:57:38.011 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para cuenta_mesa por eficiencia
2025-05-29 13:57:38.037 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de cuenta_mesa para tenant 1
2025-05-29 13:57:38.039 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.03 segundos
2025-05-29 13:57:38.040 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.05 segundos
2025-05-29 13:57:38.040 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:57:38.041 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cuenta_mesa para tenant_id=1
2025-05-29 13:57:38.053 | INFO     | etl.transform:transform_cuenta_mesa:206 - Transformados 5000 registros de cuenta mesa
2025-05-29 13:57:38.054 | DEBUG    | utils:wrapper:35 - Función transform_cuenta_mesa ejecutada en 0.01 segundos
2025-05-29 13:57:38.055 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 13:57:38.055 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:57:50.169 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_cuenta_mesas: 0 insertados, 5000 actualizados
2025-05-29 13:57:50.169 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 12.11 segundos
2025-05-29 13:57:50.170 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:50.171 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 13:57:50.172 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:50.172 | INFO     | etl.sync:sync_table:98 - Sincronización de cuenta_mesa completada: {'status': 'success', 'table': 'cuenta_mesa', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 12.179971}
2025-05-29 13:57:50.174 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 12.18 segundos
2025-05-29 13:57:50.175 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:57:50.175 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de reserva para tenant 1
2025-05-29 13:57:50.176 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:57:50.178 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:50.179 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:52:14.585000
2025-05-29 13:57:50.179 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:50.182 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 13:57:50.182 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:50.183 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:57:50.183 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para reserva (última: 2025-05-29 17:52:14.585000)
2025-05-29 13:57:50.192 | INFO     | etl.extract:extract_table:152 - Análisis para reserva: 3000 registros en PostgreSQL, 3000 en MongoDB
2025-05-29 13:57:50.193 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para reserva por eficiencia
2025-05-29 13:57:50.208 | INFO     | etl.extract:_extract_all:197 - Extraídos 3000 registros de reserva para tenant 1
2025-05-29 13:57:50.209 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.02 segundos
2025-05-29 13:57:50.210 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.03 segundos
2025-05-29 13:57:50.211 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:57:50.211 | DEBUG    | utils:wrapper:81 - Ejecutando transform_reserva para tenant_id=1
2025-05-29 13:57:50.217 | INFO     | etl.transform:transform_reserva:357 - Transformados 3000 registros de reserva
2025-05-29 13:57:50.218 | DEBUG    | utils:wrapper:35 - Función transform_reserva ejecutada en 0.01 segundos
2025-05-29 13:57:50.218 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 13:57:50.219 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:57:55.032 | INFO     | etl.load:load_records:106 - Cargados 3000 registros en raw_reservas: 0 insertados, 3000 actualizados
2025-05-29 13:57:55.032 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 4.81 segundos
2025-05-29 13:57:55.033 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:55.034 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 13:57:55.034 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:55.035 | INFO     | etl.sync:sync_table:98 - Sincronización de reserva completada: {'status': 'success', 'table': 'reserva', 'tenant_id': 1, 'records': 3000, 'inserted': 0, 'updated': 3000, 'duration_seconds': 4.856298}
2025-05-29 13:57:55.036 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 4.86 segundos
2025-05-29 13:57:55.036 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 13:57:55.036 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de venta para tenant 1
2025-05-29 13:57:55.037 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 13:57:55.039 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:55.039 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 17:52:27.014000
2025-05-29 13:57:55.040 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:57:55.042 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 13:57:55.043 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:57:55.044 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 13:57:55.044 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para venta (última: 2025-05-29 17:52:27.014000)
2025-05-29 13:57:55.061 | INFO     | etl.extract:extract_table:152 - Análisis para venta: 5000 registros en PostgreSQL, 5000 en MongoDB
2025-05-29 13:57:55.062 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para venta por eficiencia
2025-05-29 13:57:55.086 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de venta para tenant 1
2025-05-29 13:57:55.087 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.02 segundos
2025-05-29 13:57:55.088 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.04 segundos
2025-05-29 13:57:55.089 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 13:57:55.090 | DEBUG    | utils:wrapper:81 - Ejecutando transform_venta para tenant_id=1
2025-05-29 13:57:55.100 | INFO     | etl.transform:transform_venta:389 - Transformados 5000 registros de venta
2025-05-29 13:57:55.101 | DEBUG    | utils:wrapper:35 - Función transform_venta ejecutada en 0.01 segundos
2025-05-29 13:57:55.101 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 13:57:55.102 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 13:58:07.066 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_ventas: 0 insertados, 5000 actualizados
2025-05-29 13:58:07.067 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 11.96 segundos
2025-05-29 13:58:07.067 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 13:58:07.068 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 13:58:07.069 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 13:58:07.070 | INFO     | etl.sync:sync_table:98 - Sincronización de venta completada: {'status': 'success', 'table': 'venta', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 12.029668}
2025-05-29 13:58:07.071 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 12.03 segundos
2025-05-29 13:58:07.072 | DEBUG    | utils:wrapper:35 - Función sync_all_tables ejecutada en 340.05 segundos
2025-05-29 13:58:07.072 | INFO     | __main__:sync_scheduled:135 - Sincronización completada en 340.05s: 10 tablas exitosas, 0 errores, 0 omitidas, 46617 registros procesados
2025-05-29 13:58:07.073 | INFO     | __main__:sync_scheduled:142 - Próxima sincronización programada a las 2025-05-29 14:58:07 (en 60 minutos)
2025-05-29 14:00:22.403 | INFO     | __main__:sync_scheduled:146 - Sincronización programada interrumpida por el usuario
2025-05-29 14:00:22.403 | INFO     | __main__:main:196 - Servicio finalizado. Cerrando conexiones...
2025-05-29 14:00:22.405 | INFO     | etl.extract:close:310 - Conexión a PostgreSQL cerrada
2025-05-29 14:00:22.407 | INFO     | db.mongo_client:close:194 - Conexión a MongoDB cerrada
2025-05-29 14:00:33.694 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-29 14:00:33.695 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.03 segundos
2025-05-29 14:00:33.923 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-29 14:00:33.924 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-29 14:00:33.927 | INFO     | __main__:main:160 - Iniciando Restaurant ML Microservice v0.1.0
2025-05-29 14:00:33.928 | INFO     | __main__:main:161 - Modo desarrollo: True
2025-05-29 14:00:33.928 | INFO     | __main__:test_connections:11 - Probando conexiones a bases de datos...
2025-05-29 14:00:33.929 | INFO     | __main__:test_connections:18 - Conexión a MongoDB funciona correctamente: versión 8.0.6
2025-05-29 14:00:33.932 | DEBUG    | utils:wrapper:35 - Función execute_query ejecutada en 0.00 segundos
2025-05-29 14:00:33.933 | INFO     | __main__:test_connections:27 - Conexión a PostgreSQL funciona correctamente
2025-05-29 14:00:33.934 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedidos
2025-05-29 14:00:33.935 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_hora_-1' creado en raw_pedidos
2025-05-29 14:00:33.937 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_detalle_id_1' creado en raw_pedido_detalles
2025-05-29 14:00:33.938 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedido_detalles
2025-05-29 14:00:33.940 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_pedido_detalles
2025-05-29 14:00:33.941 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_productos
2025-05-29 14:00:33.942 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en raw_productos
2025-05-29 14:00:33.943 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_1_producto_id_1' creado en ventas_diarias
2025-05-29 14:00:33.944 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en ventas_diarias
2025-05-29 14:00:33.945 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en ventas_diarias
2025-05-29 14:00:33.945 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_table_name_1' creado en sync_status
2025-05-29 14:00:33.946 | INFO     | db.models:create_indexes:145 - Índices creados para todas las colecciones
2025-05-29 14:00:33.946 | INFO     | __main__:main:182 - Modo desarrollo: Ejecutando sincronización inicial completa...
2025-05-29 14:00:33.947 | INFO     | __main__:test_sync:44 - Probando sincronización para tenant 1...
2025-05-29 14:00:33.947 | INFO     | __main__:test_sync:55 - Sincronizando tabla: pedido...
2025-05-29 14:00:33.948 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:00:33.948 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido para tenant 1
2025-05-29 14:00:33.949 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:00:33.950 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 14:00:33.950 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:00:33.951 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:00:33.951 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para pedido
2025-05-29 14:00:33.986 | INFO     | etl.extract:_extract_all:197 - Extraídos 7449 registros de pedido para tenant 1
2025-05-29 14:00:33.988 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.04 segundos
2025-05-29 14:00:33.989 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.04 segundos
2025-05-29 14:00:33.989 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:00:33.990 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido para tenant_id=1
2025-05-29 14:00:34.007 | INFO     | etl.transform:transform_pedido:51 - Transformados 7449 registros de pedido
2025-05-29 14:00:34.007 | DEBUG    | utils:wrapper:35 - Función transform_pedido ejecutada en 0.02 segundos
2025-05-29 14:00:34.008 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 14:00:34.008 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:00:58.312 | INFO     | etl.load:load_records:106 - Cargados 7449 registros en raw_pedidos: 0 insertados, 7449 actualizados
2025-05-29 14:00:58.313 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 24.30 segundos
2025-05-29 14:00:58.313 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:00:58.314 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 14:00:58.315 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:00:58.316 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido completada: {'status': 'success', 'table': 'pedido', 'tenant_id': 1, 'records': 7449, 'inserted': 0, 'updated': 7449, 'duration_seconds': 24.366807}
2025-05-29 14:00:58.318 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 24.37 segundos
2025-05-29 14:00:58.318 | INFO     | __main__:test_sync:65 - Sincronización de pedido completada en 24.37s: 7449 registros
2025-05-29 14:00:58.319 | INFO     | __main__:test_sync:55 - Sincronizando tabla: pedido_detalle...
2025-05-29 14:00:58.319 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:00:58.320 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido_detalle para tenant 1
2025-05-29 14:00:58.320 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:00:58.322 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 14:00:58.323 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:00:58.323 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:00:58.324 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para pedido_detalle
2025-05-29 14:00:58.429 | INFO     | etl.extract:_extract_all:197 - Extraídos 25943 registros de pedido_detalle para tenant 1
2025-05-29 14:00:58.430 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.11 segundos
2025-05-29 14:00:58.431 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.11 segundos
2025-05-29 14:00:58.432 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:00:58.432 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido_detalle para tenant_id=1
2025-05-29 14:00:58.488 | INFO     | etl.transform:transform_pedido_detalle:85 - Transformados 25943 registros de detalle de pedido
2025-05-29 14:00:58.489 | DEBUG    | utils:wrapper:35 - Función transform_pedido_detalle ejecutada en 0.06 segundos
2025-05-29 14:00:58.490 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.06 segundos
2025-05-29 14:00:58.490 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:05:36.350 | INFO     | etl.load:load_records:106 - Cargados 25943 registros en raw_pedido_detalles: 0 insertados, 25943 actualizados
2025-05-29 14:05:36.351 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 277.86 segundos
2025-05-29 14:05:36.351 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.353 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 14:05:36.353 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.354 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido_detalle completada: {'status': 'success', 'table': 'pedido_detalle', 'tenant_id': 1, 'records': 25943, 'inserted': 0, 'updated': 25943, 'duration_seconds': 278.032703}
2025-05-29 14:05:36.363 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 278.04 segundos
2025-05-29 14:05:36.364 | INFO     | __main__:test_sync:65 - Sincronización de pedido_detalle completada en 278.04s: 25943 registros
2025-05-29 14:05:36.364 | INFO     | __main__:test_sync:55 - Sincronizando tabla: producto...
2025-05-29 14:05:36.365 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:05:36.366 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de producto para tenant 1
2025-05-29 14:05:36.366 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.368 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 14:05:36.370 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.371 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:05:36.371 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para producto
2025-05-29 14:05:36.374 | INFO     | etl.extract:_extract_all:197 - Extraídos 30 registros de producto para tenant 1
2025-05-29 14:05:36.376 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:05:36.376 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:05:36.377 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:05:36.377 | DEBUG    | utils:wrapper:81 - Ejecutando transform_producto para tenant_id=1
2025-05-29 14:05:36.378 | INFO     | etl.transform:transform_producto:123 - Transformados 30 registros de producto
2025-05-29 14:05:36.378 | DEBUG    | utils:wrapper:35 - Función transform_producto ejecutada en 0.00 segundos
2025-05-29 14:05:36.379 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:05:36.379 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:05:36.399 | INFO     | etl.load:load_records:106 - Cargados 30 registros en raw_productos: 0 insertados, 30 actualizados
2025-05-29 14:05:36.400 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.02 segundos
2025-05-29 14:05:36.400 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.401 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 14:05:36.402 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.403 | INFO     | etl.sync:sync_table:98 - Sincronización de producto completada: {'status': 'success', 'table': 'producto', 'tenant_id': 1, 'records': 30, 'inserted': 0, 'updated': 30, 'duration_seconds': 0.036976}
2025-05-29 14:05:36.404 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.04 segundos
2025-05-29 14:05:36.404 | INFO     | __main__:test_sync:65 - Sincronización de producto completada en 0.04s: 30 registros
2025-05-29 14:05:36.405 | INFO     | __main__:test_sync:55 - Sincronizando tabla: cliente...
2025-05-29 14:05:36.405 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:05:36.406 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cliente para tenant 1
2025-05-29 14:05:36.407 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.408 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 14:05:36.409 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.410 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:05:36.411 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para cliente
2025-05-29 14:05:36.413 | INFO     | etl.extract:_extract_all:197 - Extraídos 167 registros de cliente para tenant 1
2025-05-29 14:05:36.414 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:05:36.415 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:05:36.416 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:05:36.416 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cliente para tenant_id=1
2025-05-29 14:05:36.417 | INFO     | etl.transform:transform_cliente:255 - Transformados 167 registros de cliente
2025-05-29 14:05:36.417 | DEBUG    | utils:wrapper:35 - Función transform_cliente ejecutada en 0.00 segundos
2025-05-29 14:05:36.418 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:05:36.418 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:05:36.535 | INFO     | etl.load:load_records:106 - Cargados 167 registros en raw_clientes: 0 insertados, 167 actualizados
2025-05-29 14:05:36.536 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.12 segundos
2025-05-29 14:05:36.537 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.538 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 14:05:36.539 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.540 | INFO     | etl.sync:sync_table:98 - Sincronización de cliente completada: {'status': 'success', 'table': 'cliente', 'tenant_id': 1, 'records': 167, 'inserted': 0, 'updated': 167, 'duration_seconds': 0.132534}
2025-05-29 14:05:36.540 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.13 segundos
2025-05-29 14:05:36.541 | INFO     | __main__:test_sync:65 - Sincronización de cliente completada en 0.14s: 167 registros
2025-05-29 14:05:36.541 | INFO     | __main__:test_sync:55 - Sincronizando tabla: mesa...
2025-05-29 14:05:36.542 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:05:36.542 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de mesa para tenant 1
2025-05-29 14:05:36.543 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.545 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 14:05:36.545 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.546 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:05:36.546 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para mesa
2025-05-29 14:05:36.547 | INFO     | etl.extract:_extract_all:197 - Extraídos 15 registros de mesa para tenant 1
2025-05-29 14:05:36.548 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:05:36.549 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 14:05:36.549 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:05:36.549 | DEBUG    | utils:wrapper:81 - Ejecutando transform_mesa para tenant_id=1
2025-05-29 14:05:36.550 | INFO     | etl.transform:transform_mesa:286 - Transformados 15 registros de mesa
2025-05-29 14:05:36.550 | DEBUG    | utils:wrapper:35 - Función transform_mesa ejecutada en 0.00 segundos
2025-05-29 14:05:36.550 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:05:36.551 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:05:36.557 | INFO     | etl.load:load_records:106 - Cargados 15 registros en raw_mesas: 0 insertados, 15 actualizados
2025-05-29 14:05:36.558 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 14:05:36.559 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.560 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 14:05:36.560 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.561 | INFO     | etl.sync:sync_table:98 - Sincronización de mesa completada: {'status': 'success', 'table': 'mesa', 'tenant_id': 1, 'records': 15, 'inserted': 0, 'updated': 15, 'duration_seconds': 0.018089}
2025-05-29 14:05:36.561 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 14:05:36.561 | INFO     | __main__:test_sync:65 - Sincronización de mesa completada en 0.02s: 15 registros
2025-05-29 14:05:36.562 | INFO     | __main__:test_sync:55 - Sincronizando tabla: categoria...
2025-05-29 14:05:36.562 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:05:36.562 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de categoria para tenant 1
2025-05-29 14:05:36.563 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.564 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 14:05:36.564 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.565 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:05:36.565 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para categoria
2025-05-29 14:05:36.567 | INFO     | etl.extract:_extract_all:197 - Extraídos 8 registros de categoria para tenant 1
2025-05-29 14:05:36.567 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:05:36.568 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 14:05:36.568 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:05:36.568 | DEBUG    | utils:wrapper:81 - Ejecutando transform_categoria para tenant_id=1
2025-05-29 14:05:36.569 | INFO     | etl.transform:transform_categoria:153 - Transformados 8 registros de categoría
2025-05-29 14:05:36.569 | DEBUG    | utils:wrapper:35 - Función transform_categoria ejecutada en 0.00 segundos
2025-05-29 14:05:36.569 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:05:36.570 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:05:36.574 | INFO     | etl.load:load_records:106 - Cargados 8 registros en raw_categorias: 0 insertados, 8 actualizados
2025-05-29 14:05:36.575 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 14:05:36.576 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.577 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 14:05:36.577 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.578 | INFO     | etl.sync:sync_table:98 - Sincronización de categoria completada: {'status': 'success', 'table': 'categoria', 'tenant_id': 1, 'records': 8, 'inserted': 0, 'updated': 8, 'duration_seconds': 0.01529}
2025-05-29 14:05:36.578 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 14:05:36.579 | INFO     | __main__:test_sync:65 - Sincronización de categoria completada en 0.02s: 8 registros
2025-05-29 14:05:36.579 | INFO     | __main__:test_sync:55 - Sincronizando tabla: usuario...
2025-05-29 14:05:36.579 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:05:36.580 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de usuario para tenant 1
2025-05-29 14:05:36.580 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.581 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 14:05:36.582 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.582 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:05:36.583 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para usuario
2025-05-29 14:05:36.584 | INFO     | etl.extract:_extract_all:197 - Extraídos 5 registros de usuario para tenant 1
2025-05-29 14:05:36.585 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:05:36.585 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 14:05:36.586 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:05:36.586 | WARNING  | etl.transform:batch_transform:410 - No hay método de transformación específico para usuario
2025-05-29 14:05:36.586 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:05:36.587 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:05:36.590 | INFO     | etl.load:load_records:106 - Cargados 5 registros en raw_usuarios: 0 insertados, 5 actualizados
2025-05-29 14:05:36.590 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.00 segundos
2025-05-29 14:05:36.591 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.593 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 14:05:36.594 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.594 | INFO     | etl.sync:sync_table:98 - Sincronización de usuario completada: {'status': 'success', 'table': 'usuario', 'tenant_id': 1, 'records': 5, 'inserted': 0, 'updated': 5, 'duration_seconds': 0.01361}
2025-05-29 14:05:36.595 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 14:05:36.595 | INFO     | __main__:test_sync:65 - Sincronización de usuario completada en 0.02s: 5 registros
2025-05-29 14:05:36.595 | INFO     | __main__:test_sync:55 - Sincronizando tabla: cuenta_mesa...
2025-05-29 14:05:36.596 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:05:36.596 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cuenta_mesa para tenant 1
2025-05-29 14:05:36.596 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:36.597 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 14:05:36.598 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:36.598 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:05:36.599 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para cuenta_mesa
2025-05-29 14:05:36.623 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de cuenta_mesa para tenant 1
2025-05-29 14:05:36.625 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.03 segundos
2025-05-29 14:05:36.627 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.03 segundos
2025-05-29 14:05:36.627 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:05:36.627 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cuenta_mesa para tenant_id=1
2025-05-29 14:05:36.640 | INFO     | etl.transform:transform_cuenta_mesa:206 - Transformados 5000 registros de cuenta mesa
2025-05-29 14:05:36.641 | DEBUG    | utils:wrapper:35 - Función transform_cuenta_mesa ejecutada en 0.01 segundos
2025-05-29 14:05:36.642 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 14:05:36.642 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:05:47.925 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_cuenta_mesas: 0 insertados, 5000 actualizados
2025-05-29 14:05:47.925 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 11.28 segundos
2025-05-29 14:05:47.926 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:47.927 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 14:05:47.928 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:47.928 | INFO     | etl.sync:sync_table:98 - Sincronización de cuenta_mesa completada: {'status': 'success', 'table': 'cuenta_mesa', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 11.33254}
2025-05-29 14:05:47.930 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 11.33 segundos
2025-05-29 14:05:47.930 | INFO     | __main__:test_sync:65 - Sincronización de cuenta_mesa completada en 11.33s: 5000 registros
2025-05-29 14:05:47.931 | INFO     | __main__:test_sync:55 - Sincronizando tabla: reserva...
2025-05-29 14:05:47.931 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:05:47.932 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de reserva para tenant 1
2025-05-29 14:05:47.933 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:47.936 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 14:05:47.936 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:47.937 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:05:47.938 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para reserva
2025-05-29 14:05:47.956 | INFO     | etl.extract:_extract_all:197 - Extraídos 3000 registros de reserva para tenant 1
2025-05-29 14:05:47.957 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.02 segundos
2025-05-29 14:05:47.958 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.02 segundos
2025-05-29 14:05:47.959 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:05:47.959 | DEBUG    | utils:wrapper:81 - Ejecutando transform_reserva para tenant_id=1
2025-05-29 14:05:47.968 | INFO     | etl.transform:transform_reserva:357 - Transformados 3000 registros de reserva
2025-05-29 14:05:47.969 | DEBUG    | utils:wrapper:35 - Función transform_reserva ejecutada en 0.01 segundos
2025-05-29 14:05:47.969 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 14:05:47.970 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:05:53.259 | INFO     | etl.load:load_records:106 - Cargados 3000 registros en raw_reservas: 0 insertados, 3000 actualizados
2025-05-29 14:05:53.260 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 5.29 segundos
2025-05-29 14:05:53.261 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:53.262 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 14:05:53.263 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:53.263 | INFO     | etl.sync:sync_table:98 - Sincronización de reserva completada: {'status': 'success', 'table': 'reserva', 'tenant_id': 1, 'records': 3000, 'inserted': 0, 'updated': 3000, 'duration_seconds': 5.329519}
2025-05-29 14:05:53.264 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 5.33 segundos
2025-05-29 14:05:53.264 | INFO     | __main__:test_sync:65 - Sincronización de reserva completada en 5.33s: 3000 registros
2025-05-29 14:05:53.265 | INFO     | __main__:test_sync:55 - Sincronizando tabla: venta...
2025-05-29 14:05:53.265 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:05:53.266 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de venta para tenant 1
2025-05-29 14:05:53.267 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:05:53.269 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 14:05:53.269 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:05:53.270 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:05:53.271 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para venta
2025-05-29 14:05:53.297 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de venta para tenant 1
2025-05-29 14:05:53.298 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.03 segundos
2025-05-29 14:05:53.299 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.03 segundos
2025-05-29 14:05:53.299 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:05:53.300 | DEBUG    | utils:wrapper:81 - Ejecutando transform_venta para tenant_id=1
2025-05-29 14:05:53.310 | INFO     | etl.transform:transform_venta:389 - Transformados 5000 registros de venta
2025-05-29 14:05:53.311 | DEBUG    | utils:wrapper:35 - Función transform_venta ejecutada en 0.01 segundos
2025-05-29 14:05:53.311 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 14:05:53.312 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:06:04.260 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_ventas: 0 insertados, 5000 actualizados
2025-05-29 14:06:04.261 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 10.95 segundos
2025-05-29 14:06:04.262 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:06:04.264 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 14:06:04.264 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:06:04.265 | INFO     | etl.sync:sync_table:98 - Sincronización de venta completada: {'status': 'success', 'table': 'venta', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 10.997669}
2025-05-29 14:06:04.266 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 11.00 segundos
2025-05-29 14:06:04.267 | INFO     | __main__:test_sync:65 - Sincronización de venta completada en 11.0s: 5000 registros
2025-05-29 14:06:04.267 | INFO     | __main__:test_sync:83 - Resumen de sincronización: 10 exitosas, 0 errores, 0 omitidas
2025-05-29 14:06:04.268 | INFO     | __main__:main:189 - Iniciando servicio de sincronización 24/7...
2025-05-29 14:06:04.268 | INFO     | __main__:sync_scheduled:100 - Iniciando sincronización programada cada 60 minutos para tenant 1
2025-05-29 14:06:04.269 | INFO     | __main__:sync_scheduled:107 - Ejecutando sincronización programada...
2025-05-29 14:06:04.269 | INFO     | __main__:sync_scheduled:116 - Realizando sincronización incremental...
2025-05-29 14:06:04.270 | DEBUG    | utils:wrapper:81 - Ejecutando sync_all_tables para tenant_id=1
2025-05-29 14:06:04.270 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:06:04.271 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido para tenant 1
2025-05-29 14:06:04.272 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:06:04.273 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:06:04.274 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:00:58.314000
2025-05-29 14:06:04.275 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:06:04.276 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 14:06:04.276 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:06:04.277 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:06:04.277 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para pedido (última: 2025-05-29 18:00:58.314000)
2025-05-29 14:06:04.296 | INFO     | etl.extract:extract_table:152 - Análisis para pedido: 7449 registros en PostgreSQL, 7449 en MongoDB
2025-05-29 14:06:04.296 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para pedido por eficiencia
2025-05-29 14:06:04.369 | INFO     | etl.extract:_extract_all:197 - Extraídos 7449 registros de pedido para tenant 1
2025-05-29 14:06:04.370 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.07 segundos
2025-05-29 14:06:04.371 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.09 segundos
2025-05-29 14:06:04.371 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:06:04.372 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido para tenant_id=1
2025-05-29 14:06:04.389 | INFO     | etl.transform:transform_pedido:51 - Transformados 7449 registros de pedido
2025-05-29 14:06:04.390 | DEBUG    | utils:wrapper:35 - Función transform_pedido ejecutada en 0.02 segundos
2025-05-29 14:06:04.391 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 14:06:04.391 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:06:31.463 | INFO     | etl.load:load_records:106 - Cargados 7449 registros en raw_pedidos: 0 insertados, 7449 actualizados
2025-05-29 14:06:31.464 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 27.07 segundos
2025-05-29 14:06:31.464 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:06:31.466 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 14:06:31.466 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:06:31.466 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido completada: {'status': 'success', 'table': 'pedido', 'tenant_id': 1, 'records': 7449, 'inserted': 0, 'updated': 7449, 'duration_seconds': 27.190948}
2025-05-29 14:06:31.468 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 27.20 segundos
2025-05-29 14:06:31.469 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:06:31.469 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido_detalle para tenant 1
2025-05-29 14:06:31.470 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:06:31.471 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:06:31.472 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:05:36.352000
2025-05-29 14:06:31.472 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:06:31.474 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 14:06:31.475 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:06:31.476 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:06:31.476 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para pedido_detalle (última: 2025-05-29 18:05:36.352000)
2025-05-29 14:06:31.531 | INFO     | etl.extract:extract_table:152 - Análisis para pedido_detalle: 25943 registros en PostgreSQL, 25943 en MongoDB
2025-05-29 14:06:31.532 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para pedido_detalle por eficiencia
2025-05-29 14:06:31.639 | INFO     | etl.extract:_extract_all:197 - Extraídos 25943 registros de pedido_detalle para tenant 1
2025-05-29 14:06:31.641 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.11 segundos
2025-05-29 14:06:31.642 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.17 segundos
2025-05-29 14:06:31.643 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:06:31.643 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido_detalle para tenant_id=1
2025-05-29 14:06:31.685 | INFO     | etl.transform:transform_pedido_detalle:85 - Transformados 25943 registros de detalle de pedido
2025-05-29 14:06:31.685 | DEBUG    | utils:wrapper:35 - Función transform_pedido_detalle ejecutada en 0.04 segundos
2025-05-29 14:06:31.686 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.04 segundos
2025-05-29 14:06:31.687 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:11:24.605 | INFO     | etl.load:load_records:106 - Cargados 25943 registros en raw_pedido_detalles: 0 insertados, 25943 actualizados
2025-05-29 14:11:24.606 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 292.92 segundos
2025-05-29 14:11:24.606 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.608 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 14:11:24.608 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.609 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido_detalle completada: {'status': 'success', 'table': 'pedido_detalle', 'tenant_id': 1, 'records': 25943, 'inserted': 0, 'updated': 25943, 'duration_seconds': 293.13696}
2025-05-29 14:11:24.616 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 293.15 segundos
2025-05-29 14:11:24.617 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:11:24.618 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de producto para tenant 1
2025-05-29 14:11:24.618 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:11:24.620 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.621 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:05:36.401000
2025-05-29 14:11:24.621 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.623 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 14:11:24.624 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.624 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:11:24.625 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para producto (última: 2025-05-29 18:05:36.401000)
2025-05-29 14:11:24.629 | INFO     | etl.extract:extract_table:152 - Análisis para producto: 30 registros en PostgreSQL, 30 en MongoDB
2025-05-29 14:11:24.629 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para producto por eficiencia
2025-05-29 14:11:24.631 | INFO     | etl.extract:_extract_all:197 - Extraídos 30 registros de producto para tenant 1
2025-05-29 14:11:24.632 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:11:24.633 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:11:24.633 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:11:24.634 | DEBUG    | utils:wrapper:81 - Ejecutando transform_producto para tenant_id=1
2025-05-29 14:11:24.634 | INFO     | etl.transform:transform_producto:123 - Transformados 30 registros de producto
2025-05-29 14:11:24.635 | DEBUG    | utils:wrapper:35 - Función transform_producto ejecutada en 0.00 segundos
2025-05-29 14:11:24.635 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:11:24.635 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:11:24.652 | INFO     | etl.load:load_records:106 - Cargados 30 registros en raw_productos: 0 insertados, 30 actualizados
2025-05-29 14:11:24.652 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.02 segundos
2025-05-29 14:11:24.653 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.655 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 14:11:24.655 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.657 | INFO     | etl.sync:sync_table:98 - Sincronización de producto completada: {'status': 'success', 'table': 'producto', 'tenant_id': 1, 'records': 30, 'inserted': 0, 'updated': 30, 'duration_seconds': 0.0357}
2025-05-29 14:11:24.657 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.04 segundos
2025-05-29 14:11:24.658 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:11:24.659 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cliente para tenant 1
2025-05-29 14:11:24.660 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:11:24.661 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.662 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:05:36.537000
2025-05-29 14:11:24.663 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.664 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 14:11:24.665 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.665 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:11:24.665 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para cliente (última: 2025-05-29 18:05:36.537000)
2025-05-29 14:11:24.669 | INFO     | etl.extract:extract_table:152 - Análisis para cliente: 167 registros en PostgreSQL, 167 en MongoDB
2025-05-29 14:11:24.670 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para cliente por eficiencia
2025-05-29 14:11:24.672 | INFO     | etl.extract:_extract_all:197 - Extraídos 167 registros de cliente para tenant 1
2025-05-29 14:11:24.673 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:11:24.674 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:11:24.674 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:11:24.676 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cliente para tenant_id=1
2025-05-29 14:11:24.677 | INFO     | etl.transform:transform_cliente:255 - Transformados 167 registros de cliente
2025-05-29 14:11:24.677 | DEBUG    | utils:wrapper:35 - Función transform_cliente ejecutada en 0.00 segundos
2025-05-29 14:11:24.678 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:11:24.679 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:11:24.793 | INFO     | etl.load:load_records:106 - Cargados 167 registros en raw_clientes: 0 insertados, 167 actualizados
2025-05-29 14:11:24.794 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.12 segundos
2025-05-29 14:11:24.795 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.797 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 14:11:24.797 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.797 | INFO     | etl.sync:sync_table:98 - Sincronización de cliente completada: {'status': 'success', 'table': 'cliente', 'tenant_id': 1, 'records': 167, 'inserted': 0, 'updated': 167, 'duration_seconds': 0.134107}
2025-05-29 14:11:24.799 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.14 segundos
2025-05-29 14:11:24.799 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:11:24.800 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de mesa para tenant 1
2025-05-29 14:11:24.800 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:11:24.802 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.802 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:05:36.559000
2025-05-29 14:11:24.803 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.805 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 14:11:24.806 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.807 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:11:24.808 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para mesa (última: 2025-05-29 18:05:36.559000)
2025-05-29 14:11:24.810 | INFO     | etl.extract:extract_table:152 - Análisis para mesa: 15 registros en PostgreSQL, 15 en MongoDB
2025-05-29 14:11:24.811 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para mesa por eficiencia
2025-05-29 14:11:24.813 | INFO     | etl.extract:_extract_all:197 - Extraídos 15 registros de mesa para tenant 1
2025-05-29 14:11:24.814 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:11:24.815 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:11:24.816 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:11:24.816 | DEBUG    | utils:wrapper:81 - Ejecutando transform_mesa para tenant_id=1
2025-05-29 14:11:24.817 | INFO     | etl.transform:transform_mesa:286 - Transformados 15 registros de mesa
2025-05-29 14:11:24.817 | DEBUG    | utils:wrapper:35 - Función transform_mesa ejecutada en 0.00 segundos
2025-05-29 14:11:24.818 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:11:24.818 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:11:24.828 | INFO     | etl.load:load_records:106 - Cargados 15 registros en raw_mesas: 0 insertados, 15 actualizados
2025-05-29 14:11:24.828 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 14:11:24.829 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.830 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 14:11:24.831 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.831 | INFO     | etl.sync:sync_table:98 - Sincronización de mesa completada: {'status': 'success', 'table': 'mesa', 'tenant_id': 1, 'records': 15, 'inserted': 0, 'updated': 15, 'duration_seconds': 0.028316}
2025-05-29 14:11:24.831 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.03 segundos
2025-05-29 14:11:24.832 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:11:24.833 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de categoria para tenant 1
2025-05-29 14:11:24.833 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:11:24.834 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.835 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:05:36.576000
2025-05-29 14:11:24.835 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.836 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 14:11:24.837 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.837 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:11:24.838 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para categoria (última: 2025-05-29 18:05:36.576000)
2025-05-29 14:11:24.840 | INFO     | etl.extract:extract_table:152 - Análisis para categoria: 8 registros en PostgreSQL, 8 en MongoDB
2025-05-29 14:11:24.841 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para categoria por eficiencia
2025-05-29 14:11:24.843 | INFO     | etl.extract:_extract_all:197 - Extraídos 8 registros de categoria para tenant 1
2025-05-29 14:11:24.843 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:11:24.844 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:11:24.845 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:11:24.845 | DEBUG    | utils:wrapper:81 - Ejecutando transform_categoria para tenant_id=1
2025-05-29 14:11:24.846 | INFO     | etl.transform:transform_categoria:153 - Transformados 8 registros de categoría
2025-05-29 14:11:24.847 | DEBUG    | utils:wrapper:35 - Función transform_categoria ejecutada en 0.00 segundos
2025-05-29 14:11:24.848 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:11:24.848 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:11:24.852 | INFO     | etl.load:load_records:106 - Cargados 8 registros en raw_categorias: 0 insertados, 8 actualizados
2025-05-29 14:11:24.853 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.00 segundos
2025-05-29 14:11:24.853 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.854 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 14:11:24.855 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.855 | INFO     | etl.sync:sync_table:98 - Sincronización de categoria completada: {'status': 'success', 'table': 'categoria', 'tenant_id': 1, 'records': 8, 'inserted': 0, 'updated': 8, 'duration_seconds': 0.019744}
2025-05-29 14:11:24.856 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 14:11:24.856 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:11:24.856 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de usuario para tenant 1
2025-05-29 14:11:24.857 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:11:24.858 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.858 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:05:36.592000
2025-05-29 14:11:24.859 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.860 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 14:11:24.862 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.863 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:11:24.864 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para usuario (última: 2025-05-29 18:05:36.592000)
2025-05-29 14:11:24.866 | INFO     | etl.extract:extract_table:152 - Análisis para usuario: 5 registros en PostgreSQL, 5 en MongoDB
2025-05-29 14:11:24.867 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para usuario por eficiencia
2025-05-29 14:11:24.868 | INFO     | etl.extract:_extract_all:197 - Extraídos 5 registros de usuario para tenant 1
2025-05-29 14:11:24.869 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:11:24.869 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:11:24.870 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:11:24.870 | WARNING  | etl.transform:batch_transform:410 - No hay método de transformación específico para usuario
2025-05-29 14:11:24.870 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:11:24.871 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:11:24.874 | INFO     | etl.load:load_records:106 - Cargados 5 registros en raw_usuarios: 0 insertados, 5 actualizados
2025-05-29 14:11:24.874 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.00 segundos
2025-05-29 14:11:24.875 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.877 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 14:11:24.878 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.878 | INFO     | etl.sync:sync_table:98 - Sincronización de usuario completada: {'status': 'success', 'table': 'usuario', 'tenant_id': 1, 'records': 5, 'inserted': 0, 'updated': 5, 'duration_seconds': 0.018464}
2025-05-29 14:11:24.879 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 14:11:24.879 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:11:24.879 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cuenta_mesa para tenant 1
2025-05-29 14:11:24.880 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:11:24.881 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.882 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:05:47.926000
2025-05-29 14:11:24.882 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:24.884 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 14:11:24.884 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:24.885 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:11:24.886 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para cuenta_mesa (última: 2025-05-29 18:05:47.926000)
2025-05-29 14:11:24.902 | INFO     | etl.extract:extract_table:152 - Análisis para cuenta_mesa: 5000 registros en PostgreSQL, 5000 en MongoDB
2025-05-29 14:11:24.902 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para cuenta_mesa por eficiencia
2025-05-29 14:11:24.930 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de cuenta_mesa para tenant 1
2025-05-29 14:11:24.931 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.03 segundos
2025-05-29 14:11:24.933 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.05 segundos
2025-05-29 14:11:24.933 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:11:24.934 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cuenta_mesa para tenant_id=1
2025-05-29 14:11:24.949 | INFO     | etl.transform:transform_cuenta_mesa:206 - Transformados 5000 registros de cuenta mesa
2025-05-29 14:11:24.949 | DEBUG    | utils:wrapper:35 - Función transform_cuenta_mesa ejecutada en 0.02 segundos
2025-05-29 14:11:24.950 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 14:11:24.951 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:11:37.042 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_cuenta_mesas: 0 insertados, 5000 actualizados
2025-05-29 14:11:37.043 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 12.09 segundos
2025-05-29 14:11:37.043 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:37.045 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 14:11:37.046 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:37.046 | INFO     | etl.sync:sync_table:98 - Sincronización de cuenta_mesa completada: {'status': 'success', 'table': 'cuenta_mesa', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 12.163929}
2025-05-29 14:11:37.047 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 12.17 segundos
2025-05-29 14:11:37.048 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:11:37.049 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de reserva para tenant 1
2025-05-29 14:11:37.049 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:11:37.050 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:37.051 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:05:53.261000
2025-05-29 14:11:37.052 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:37.054 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 14:11:37.055 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:37.055 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:11:37.056 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para reserva (última: 2025-05-29 18:05:53.261000)
2025-05-29 14:11:37.067 | INFO     | etl.extract:extract_table:152 - Análisis para reserva: 3000 registros en PostgreSQL, 3000 en MongoDB
2025-05-29 14:11:37.068 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para reserva por eficiencia
2025-05-29 14:11:37.084 | INFO     | etl.extract:_extract_all:197 - Extraídos 3000 registros de reserva para tenant 1
2025-05-29 14:11:37.084 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.02 segundos
2025-05-29 14:11:37.085 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.03 segundos
2025-05-29 14:11:37.086 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:11:37.086 | DEBUG    | utils:wrapper:81 - Ejecutando transform_reserva para tenant_id=1
2025-05-29 14:11:37.094 | INFO     | etl.transform:transform_reserva:357 - Transformados 3000 registros de reserva
2025-05-29 14:11:37.094 | DEBUG    | utils:wrapper:35 - Función transform_reserva ejecutada en 0.01 segundos
2025-05-29 14:11:37.094 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 14:11:37.096 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:11:41.313 | INFO     | etl.load:load_records:106 - Cargados 3000 registros en raw_reservas: 0 insertados, 3000 actualizados
2025-05-29 14:11:41.314 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 4.22 segundos
2025-05-29 14:11:41.314 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:41.316 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 14:11:41.317 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:41.317 | INFO     | etl.sync:sync_table:98 - Sincronización de reserva completada: {'status': 'success', 'table': 'reserva', 'tenant_id': 1, 'records': 3000, 'inserted': 0, 'updated': 3000, 'duration_seconds': 4.265682}
2025-05-29 14:11:41.318 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 4.27 segundos
2025-05-29 14:11:41.318 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:11:41.319 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de venta para tenant 1
2025-05-29 14:11:41.320 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:11:41.321 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:41.322 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:06:04.262000
2025-05-29 14:11:41.322 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:41.324 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 14:11:41.324 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:41.325 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:11:41.326 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para venta (última: 2025-05-29 18:06:04.262000)
2025-05-29 14:11:41.341 | INFO     | etl.extract:extract_table:152 - Análisis para venta: 5000 registros en PostgreSQL, 5000 en MongoDB
2025-05-29 14:11:41.342 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para venta por eficiencia
2025-05-29 14:11:41.365 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de venta para tenant 1
2025-05-29 14:11:41.366 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.02 segundos
2025-05-29 14:11:41.367 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.04 segundos
2025-05-29 14:11:41.368 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:11:41.369 | DEBUG    | utils:wrapper:81 - Ejecutando transform_venta para tenant_id=1
2025-05-29 14:11:41.378 | INFO     | etl.transform:transform_venta:389 - Transformados 5000 registros de venta
2025-05-29 14:11:41.379 | DEBUG    | utils:wrapper:35 - Función transform_venta ejecutada en 0.01 segundos
2025-05-29 14:11:41.379 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 14:11:41.381 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:11:52.922 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_ventas: 0 insertados, 5000 actualizados
2025-05-29 14:11:52.923 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 11.54 segundos
2025-05-29 14:11:52.924 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:11:52.925 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 14:11:52.926 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:11:52.926 | INFO     | etl.sync:sync_table:98 - Sincronización de venta completada: {'status': 'success', 'table': 'venta', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 11.603709}
2025-05-29 14:11:52.928 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 11.61 segundos
2025-05-29 14:11:52.929 | DEBUG    | utils:wrapper:35 - Función sync_all_tables ejecutada en 348.66 segundos
2025-05-29 14:11:52.929 | INFO     | __main__:sync_scheduled:135 - Sincronización completada en 348.66s: 10 tablas exitosas, 0 errores, 0 omitidas, 46617 registros procesados
2025-05-29 14:11:52.930 | INFO     | __main__:sync_scheduled:142 - Próxima sincronización programada a las 2025-05-29 14:26:52 (en 60 minutos)
2025-05-29 14:26:52.931 | INFO     | __main__:sync_scheduled:107 - Ejecutando sincronización programada...
2025-05-29 14:26:52.933 | INFO     | __main__:sync_scheduled:116 - Realizando sincronización incremental...
2025-05-29 14:26:52.935 | DEBUG    | utils:wrapper:81 - Ejecutando sync_all_tables para tenant_id=1
2025-05-29 14:26:52.936 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:26:52.938 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido para tenant 1
2025-05-29 14:26:52.939 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:26:52.944 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:26:52.945 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:06:31.465000
2025-05-29 14:26:52.947 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:26:52.951 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 14:26:52.952 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:26:52.954 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:26:52.955 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para pedido (última: 2025-05-29 18:06:31.465000)
2025-05-29 14:26:52.982 | INFO     | etl.extract:extract_table:152 - Análisis para pedido: 7449 registros en PostgreSQL, 7449 en MongoDB
2025-05-29 14:26:52.983 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para pedido por eficiencia
2025-05-29 14:26:53.059 | INFO     | etl.extract:_extract_all:197 - Extraídos 7449 registros de pedido para tenant 1
2025-05-29 14:26:53.061 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.08 segundos
2025-05-29 14:26:53.063 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.11 segundos
2025-05-29 14:26:53.065 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:26:53.065 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido para tenant_id=1
2025-05-29 14:26:53.102 | INFO     | etl.transform:transform_pedido:51 - Transformados 7449 registros de pedido
2025-05-29 14:26:53.103 | DEBUG    | utils:wrapper:35 - Función transform_pedido ejecutada en 0.04 segundos
2025-05-29 14:26:53.105 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.04 segundos
2025-05-29 14:26:53.106 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:27:09.784 | INFO     | etl.load:load_records:106 - Cargados 7449 registros en raw_pedidos: 0 insertados, 7449 actualizados
2025-05-29 14:27:09.784 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 16.68 segundos
2025-05-29 14:27:09.785 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:27:09.787 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 14:27:09.788 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:27:09.789 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido completada: {'status': 'success', 'table': 'pedido', 'tenant_id': 1, 'records': 7449, 'inserted': 0, 'updated': 7449, 'duration_seconds': 16.841376}
2025-05-29 14:27:09.792 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 16.86 segundos
2025-05-29 14:27:09.793 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:27:09.794 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido_detalle para tenant 1
2025-05-29 14:27:09.795 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:27:09.797 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:27:09.798 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:11:24.607000
2025-05-29 14:27:09.798 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:27:09.800 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 14:27:09.801 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:27:09.802 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:27:09.802 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para pedido_detalle (última: 2025-05-29 18:11:24.607000)
2025-05-29 14:27:09.860 | INFO     | etl.extract:extract_table:152 - Análisis para pedido_detalle: 25943 registros en PostgreSQL, 25943 en MongoDB
2025-05-29 14:27:09.861 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para pedido_detalle por eficiencia
2025-05-29 14:27:10.076 | INFO     | etl.extract:_extract_all:197 - Extraídos 25943 registros de pedido_detalle para tenant 1
2025-05-29 14:27:10.078 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.22 segundos
2025-05-29 14:27:10.081 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.28 segundos
2025-05-29 14:27:10.082 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:27:10.083 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido_detalle para tenant_id=1
2025-05-29 14:27:10.166 | INFO     | etl.transform:transform_pedido_detalle:85 - Transformados 25943 registros de detalle de pedido
2025-05-29 14:27:10.167 | DEBUG    | utils:wrapper:35 - Función transform_pedido_detalle ejecutada en 0.08 segundos
2025-05-29 14:27:10.168 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.09 segundos
2025-05-29 14:27:10.169 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:32:08.899 | INFO     | etl.load:load_records:106 - Cargados 25943 registros en raw_pedido_detalles: 0 insertados, 25943 actualizados
2025-05-29 14:32:08.900 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 298.73 segundos
2025-05-29 14:32:08.902 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:08.904 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 14:32:08.905 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:08.907 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido_detalle completada: {'status': 'success', 'table': 'pedido_detalle', 'tenant_id': 1, 'records': 25943, 'inserted': 0, 'updated': 25943, 'duration_seconds': 299.108611}
2025-05-29 14:32:08.917 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 299.12 segundos
2025-05-29 14:32:08.918 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:32:08.919 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de producto para tenant 1
2025-05-29 14:32:08.920 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:32:08.922 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:08.923 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:11:24.654000
2025-05-29 14:32:08.924 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:08.927 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 14:32:08.929 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:08.929 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:32:08.931 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para producto (última: 2025-05-29 18:11:24.654000)
2025-05-29 14:32:08.935 | INFO     | etl.extract:extract_table:152 - Análisis para producto: 30 registros en PostgreSQL, 30 en MongoDB
2025-05-29 14:32:08.937 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para producto por eficiencia
2025-05-29 14:32:08.939 | INFO     | etl.extract:_extract_all:197 - Extraídos 30 registros de producto para tenant 1
2025-05-29 14:32:08.941 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:32:08.943 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:32:08.944 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:32:08.946 | DEBUG    | utils:wrapper:81 - Ejecutando transform_producto para tenant_id=1
2025-05-29 14:32:08.947 | INFO     | etl.transform:transform_producto:123 - Transformados 30 registros de producto
2025-05-29 14:32:08.948 | DEBUG    | utils:wrapper:35 - Función transform_producto ejecutada en 0.00 segundos
2025-05-29 14:32:08.949 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:32:08.951 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:32:08.980 | INFO     | etl.load:load_records:106 - Cargados 30 registros en raw_productos: 0 insertados, 30 actualizados
2025-05-29 14:32:08.981 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.03 segundos
2025-05-29 14:32:08.982 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:08.984 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 14:32:08.985 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:08.986 | INFO     | etl.sync:sync_table:98 - Sincronización de producto completada: {'status': 'success', 'table': 'producto', 'tenant_id': 1, 'records': 30, 'inserted': 0, 'updated': 30, 'duration_seconds': 0.061916}
2025-05-29 14:32:08.987 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.07 segundos
2025-05-29 14:32:08.989 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:32:08.990 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cliente para tenant 1
2025-05-29 14:32:08.991 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:32:08.994 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:08.995 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:11:24.795000
2025-05-29 14:32:08.997 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:09.001 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 14:32:09.002 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.002 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:32:09.003 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para cliente (última: 2025-05-29 18:11:24.795000)
2025-05-29 14:32:09.008 | INFO     | etl.extract:extract_table:152 - Análisis para cliente: 167 registros en PostgreSQL, 167 en MongoDB
2025-05-29 14:32:09.010 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para cliente por eficiencia
2025-05-29 14:32:09.014 | INFO     | etl.extract:_extract_all:197 - Extraídos 167 registros de cliente para tenant 1
2025-05-29 14:32:09.016 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.01 segundos
2025-05-29 14:32:09.017 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.02 segundos
2025-05-29 14:32:09.018 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:32:09.019 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cliente para tenant_id=1
2025-05-29 14:32:09.020 | INFO     | etl.transform:transform_cliente:255 - Transformados 167 registros de cliente
2025-05-29 14:32:09.021 | DEBUG    | utils:wrapper:35 - Función transform_cliente ejecutada en 0.00 segundos
2025-05-29 14:32:09.022 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:32:09.022 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:32:09.154 | INFO     | etl.load:load_records:106 - Cargados 167 registros en raw_clientes: 0 insertados, 167 actualizados
2025-05-29 14:32:09.155 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.13 segundos
2025-05-29 14:32:09.156 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:09.157 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 14:32:09.159 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.160 | INFO     | etl.sync:sync_table:98 - Sincronización de cliente completada: {'status': 'success', 'table': 'cliente', 'tenant_id': 1, 'records': 167, 'inserted': 0, 'updated': 167, 'duration_seconds': 0.162972}
2025-05-29 14:32:09.161 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.17 segundos
2025-05-29 14:32:09.162 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:32:09.164 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de mesa para tenant 1
2025-05-29 14:32:09.165 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:32:09.167 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.169 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:11:24.829000
2025-05-29 14:32:09.169 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:09.172 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 14:32:09.173 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.174 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:32:09.175 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para mesa (última: 2025-05-29 18:11:24.829000)
2025-05-29 14:32:09.178 | INFO     | etl.extract:extract_table:152 - Análisis para mesa: 15 registros en PostgreSQL, 15 en MongoDB
2025-05-29 14:32:09.179 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para mesa por eficiencia
2025-05-29 14:32:09.180 | INFO     | etl.extract:_extract_all:197 - Extraídos 15 registros de mesa para tenant 1
2025-05-29 14:32:09.182 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:32:09.183 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:32:09.184 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:32:09.185 | DEBUG    | utils:wrapper:81 - Ejecutando transform_mesa para tenant_id=1
2025-05-29 14:32:09.186 | INFO     | etl.transform:transform_mesa:286 - Transformados 15 registros de mesa
2025-05-29 14:32:09.186 | DEBUG    | utils:wrapper:35 - Función transform_mesa ejecutada en 0.00 segundos
2025-05-29 14:32:09.187 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:32:09.188 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:32:09.202 | INFO     | etl.load:load_records:106 - Cargados 15 registros en raw_mesas: 0 insertados, 15 actualizados
2025-05-29 14:32:09.203 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.02 segundos
2025-05-29 14:32:09.203 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:09.204 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 14:32:09.206 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.207 | INFO     | etl.sync:sync_table:98 - Sincronización de mesa completada: {'status': 'success', 'table': 'mesa', 'tenant_id': 1, 'records': 15, 'inserted': 0, 'updated': 15, 'duration_seconds': 0.03806}
2025-05-29 14:32:09.208 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.05 segundos
2025-05-29 14:32:09.210 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:32:09.210 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de categoria para tenant 1
2025-05-29 14:32:09.211 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:32:09.215 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.216 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:11:24.853000
2025-05-29 14:32:09.216 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:09.218 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 14:32:09.220 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.221 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:32:09.222 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para categoria (última: 2025-05-29 18:11:24.853000)
2025-05-29 14:32:09.225 | INFO     | etl.extract:extract_table:152 - Análisis para categoria: 8 registros en PostgreSQL, 8 en MongoDB
2025-05-29 14:32:09.226 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para categoria por eficiencia
2025-05-29 14:32:09.228 | INFO     | etl.extract:_extract_all:197 - Extraídos 8 registros de categoria para tenant 1
2025-05-29 14:32:09.229 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:32:09.231 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:32:09.232 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:32:09.232 | DEBUG    | utils:wrapper:81 - Ejecutando transform_categoria para tenant_id=1
2025-05-29 14:32:09.232 | INFO     | etl.transform:transform_categoria:153 - Transformados 8 registros de categoría
2025-05-29 14:32:09.234 | DEBUG    | utils:wrapper:35 - Función transform_categoria ejecutada en 0.00 segundos
2025-05-29 14:32:09.235 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:32:09.236 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:32:09.243 | INFO     | etl.load:load_records:106 - Cargados 8 registros en raw_categorias: 0 insertados, 8 actualizados
2025-05-29 14:32:09.245 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 14:32:09.246 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:09.248 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 14:32:09.248 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.249 | INFO     | etl.sync:sync_table:98 - Sincronización de categoria completada: {'status': 'success', 'table': 'categoria', 'tenant_id': 1, 'records': 8, 'inserted': 0, 'updated': 8, 'duration_seconds': 0.03335}
2025-05-29 14:32:09.250 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.04 segundos
2025-05-29 14:32:09.252 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:32:09.253 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de usuario para tenant 1
2025-05-29 14:32:09.254 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:32:09.256 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.257 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:11:24.875000
2025-05-29 14:32:09.258 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:09.261 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 14:32:09.262 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.262 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:32:09.262 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para usuario (última: 2025-05-29 18:11:24.875000)
2025-05-29 14:32:09.267 | INFO     | etl.extract:extract_table:152 - Análisis para usuario: 5 registros en PostgreSQL, 5 en MongoDB
2025-05-29 14:32:09.268 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para usuario por eficiencia
2025-05-29 14:32:09.271 | INFO     | etl.extract:_extract_all:197 - Extraídos 5 registros de usuario para tenant 1
2025-05-29 14:32:09.272 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:32:09.274 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:32:09.274 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:32:09.275 | WARNING  | etl.transform:batch_transform:410 - No hay método de transformación específico para usuario
2025-05-29 14:32:09.276 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:32:09.277 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:32:09.281 | INFO     | etl.load:load_records:106 - Cargados 5 registros en raw_usuarios: 0 insertados, 5 actualizados
2025-05-29 14:32:09.282 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.00 segundos
2025-05-29 14:32:09.283 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:09.284 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 14:32:09.285 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.287 | INFO     | etl.sync:sync_table:98 - Sincronización de usuario completada: {'status': 'success', 'table': 'usuario', 'tenant_id': 1, 'records': 5, 'inserted': 0, 'updated': 5, 'duration_seconds': 0.028656}
2025-05-29 14:32:09.288 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.04 segundos
2025-05-29 14:32:09.289 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:32:09.290 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cuenta_mesa para tenant 1
2025-05-29 14:32:09.291 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:32:09.293 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.293 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:11:37.044000
2025-05-29 14:32:09.294 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:09.296 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 14:32:09.296 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:09.297 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:32:09.298 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para cuenta_mesa (última: 2025-05-29 18:11:37.044000)
2025-05-29 14:32:09.321 | INFO     | etl.extract:extract_table:152 - Análisis para cuenta_mesa: 5000 registros en PostgreSQL, 5000 en MongoDB
2025-05-29 14:32:09.323 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para cuenta_mesa por eficiencia
2025-05-29 14:32:09.378 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de cuenta_mesa para tenant 1
2025-05-29 14:32:09.380 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.06 segundos
2025-05-29 14:32:09.381 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.08 segundos
2025-05-29 14:32:09.382 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:32:09.383 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cuenta_mesa para tenant_id=1
2025-05-29 14:32:09.415 | INFO     | etl.transform:transform_cuenta_mesa:206 - Transformados 5000 registros de cuenta mesa
2025-05-29 14:32:09.417 | DEBUG    | utils:wrapper:35 - Función transform_cuenta_mesa ejecutada en 0.03 segundos
2025-05-29 14:32:09.417 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.04 segundos
2025-05-29 14:32:09.419 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:32:21.236 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_cuenta_mesas: 0 insertados, 5000 actualizados
2025-05-29 14:32:21.237 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 11.82 segundos
2025-05-29 14:32:21.238 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:21.240 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 14:32:21.241 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:21.242 | INFO     | etl.sync:sync_table:98 - Sincronización de cuenta_mesa completada: {'status': 'success', 'table': 'cuenta_mesa', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 11.947732}
2025-05-29 14:32:21.245 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 11.96 segundos
2025-05-29 14:32:21.247 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:32:21.248 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de reserva para tenant 1
2025-05-29 14:32:21.250 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:32:21.252 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:21.253 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:11:41.315000
2025-05-29 14:32:21.253 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:21.255 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 14:32:21.255 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:21.257 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:32:21.258 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para reserva (última: 2025-05-29 18:11:41.315000)
2025-05-29 14:32:21.276 | INFO     | etl.extract:extract_table:152 - Análisis para reserva: 3000 registros en PostgreSQL, 3000 en MongoDB
2025-05-29 14:32:21.277 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para reserva por eficiencia
2025-05-29 14:32:21.315 | INFO     | etl.extract:_extract_all:197 - Extraídos 3000 registros de reserva para tenant 1
2025-05-29 14:32:21.316 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.04 segundos
2025-05-29 14:32:21.318 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.06 segundos
2025-05-29 14:32:21.320 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:32:21.321 | DEBUG    | utils:wrapper:81 - Ejecutando transform_reserva para tenant_id=1
2025-05-29 14:32:21.339 | INFO     | etl.transform:transform_reserva:357 - Transformados 3000 registros de reserva
2025-05-29 14:32:21.340 | DEBUG    | utils:wrapper:35 - Función transform_reserva ejecutada en 0.02 segundos
2025-05-29 14:32:21.341 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 14:32:21.342 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:32:25.993 | INFO     | etl.load:load_records:106 - Cargados 3000 registros en raw_reservas: 0 insertados, 3000 actualizados
2025-05-29 14:32:25.994 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 4.65 segundos
2025-05-29 14:32:25.994 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:25.996 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 14:32:25.997 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:25.998 | INFO     | etl.sync:sync_table:98 - Sincronización de reserva completada: {'status': 'success', 'table': 'reserva', 'tenant_id': 1, 'records': 3000, 'inserted': 0, 'updated': 3000, 'duration_seconds': 4.74413}
2025-05-29 14:32:26.000 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 4.75 segundos
2025-05-29 14:32:26.002 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:32:26.003 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de venta para tenant 1
2025-05-29 14:32:26.004 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:32:26.007 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:26.008 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:11:52.924000
2025-05-29 14:32:26.010 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:26.012 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 14:32:26.012 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:26.013 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:32:26.015 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para venta (última: 2025-05-29 18:11:52.924000)
2025-05-29 14:32:26.035 | INFO     | etl.extract:extract_table:152 - Análisis para venta: 5000 registros en PostgreSQL, 5000 en MongoDB
2025-05-29 14:32:26.036 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para venta por eficiencia
2025-05-29 14:32:26.083 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de venta para tenant 1
2025-05-29 14:32:26.085 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.05 segundos
2025-05-29 14:32:26.087 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.07 segundos
2025-05-29 14:32:26.088 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:32:26.090 | DEBUG    | utils:wrapper:81 - Ejecutando transform_venta para tenant_id=1
2025-05-29 14:32:26.112 | INFO     | etl.transform:transform_venta:389 - Transformados 5000 registros de venta
2025-05-29 14:32:26.114 | DEBUG    | utils:wrapper:35 - Función transform_venta ejecutada en 0.02 segundos
2025-05-29 14:32:26.115 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.03 segundos
2025-05-29 14:32:26.116 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:32:37.741 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_ventas: 0 insertados, 5000 actualizados
2025-05-29 14:32:37.742 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 11.63 segundos
2025-05-29 14:32:37.743 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:32:37.745 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 14:32:37.745 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:32:37.746 | INFO     | etl.sync:sync_table:98 - Sincronización de venta completada: {'status': 'success', 'table': 'venta', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 11.735762}
2025-05-29 14:32:37.749 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 11.75 segundos
2025-05-29 14:32:37.750 | DEBUG    | utils:wrapper:35 - Función sync_all_tables ejecutada en 344.81 segundos
2025-05-29 14:32:37.752 | INFO     | __main__:sync_scheduled:135 - Sincronización completada en 344.82s: 10 tablas exitosas, 0 errores, 0 omitidas, 46617 registros procesados
2025-05-29 14:32:37.753 | INFO     | __main__:sync_scheduled:142 - Próxima sincronización programada a las 2025-05-29 14:47:37 (en 60 minutos)
2025-05-29 14:47:37.755 | INFO     | __main__:sync_scheduled:107 - Ejecutando sincronización programada...
2025-05-29 14:47:37.757 | INFO     | __main__:sync_scheduled:116 - Realizando sincronización incremental...
2025-05-29 14:47:37.758 | DEBUG    | utils:wrapper:81 - Ejecutando sync_all_tables para tenant_id=1
2025-05-29 14:47:37.760 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:47:37.761 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido para tenant 1
2025-05-29 14:47:37.762 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:47:37.766 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:47:37.766 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:27:09.786000
2025-05-29 14:47:37.767 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:47:37.770 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 14:47:37.770 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:47:37.771 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:47:37.772 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para pedido (última: 2025-05-29 18:27:09.786000)
2025-05-29 14:47:37.789 | INFO     | etl.extract:extract_table:152 - Análisis para pedido: 7449 registros en PostgreSQL, 7449 en MongoDB
2025-05-29 14:47:37.790 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para pedido por eficiencia
2025-05-29 14:47:37.823 | INFO     | etl.extract:_extract_all:197 - Extraídos 7449 registros de pedido para tenant 1
2025-05-29 14:47:37.824 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.03 segundos
2025-05-29 14:47:37.825 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.05 segundos
2025-05-29 14:47:37.825 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:47:37.826 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido para tenant_id=1
2025-05-29 14:47:37.841 | INFO     | etl.transform:transform_pedido:51 - Transformados 7449 registros de pedido
2025-05-29 14:47:37.843 | DEBUG    | utils:wrapper:35 - Función transform_pedido ejecutada en 0.02 segundos
2025-05-29 14:47:37.843 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 14:47:37.844 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:47:55.608 | INFO     | etl.load:load_records:106 - Cargados 7449 registros en raw_pedidos: 0 insertados, 7449 actualizados
2025-05-29 14:47:55.609 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 17.77 segundos
2025-05-29 14:47:55.609 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:47:55.611 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 14:47:55.611 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:47:55.612 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido completada: {'status': 'success', 'table': 'pedido', 'tenant_id': 1, 'records': 7449, 'inserted': 0, 'updated': 7449, 'duration_seconds': 17.844266}
2025-05-29 14:47:55.613 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 17.85 segundos
2025-05-29 14:47:55.614 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:47:55.615 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido_detalle para tenant 1
2025-05-29 14:47:55.615 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:47:55.617 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:47:55.618 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:32:08.903000
2025-05-29 14:47:55.618 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:47:55.620 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 14:47:55.621 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:47:55.621 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:47:55.622 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para pedido_detalle (última: 2025-05-29 18:32:08.903000)
2025-05-29 14:47:55.671 | INFO     | etl.extract:extract_table:152 - Análisis para pedido_detalle: 25943 registros en PostgreSQL, 25943 en MongoDB
2025-05-29 14:47:55.672 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para pedido_detalle por eficiencia
2025-05-29 14:47:55.778 | INFO     | etl.extract:_extract_all:197 - Extraídos 25943 registros de pedido_detalle para tenant 1
2025-05-29 14:47:55.780 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.11 segundos
2025-05-29 14:47:55.781 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.16 segundos
2025-05-29 14:47:55.782 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:47:55.782 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido_detalle para tenant_id=1
2025-05-29 14:47:55.821 | INFO     | etl.transform:transform_pedido_detalle:85 - Transformados 25943 registros de detalle de pedido
2025-05-29 14:47:55.822 | DEBUG    | utils:wrapper:35 - Función transform_pedido_detalle ejecutada en 0.04 segundos
2025-05-29 14:47:55.823 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.04 segundos
2025-05-29 14:47:55.823 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:53:12.009 | INFO     | etl.load:load_records:106 - Cargados 25943 registros en raw_pedido_detalles: 0 insertados, 25943 actualizados
2025-05-29 14:53:12.010 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 316.19 segundos
2025-05-29 14:53:12.010 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.012 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 14:53:12.012 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.013 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido_detalle completada: {'status': 'success', 'table': 'pedido_detalle', 'tenant_id': 1, 'records': 25943, 'inserted': 0, 'updated': 25943, 'duration_seconds': 316.395091}
2025-05-29 14:53:12.019 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 316.41 segundos
2025-05-29 14:53:12.020 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:53:12.020 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de producto para tenant 1
2025-05-29 14:53:12.020 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:53:12.022 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.022 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:32:08.983000
2025-05-29 14:53:12.023 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.026 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 14:53:12.026 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.027 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:53:12.028 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para producto (última: 2025-05-29 18:32:08.983000)
2025-05-29 14:53:12.031 | INFO     | etl.extract:extract_table:152 - Análisis para producto: 30 registros en PostgreSQL, 30 en MongoDB
2025-05-29 14:53:12.032 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para producto por eficiencia
2025-05-29 14:53:12.033 | INFO     | etl.extract:_extract_all:197 - Extraídos 30 registros de producto para tenant 1
2025-05-29 14:53:12.034 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:53:12.035 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:53:12.036 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:53:12.036 | DEBUG    | utils:wrapper:81 - Ejecutando transform_producto para tenant_id=1
2025-05-29 14:53:12.037 | INFO     | etl.transform:transform_producto:123 - Transformados 30 registros de producto
2025-05-29 14:53:12.037 | DEBUG    | utils:wrapper:35 - Función transform_producto ejecutada en 0.00 segundos
2025-05-29 14:53:12.037 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:53:12.038 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:53:12.053 | INFO     | etl.load:load_records:106 - Cargados 30 registros en raw_productos: 0 insertados, 30 actualizados
2025-05-29 14:53:12.054 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.02 segundos
2025-05-29 14:53:12.055 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.056 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 14:53:12.057 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.057 | INFO     | etl.sync:sync_table:98 - Sincronización de producto completada: {'status': 'success', 'table': 'producto', 'tenant_id': 1, 'records': 30, 'inserted': 0, 'updated': 30, 'duration_seconds': 0.033381}
2025-05-29 14:53:12.058 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.04 segundos
2025-05-29 14:53:12.058 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:53:12.059 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cliente para tenant 1
2025-05-29 14:53:12.060 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:53:12.061 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.062 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:32:09.156000
2025-05-29 14:53:12.062 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.063 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 14:53:12.064 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.064 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:53:12.065 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para cliente (última: 2025-05-29 18:32:09.156000)
2025-05-29 14:53:12.067 | INFO     | etl.extract:extract_table:152 - Análisis para cliente: 167 registros en PostgreSQL, 167 en MongoDB
2025-05-29 14:53:12.068 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para cliente por eficiencia
2025-05-29 14:53:12.070 | INFO     | etl.extract:_extract_all:197 - Extraídos 167 registros de cliente para tenant 1
2025-05-29 14:53:12.071 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:53:12.072 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:53:12.072 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:53:12.073 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cliente para tenant_id=1
2025-05-29 14:53:12.073 | INFO     | etl.transform:transform_cliente:255 - Transformados 167 registros de cliente
2025-05-29 14:53:12.074 | DEBUG    | utils:wrapper:35 - Función transform_cliente ejecutada en 0.00 segundos
2025-05-29 14:53:12.074 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:53:12.075 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:53:12.161 | INFO     | etl.load:load_records:106 - Cargados 167 registros en raw_clientes: 0 insertados, 167 actualizados
2025-05-29 14:53:12.162 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.09 segundos
2025-05-29 14:53:12.163 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.165 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 14:53:12.165 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.165 | INFO     | etl.sync:sync_table:98 - Sincronización de cliente completada: {'status': 'success', 'table': 'cliente', 'tenant_id': 1, 'records': 167, 'inserted': 0, 'updated': 167, 'duration_seconds': 0.103212}
2025-05-29 14:53:12.166 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.11 segundos
2025-05-29 14:53:12.166 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:53:12.167 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de mesa para tenant 1
2025-05-29 14:53:12.167 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:53:12.169 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.169 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:32:09.204000
2025-05-29 14:53:12.170 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.172 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 14:53:12.172 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.172 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:53:12.173 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para mesa (última: 2025-05-29 18:32:09.204000)
2025-05-29 14:53:12.175 | INFO     | etl.extract:extract_table:152 - Análisis para mesa: 15 registros en PostgreSQL, 15 en MongoDB
2025-05-29 14:53:12.176 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para mesa por eficiencia
2025-05-29 14:53:12.177 | INFO     | etl.extract:_extract_all:197 - Extraídos 15 registros de mesa para tenant 1
2025-05-29 14:53:12.178 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:53:12.179 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:53:12.179 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:53:12.179 | DEBUG    | utils:wrapper:81 - Ejecutando transform_mesa para tenant_id=1
2025-05-29 14:53:12.180 | INFO     | etl.transform:transform_mesa:286 - Transformados 15 registros de mesa
2025-05-29 14:53:12.180 | DEBUG    | utils:wrapper:35 - Función transform_mesa ejecutada en 0.00 segundos
2025-05-29 14:53:12.181 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:53:12.181 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:53:12.187 | INFO     | etl.load:load_records:106 - Cargados 15 registros en raw_mesas: 0 insertados, 15 actualizados
2025-05-29 14:53:12.188 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 14:53:12.188 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.189 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 14:53:12.190 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.190 | INFO     | etl.sync:sync_table:98 - Sincronización de mesa completada: {'status': 'success', 'table': 'mesa', 'tenant_id': 1, 'records': 15, 'inserted': 0, 'updated': 15, 'duration_seconds': 0.020193}
2025-05-29 14:53:12.191 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.03 segundos
2025-05-29 14:53:12.191 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:53:12.192 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de categoria para tenant 1
2025-05-29 14:53:12.192 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:53:12.194 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.195 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:32:09.247000
2025-05-29 14:53:12.195 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.196 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 14:53:12.197 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.197 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:53:12.198 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para categoria (última: 2025-05-29 18:32:09.247000)
2025-05-29 14:53:12.199 | INFO     | etl.extract:extract_table:152 - Análisis para categoria: 8 registros en PostgreSQL, 8 en MongoDB
2025-05-29 14:53:12.200 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para categoria por eficiencia
2025-05-29 14:53:12.201 | INFO     | etl.extract:_extract_all:197 - Extraídos 8 registros de categoria para tenant 1
2025-05-29 14:53:12.202 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:53:12.202 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:53:12.203 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:53:12.203 | DEBUG    | utils:wrapper:81 - Ejecutando transform_categoria para tenant_id=1
2025-05-29 14:53:12.204 | INFO     | etl.transform:transform_categoria:153 - Transformados 8 registros de categoría
2025-05-29 14:53:12.204 | DEBUG    | utils:wrapper:35 - Función transform_categoria ejecutada en 0.00 segundos
2025-05-29 14:53:12.205 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:53:12.205 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:53:12.210 | INFO     | etl.load:load_records:106 - Cargados 8 registros en raw_categorias: 0 insertados, 8 actualizados
2025-05-29 14:53:12.211 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 14:53:12.211 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.213 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 14:53:12.213 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.214 | INFO     | etl.sync:sync_table:98 - Sincronización de categoria completada: {'status': 'success', 'table': 'categoria', 'tenant_id': 1, 'records': 8, 'inserted': 0, 'updated': 8, 'duration_seconds': 0.018476}
2025-05-29 14:53:12.214 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 14:53:12.215 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:53:12.215 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de usuario para tenant 1
2025-05-29 14:53:12.215 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:53:12.217 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.217 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:32:09.283000
2025-05-29 14:53:12.217 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.218 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 14:53:12.219 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.219 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:53:12.220 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para usuario (última: 2025-05-29 18:32:09.283000)
2025-05-29 14:53:12.222 | INFO     | etl.extract:extract_table:152 - Análisis para usuario: 5 registros en PostgreSQL, 5 en MongoDB
2025-05-29 14:53:12.222 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para usuario por eficiencia
2025-05-29 14:53:12.223 | INFO     | etl.extract:_extract_all:197 - Extraídos 5 registros de usuario para tenant 1
2025-05-29 14:53:12.224 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 14:53:12.225 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 14:53:12.225 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:53:12.225 | WARNING  | etl.transform:batch_transform:410 - No hay método de transformación específico para usuario
2025-05-29 14:53:12.226 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 14:53:12.226 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:53:12.229 | INFO     | etl.load:load_records:106 - Cargados 5 registros en raw_usuarios: 0 insertados, 5 actualizados
2025-05-29 14:53:12.230 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.00 segundos
2025-05-29 14:53:12.230 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.232 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 14:53:12.232 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.232 | INFO     | etl.sync:sync_table:98 - Sincronización de usuario completada: {'status': 'success', 'table': 'usuario', 'tenant_id': 1, 'records': 5, 'inserted': 0, 'updated': 5, 'duration_seconds': 0.015652}
2025-05-29 14:53:12.233 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 14:53:12.233 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:53:12.233 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cuenta_mesa para tenant 1
2025-05-29 14:53:12.234 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:53:12.235 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.235 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:32:21.239000
2025-05-29 14:53:12.236 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:12.237 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 14:53:12.238 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:12.238 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:53:12.238 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para cuenta_mesa (última: 2025-05-29 18:32:21.239000)
2025-05-29 14:53:12.255 | INFO     | etl.extract:extract_table:152 - Análisis para cuenta_mesa: 5000 registros en PostgreSQL, 5000 en MongoDB
2025-05-29 14:53:12.256 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para cuenta_mesa por eficiencia
2025-05-29 14:53:12.282 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de cuenta_mesa para tenant 1
2025-05-29 14:53:12.284 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.03 segundos
2025-05-29 14:53:12.285 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.05 segundos
2025-05-29 14:53:12.286 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:53:12.287 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cuenta_mesa para tenant_id=1
2025-05-29 14:53:12.299 | INFO     | etl.transform:transform_cuenta_mesa:206 - Transformados 5000 registros de cuenta mesa
2025-05-29 14:53:12.300 | DEBUG    | utils:wrapper:35 - Función transform_cuenta_mesa ejecutada en 0.01 segundos
2025-05-29 14:53:12.301 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 14:53:12.301 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:53:21.292 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_cuenta_mesas: 0 insertados, 5000 actualizados
2025-05-29 14:53:21.292 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 8.99 segundos
2025-05-29 14:53:21.293 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:21.294 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 14:53:21.295 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:21.295 | INFO     | etl.sync:sync_table:98 - Sincronización de cuenta_mesa completada: {'status': 'success', 'table': 'cuenta_mesa', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 9.058649}
2025-05-29 14:53:21.296 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 9.06 segundos
2025-05-29 14:53:21.297 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:53:21.298 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de reserva para tenant 1
2025-05-29 14:53:21.298 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:53:21.300 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:21.302 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:32:25.995000
2025-05-29 14:53:21.303 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:21.305 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 14:53:21.317 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.01 segundos
2025-05-29 14:53:21.318 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:53:21.319 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para reserva (última: 2025-05-29 18:32:25.995000)
2025-05-29 14:53:21.361 | INFO     | etl.extract:extract_table:152 - Análisis para reserva: 3000 registros en PostgreSQL, 3000 en MongoDB
2025-05-29 14:53:21.362 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para reserva por eficiencia
2025-05-29 14:53:21.384 | INFO     | etl.extract:_extract_all:197 - Extraídos 3000 registros de reserva para tenant 1
2025-05-29 14:53:21.385 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.02 segundos
2025-05-29 14:53:21.387 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.07 segundos
2025-05-29 14:53:21.388 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:53:21.388 | DEBUG    | utils:wrapper:81 - Ejecutando transform_reserva para tenant_id=1
2025-05-29 14:53:21.395 | INFO     | etl.transform:transform_reserva:357 - Transformados 3000 registros de reserva
2025-05-29 14:53:21.396 | DEBUG    | utils:wrapper:35 - Función transform_reserva ejecutada en 0.01 segundos
2025-05-29 14:53:21.397 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 14:53:21.397 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:53:25.186 | INFO     | etl.load:load_records:106 - Cargados 3000 registros en raw_reservas: 0 insertados, 3000 actualizados
2025-05-29 14:53:25.187 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 3.79 segundos
2025-05-29 14:53:25.188 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:25.189 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 14:53:25.190 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:25.190 | INFO     | etl.sync:sync_table:98 - Sincronización de reserva completada: {'status': 'success', 'table': 'reserva', 'tenant_id': 1, 'records': 3000, 'inserted': 0, 'updated': 3000, 'duration_seconds': 3.887118}
2025-05-29 14:53:25.191 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 3.89 segundos
2025-05-29 14:53:25.192 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 14:53:25.193 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de venta para tenant 1
2025-05-29 14:53:25.194 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 14:53:25.195 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:25.196 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 18:32:37.744000
2025-05-29 14:53:25.196 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:25.198 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 14:53:25.198 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:25.199 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 14:53:25.199 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para venta (última: 2025-05-29 18:32:37.744000)
2025-05-29 14:53:25.215 | INFO     | etl.extract:extract_table:152 - Análisis para venta: 5000 registros en PostgreSQL, 5000 en MongoDB
2025-05-29 14:53:25.216 | INFO     | etl.extract:extract_table:161 - Extrayendo todos los registros para venta por eficiencia
2025-05-29 14:53:25.239 | INFO     | etl.extract:_extract_all:197 - Extraídos 5000 registros de venta para tenant 1
2025-05-29 14:53:25.240 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.02 segundos
2025-05-29 14:53:25.241 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.04 segundos
2025-05-29 14:53:25.242 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 14:53:25.242 | DEBUG    | utils:wrapper:81 - Ejecutando transform_venta para tenant_id=1
2025-05-29 14:53:25.252 | INFO     | etl.transform:transform_venta:389 - Transformados 5000 registros de venta
2025-05-29 14:53:25.253 | DEBUG    | utils:wrapper:35 - Función transform_venta ejecutada en 0.01 segundos
2025-05-29 14:53:25.253 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 14:53:25.253 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 14:53:34.024 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_ventas: 0 insertados, 5000 actualizados
2025-05-29 14:53:34.025 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 8.77 segundos
2025-05-29 14:53:34.025 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 14:53:34.026 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 14:53:34.027 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 14:53:34.027 | INFO     | etl.sync:sync_table:98 - Sincronización de venta completada: {'status': 'success', 'table': 'venta', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 8.830477}
2025-05-29 14:53:34.029 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 8.84 segundos
2025-05-29 14:53:34.029 | DEBUG    | utils:wrapper:35 - Función sync_all_tables ejecutada en 356.27 segundos
2025-05-29 14:53:34.030 | INFO     | __main__:sync_scheduled:135 - Sincronización completada en 356.27s: 10 tablas exitosas, 0 errores, 0 omitidas, 46617 registros procesados
2025-05-29 14:53:34.030 | INFO     | __main__:sync_scheduled:142 - Próxima sincronización programada a las 2025-05-29 15:08:34 (en 60 minutos)
2025-05-29 15:06:11.531 | INFO     | __main__:sync_scheduled:146 - Sincronización programada interrumpida por el usuario
2025-05-29 15:06:11.531 | INFO     | __main__:main:196 - Servicio finalizado. Cerrando conexiones...
2025-05-29 15:06:11.533 | INFO     | etl.extract:close:310 - Conexión a PostgreSQL cerrada
2025-05-29 15:06:11.535 | INFO     | db.mongo_client:close:194 - Conexión a MongoDB cerrada
2025-05-29 15:06:19.423 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-29 15:06:19.424 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.04 segundos
2025-05-29 15:06:19.692 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-29 15:06:19.693 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-29 15:06:19.695 | INFO     | __main__:main:160 - Iniciando Restaurant ML Microservice v0.1.0
2025-05-29 15:06:19.696 | INFO     | __main__:main:161 - Modo desarrollo: True
2025-05-29 15:06:19.697 | INFO     | __main__:test_connections:11 - Probando conexiones a bases de datos...
2025-05-29 15:06:19.698 | INFO     | __main__:test_connections:18 - Conexión a MongoDB funciona correctamente: versión 8.0.6
2025-05-29 15:06:19.700 | DEBUG    | utils:wrapper:35 - Función execute_query ejecutada en 0.00 segundos
2025-05-29 15:06:19.701 | INFO     | __main__:test_connections:27 - Conexión a PostgreSQL funciona correctamente
2025-05-29 15:06:19.701 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedidos
2025-05-29 15:06:19.703 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_hora_-1' creado en raw_pedidos
2025-05-29 15:06:19.705 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_detalle_id_1' creado en raw_pedido_detalles
2025-05-29 15:06:19.707 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedido_detalles
2025-05-29 15:06:19.709 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_pedido_detalles
2025-05-29 15:06:19.711 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_productos
2025-05-29 15:06:19.712 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en raw_productos
2025-05-29 15:06:19.713 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_1_producto_id_1' creado en ventas_diarias
2025-05-29 15:06:19.714 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en ventas_diarias
2025-05-29 15:06:19.715 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en ventas_diarias
2025-05-29 15:06:19.717 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_table_name_1' creado en sync_status
2025-05-29 15:06:19.718 | INFO     | db.models:create_indexes:145 - Índices creados para todas las colecciones
2025-05-29 15:06:19.718 | INFO     | __main__:main:182 - Modo desarrollo: Ejecutando sincronización inicial completa...
2025-05-29 15:06:19.718 | INFO     | __main__:test_sync:44 - Probando sincronización para tenant 1...
2025-05-29 15:06:19.719 | INFO     | __main__:test_sync:55 - Sincronizando tabla: pedido...
2025-05-29 15:06:19.719 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:06:19.719 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido para tenant 1
2025-05-29 15:06:19.720 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:06:19.722 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 15:06:19.723 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:06:19.724 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:06:19.724 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para pedido
2025-05-29 15:06:19.759 | INFO     | etl.extract:_extract_all:215 - Extraídos 7449 registros de pedido para tenant 1
2025-05-29 15:06:19.761 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.04 segundos
2025-05-29 15:06:19.762 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.04 segundos
2025-05-29 15:06:19.763 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 15:06:19.764 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido para tenant_id=1
2025-05-29 15:06:19.780 | INFO     | etl.transform:transform_pedido:51 - Transformados 7449 registros de pedido
2025-05-29 15:06:19.781 | DEBUG    | utils:wrapper:35 - Función transform_pedido ejecutada en 0.02 segundos
2025-05-29 15:06:19.782 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 15:06:19.782 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 15:06:53.766 | INFO     | etl.load:load_records:106 - Cargados 7449 registros en raw_pedidos: 0 insertados, 7449 actualizados
2025-05-29 15:06:53.768 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 33.99 segundos
2025-05-29 15:06:53.769 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:06:53.772 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 15:06:53.773 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:06:53.773 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido completada: {'status': 'success', 'table': 'pedido', 'tenant_id': 1, 'records': 7449, 'inserted': 0, 'updated': 7449, 'duration_seconds': 34.053282}
2025-05-29 15:06:53.778 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 34.06 segundos
2025-05-29 15:06:53.779 | INFO     | __main__:test_sync:65 - Sincronización de pedido completada en 34.06s: 7449 registros
2025-05-29 15:06:53.781 | INFO     | __main__:test_sync:55 - Sincronizando tabla: pedido_detalle...
2025-05-29 15:06:53.782 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:06:53.784 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido_detalle para tenant 1
2025-05-29 15:06:53.785 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:06:53.789 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 15:06:53.790 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:06:53.791 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:06:53.792 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para pedido_detalle
2025-05-29 15:06:53.944 | INFO     | etl.extract:_extract_all:215 - Extraídos 25943 registros de pedido_detalle para tenant 1
2025-05-29 15:06:53.946 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.15 segundos
2025-05-29 15:06:53.947 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.16 segundos
2025-05-29 15:06:53.948 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 15:06:53.949 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido_detalle para tenant_id=1
2025-05-29 15:06:54.088 | INFO     | etl.transform:transform_pedido_detalle:85 - Transformados 25943 registros de detalle de pedido
2025-05-29 15:06:54.088 | DEBUG    | utils:wrapper:35 - Función transform_pedido_detalle ejecutada en 0.14 segundos
2025-05-29 15:06:54.088 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.14 segundos
2025-05-29 15:06:54.090 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 15:13:34.111 | INFO     | etl.load:load_records:106 - Cargados 25943 registros en raw_pedido_detalles: 0 insertados, 25943 actualizados
2025-05-29 15:13:34.112 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 400.02 segundos
2025-05-29 15:13:34.113 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.114 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 15:13:34.115 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.116 | INFO     | etl.sync:sync_table:98 - Sincronización de pedido_detalle completada: {'status': 'success', 'table': 'pedido_detalle', 'tenant_id': 1, 'records': 25943, 'inserted': 0, 'updated': 25943, 'duration_seconds': 400.330285}
2025-05-29 15:13:34.122 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 400.34 segundos
2025-05-29 15:13:34.123 | INFO     | __main__:test_sync:65 - Sincronización de pedido_detalle completada en 400.34s: 25943 registros
2025-05-29 15:13:34.123 | INFO     | __main__:test_sync:55 - Sincronizando tabla: producto...
2025-05-29 15:13:34.124 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:13:34.125 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de producto para tenant 1
2025-05-29 15:13:34.125 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.126 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 15:13:34.127 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.128 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:13:34.129 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para producto
2025-05-29 15:13:34.132 | INFO     | etl.extract:_extract_all:215 - Extraídos 30 registros de producto para tenant 1
2025-05-29 15:13:34.133 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 15:13:34.133 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 15:13:34.134 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 15:13:34.135 | DEBUG    | utils:wrapper:81 - Ejecutando transform_producto para tenant_id=1
2025-05-29 15:13:34.135 | INFO     | etl.transform:transform_producto:123 - Transformados 30 registros de producto
2025-05-29 15:13:34.136 | DEBUG    | utils:wrapper:35 - Función transform_producto ejecutada en 0.00 segundos
2025-05-29 15:13:34.136 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 15:13:34.137 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 15:13:34.152 | INFO     | etl.load:load_records:106 - Cargados 30 registros en raw_productos: 0 insertados, 30 actualizados
2025-05-29 15:13:34.152 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 15:13:34.153 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.154 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 15:13:34.155 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.155 | INFO     | etl.sync:sync_table:98 - Sincronización de producto completada: {'status': 'success', 'table': 'producto', 'tenant_id': 1, 'records': 30, 'inserted': 0, 'updated': 30, 'duration_seconds': 0.029818}
2025-05-29 15:13:34.155 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.03 segundos
2025-05-29 15:13:34.156 | INFO     | __main__:test_sync:65 - Sincronización de producto completada en 0.03s: 30 registros
2025-05-29 15:13:34.156 | INFO     | __main__:test_sync:55 - Sincronizando tabla: cliente...
2025-05-29 15:13:34.156 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:13:34.157 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cliente para tenant 1
2025-05-29 15:13:34.157 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.158 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 15:13:34.159 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.159 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:13:34.160 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para cliente
2025-05-29 15:13:34.162 | INFO     | etl.extract:_extract_all:215 - Extraídos 167 registros de cliente para tenant 1
2025-05-29 15:13:34.164 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 15:13:34.164 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 15:13:34.164 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 15:13:34.166 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cliente para tenant_id=1
2025-05-29 15:13:34.167 | INFO     | etl.transform:transform_cliente:255 - Transformados 167 registros de cliente
2025-05-29 15:13:34.167 | DEBUG    | utils:wrapper:35 - Función transform_cliente ejecutada en 0.00 segundos
2025-05-29 15:13:34.167 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 15:13:34.168 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 15:13:34.259 | INFO     | etl.load:load_records:106 - Cargados 167 registros en raw_clientes: 0 insertados, 167 actualizados
2025-05-29 15:13:34.260 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.09 segundos
2025-05-29 15:13:34.260 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.262 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 15:13:34.263 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.263 | INFO     | etl.sync:sync_table:98 - Sincronización de cliente completada: {'status': 'success', 'table': 'cliente', 'tenant_id': 1, 'records': 167, 'inserted': 0, 'updated': 167, 'duration_seconds': 0.105607}
2025-05-29 15:13:34.264 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.11 segundos
2025-05-29 15:13:34.265 | INFO     | __main__:test_sync:65 - Sincronización de cliente completada en 0.11s: 167 registros
2025-05-29 15:13:34.265 | INFO     | __main__:test_sync:55 - Sincronizando tabla: mesa...
2025-05-29 15:13:34.265 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:13:34.266 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de mesa para tenant 1
2025-05-29 15:13:34.266 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.268 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 15:13:34.269 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.269 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:13:34.270 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para mesa
2025-05-29 15:13:34.271 | INFO     | etl.extract:_extract_all:215 - Extraídos 15 registros de mesa para tenant 1
2025-05-29 15:13:34.272 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 15:13:34.273 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 15:13:34.273 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 15:13:34.273 | DEBUG    | utils:wrapper:81 - Ejecutando transform_mesa para tenant_id=1
2025-05-29 15:13:34.273 | INFO     | etl.transform:transform_mesa:286 - Transformados 15 registros de mesa
2025-05-29 15:13:34.274 | DEBUG    | utils:wrapper:35 - Función transform_mesa ejecutada en 0.00 segundos
2025-05-29 15:13:34.274 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 15:13:34.275 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 15:13:34.282 | INFO     | etl.load:load_records:106 - Cargados 15 registros en raw_mesas: 0 insertados, 15 actualizados
2025-05-29 15:13:34.283 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 15:13:34.283 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.285 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 15:13:34.285 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.286 | INFO     | etl.sync:sync_table:98 - Sincronización de mesa completada: {'status': 'success', 'table': 'mesa', 'tenant_id': 1, 'records': 15, 'inserted': 0, 'updated': 15, 'duration_seconds': 0.019714}
2025-05-29 15:13:34.286 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 15:13:34.287 | INFO     | __main__:test_sync:65 - Sincronización de mesa completada en 0.02s: 15 registros
2025-05-29 15:13:34.287 | INFO     | __main__:test_sync:55 - Sincronizando tabla: categoria...
2025-05-29 15:13:34.287 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:13:34.288 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de categoria para tenant 1
2025-05-29 15:13:34.288 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.289 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 15:13:34.290 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.290 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:13:34.291 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para categoria
2025-05-29 15:13:34.292 | INFO     | etl.extract:_extract_all:215 - Extraídos 8 registros de categoria para tenant 1
2025-05-29 15:13:34.293 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 15:13:34.293 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 15:13:34.294 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 15:13:34.294 | DEBUG    | utils:wrapper:81 - Ejecutando transform_categoria para tenant_id=1
2025-05-29 15:13:34.294 | INFO     | etl.transform:transform_categoria:153 - Transformados 8 registros de categoría
2025-05-29 15:13:34.295 | DEBUG    | utils:wrapper:35 - Función transform_categoria ejecutada en 0.00 segundos
2025-05-29 15:13:34.295 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 15:13:34.296 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 15:13:34.300 | INFO     | etl.load:load_records:106 - Cargados 8 registros en raw_categorias: 0 insertados, 8 actualizados
2025-05-29 15:13:34.300 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.00 segundos
2025-05-29 15:13:34.301 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.302 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 15:13:34.303 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.303 | INFO     | etl.sync:sync_table:98 - Sincronización de categoria completada: {'status': 'success', 'table': 'categoria', 'tenant_id': 1, 'records': 8, 'inserted': 0, 'updated': 8, 'duration_seconds': 0.015564}
2025-05-29 15:13:34.304 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 15:13:34.304 | INFO     | __main__:test_sync:65 - Sincronización de categoria completada en 0.02s: 8 registros
2025-05-29 15:13:34.304 | INFO     | __main__:test_sync:55 - Sincronizando tabla: usuario...
2025-05-29 15:13:34.305 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:13:34.305 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de usuario para tenant 1
2025-05-29 15:13:34.305 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.307 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 15:13:34.307 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.308 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:13:34.308 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para usuario
2025-05-29 15:13:34.310 | INFO     | etl.extract:_extract_all:215 - Extraídos 5 registros de usuario para tenant 1
2025-05-29 15:13:34.311 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.00 segundos
2025-05-29 15:13:34.312 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 15:13:34.312 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 15:13:34.313 | WARNING  | etl.transform:batch_transform:410 - No hay método de transformación específico para usuario
2025-05-29 15:13:34.313 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.00 segundos
2025-05-29 15:13:34.314 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 15:13:34.319 | INFO     | etl.load:load_records:106 - Cargados 5 registros en raw_usuarios: 0 insertados, 5 actualizados
2025-05-29 15:13:34.320 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 0.01 segundos
2025-05-29 15:13:34.321 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.322 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 15:13:34.323 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.324 | INFO     | etl.sync:sync_table:98 - Sincronización de usuario completada: {'status': 'success', 'table': 'usuario', 'tenant_id': 1, 'records': 5, 'inserted': 0, 'updated': 5, 'duration_seconds': 0.019042}
2025-05-29 15:13:34.325 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 15:13:34.325 | INFO     | __main__:test_sync:65 - Sincronización de usuario completada en 0.02s: 5 registros
2025-05-29 15:13:34.326 | INFO     | __main__:test_sync:55 - Sincronizando tabla: cuenta_mesa...
2025-05-29 15:13:34.326 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:13:34.326 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cuenta_mesa para tenant 1
2025-05-29 15:13:34.328 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:34.330 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 15:13:34.331 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:34.331 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:13:34.332 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para cuenta_mesa
2025-05-29 15:13:34.357 | INFO     | etl.extract:_extract_all:215 - Extraídos 5000 registros de cuenta_mesa para tenant 1
2025-05-29 15:13:34.358 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.03 segundos
2025-05-29 15:13:34.358 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.03 segundos
2025-05-29 15:13:34.359 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 15:13:34.360 | DEBUG    | utils:wrapper:81 - Ejecutando transform_cuenta_mesa para tenant_id=1
2025-05-29 15:13:34.372 | INFO     | etl.transform:transform_cuenta_mesa:206 - Transformados 5000 registros de cuenta mesa
2025-05-29 15:13:34.373 | DEBUG    | utils:wrapper:35 - Función transform_cuenta_mesa ejecutada en 0.01 segundos
2025-05-29 15:13:34.373 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 15:13:34.374 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 15:13:48.823 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_cuenta_mesas: 0 insertados, 5000 actualizados
2025-05-29 15:13:48.824 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 14.45 segundos
2025-05-29 15:13:48.824 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:48.825 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 15:13:48.825 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:48.827 | INFO     | etl.sync:sync_table:98 - Sincronización de cuenta_mesa completada: {'status': 'success', 'table': 'cuenta_mesa', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 14.499368}
2025-05-29 15:13:48.828 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 14.50 segundos
2025-05-29 15:13:48.828 | INFO     | __main__:test_sync:65 - Sincronización de cuenta_mesa completada en 14.5s: 5000 registros
2025-05-29 15:13:48.829 | INFO     | __main__:test_sync:55 - Sincronizando tabla: reserva...
2025-05-29 15:13:48.829 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:13:48.830 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de reserva para tenant 1
2025-05-29 15:13:48.830 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:48.832 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 15:13:48.833 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:48.833 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:13:48.834 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para reserva
2025-05-29 15:13:48.848 | INFO     | etl.extract:_extract_all:215 - Extraídos 3000 registros de reserva para tenant 1
2025-05-29 15:13:48.849 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.01 segundos
2025-05-29 15:13:48.850 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.02 segundos
2025-05-29 15:13:48.850 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 15:13:48.851 | DEBUG    | utils:wrapper:81 - Ejecutando transform_reserva para tenant_id=1
2025-05-29 15:13:48.858 | INFO     | etl.transform:transform_reserva:357 - Transformados 3000 registros de reserva
2025-05-29 15:13:48.859 | DEBUG    | utils:wrapper:35 - Función transform_reserva ejecutada en 0.01 segundos
2025-05-29 15:13:48.859 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 15:13:48.860 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 15:13:54.232 | INFO     | etl.load:load_records:106 - Cargados 3000 registros en raw_reservas: 0 insertados, 3000 actualizados
2025-05-29 15:13:54.233 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 5.37 segundos
2025-05-29 15:13:54.234 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:54.235 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 15:13:54.236 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:54.236 | INFO     | etl.sync:sync_table:98 - Sincronización de reserva completada: {'status': 'success', 'table': 'reserva', 'tenant_id': 1, 'records': 3000, 'inserted': 0, 'updated': 3000, 'duration_seconds': 5.405977}
2025-05-29 15:13:54.237 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 5.41 segundos
2025-05-29 15:13:54.238 | INFO     | __main__:test_sync:65 - Sincronización de reserva completada en 5.41s: 3000 registros
2025-05-29 15:13:54.239 | INFO     | __main__:test_sync:55 - Sincronizando tabla: venta...
2025-05-29 15:13:54.239 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:13:54.240 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de venta para tenant 1
2025-05-29 15:13:54.240 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:13:54.242 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 15:13:54.242 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:13:54.243 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:13:54.244 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para venta
2025-05-29 15:13:54.267 | INFO     | etl.extract:_extract_all:215 - Extraídos 5000 registros de venta para tenant 1
2025-05-29 15:13:54.269 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.02 segundos
2025-05-29 15:13:54.270 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.03 segundos
2025-05-29 15:13:54.270 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 15:13:54.271 | DEBUG    | utils:wrapper:81 - Ejecutando transform_venta para tenant_id=1
2025-05-29 15:13:54.280 | INFO     | etl.transform:transform_venta:389 - Transformados 5000 registros de venta
2025-05-29 15:13:54.281 | DEBUG    | utils:wrapper:35 - Función transform_venta ejecutada en 0.01 segundos
2025-05-29 15:13:54.282 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.01 segundos
2025-05-29 15:13:54.282 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 15:14:07.736 | INFO     | etl.load:load_records:106 - Cargados 5000 registros en raw_ventas: 0 insertados, 5000 actualizados
2025-05-29 15:14:07.737 | DEBUG    | utils:wrapper:35 - Función load_records ejecutada en 13.45 segundos
2025-05-29 15:14:07.738 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.739 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 15:14:07.740 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.740 | INFO     | etl.sync:sync_table:98 - Sincronización de venta completada: {'status': 'success', 'table': 'venta', 'tenant_id': 1, 'records': 5000, 'inserted': 0, 'updated': 5000, 'duration_seconds': 13.499865}
2025-05-29 15:14:07.741 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 13.50 segundos
2025-05-29 15:14:07.742 | INFO     | __main__:test_sync:65 - Sincronización de venta completada en 13.5s: 5000 registros
2025-05-29 15:14:07.743 | INFO     | __main__:test_sync:83 - Resumen de sincronización: 10 exitosas, 0 errores, 0 omitidas
2025-05-29 15:14:07.743 | INFO     | __main__:main:189 - Iniciando servicio de sincronización 24/7...
2025-05-29 15:14:07.744 | INFO     | __main__:sync_scheduled:100 - Iniciando sincronización programada cada 60 minutos para tenant 1
2025-05-29 15:14:07.744 | INFO     | __main__:sync_scheduled:107 - Ejecutando sincronización programada...
2025-05-29 15:14:07.745 | INFO     | __main__:sync_scheduled:116 - Realizando sincronización incremental...
2025-05-29 15:14:07.745 | DEBUG    | utils:wrapper:81 - Ejecutando sync_all_tables para tenant_id=1
2025-05-29 15:14:07.746 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:14:07.747 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido para tenant 1
2025-05-29 15:14:07.747 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 15:14:07.749 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.749 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 19:06:53.771000
2025-05-29 15:14:07.750 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.752 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 15:14:07.752 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.752 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:14:07.753 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para pedido (última: 2025-05-29 19:06:53.771000)
2025-05-29 15:14:07.774 | INFO     | etl.extract:extract_table:149 - Análisis para pedido: 7449 registros en PostgreSQL, 7449 en MongoDB
2025-05-29 15:14:07.775 | INFO     | etl.extract:extract_table:155 - No hay cambios detectados en pedido desde la última sincronización
2025-05-29 15:14:07.776 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.02 segundos
2025-05-29 15:14:07.777 | INFO     | etl.sync:sync_table:63 - No hay registros nuevos para pedido
2025-05-29 15:14:07.778 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.780 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 15:14:07.781 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.782 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.04 segundos
2025-05-29 15:14:07.782 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:14:07.783 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido_detalle para tenant 1
2025-05-29 15:14:07.784 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 15:14:07.786 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.786 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 19:13:34.113000
2025-05-29 15:14:07.787 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.789 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 15:14:07.790 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.790 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:14:07.791 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para pedido_detalle (última: 2025-05-29 19:13:34.113000)
2025-05-29 15:14:07.867 | INFO     | etl.extract:extract_table:149 - Análisis para pedido_detalle: 25943 registros en PostgreSQL, 25943 en MongoDB
2025-05-29 15:14:07.871 | INFO     | etl.extract:extract_table:155 - No hay cambios detectados en pedido_detalle desde la última sincronización
2025-05-29 15:14:07.892 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.10 segundos
2025-05-29 15:14:07.893 | INFO     | etl.sync:sync_table:63 - No hay registros nuevos para pedido_detalle
2025-05-29 15:14:07.894 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.896 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido_detalle, tenant 1
2025-05-29 15:14:07.897 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.898 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.12 segundos
2025-05-29 15:14:07.899 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:14:07.899 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de producto para tenant 1
2025-05-29 15:14:07.900 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 15:14:07.902 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.906 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 19:13:34.153000
2025-05-29 15:14:07.907 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.910 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 15:14:07.915 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.01 segundos
2025-05-29 15:14:07.915 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:14:07.916 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para producto (última: 2025-05-29 19:13:34.153000)
2025-05-29 15:14:07.919 | INFO     | etl.extract:extract_table:149 - Análisis para producto: 30 registros en PostgreSQL, 30 en MongoDB
2025-05-29 15:14:07.920 | INFO     | etl.extract:extract_table:155 - No hay cambios detectados en producto desde la última sincronización
2025-05-29 15:14:07.921 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 15:14:07.922 | INFO     | etl.sync:sync_table:63 - No hay registros nuevos para producto
2025-05-29 15:14:07.922 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.924 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para producto, tenant 1
2025-05-29 15:14:07.925 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.926 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.03 segundos
2025-05-29 15:14:07.927 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:14:07.928 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cliente para tenant 1
2025-05-29 15:14:07.929 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 15:14:07.930 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.931 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 19:13:34.261000
2025-05-29 15:14:07.932 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.934 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 15:14:07.934 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.934 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:14:07.935 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para cliente (última: 2025-05-29 19:13:34.261000)
2025-05-29 15:14:07.937 | INFO     | etl.extract:extract_table:149 - Análisis para cliente: 167 registros en PostgreSQL, 167 en MongoDB
2025-05-29 15:14:07.938 | INFO     | etl.extract:extract_table:155 - No hay cambios detectados en cliente desde la última sincronización
2025-05-29 15:14:07.939 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 15:14:07.939 | INFO     | etl.sync:sync_table:63 - No hay registros nuevos para cliente
2025-05-29 15:14:07.940 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.941 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cliente, tenant 1
2025-05-29 15:14:07.941 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.941 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.01 segundos
2025-05-29 15:14:07.942 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:14:07.942 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de mesa para tenant 1
2025-05-29 15:14:07.942 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 15:14:07.943 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.944 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 19:13:34.284000
2025-05-29 15:14:07.944 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.946 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 15:14:07.946 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.947 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:14:07.948 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para mesa (última: 2025-05-29 19:13:34.284000)
2025-05-29 15:14:07.950 | INFO     | etl.extract:extract_table:149 - Análisis para mesa: 15 registros en PostgreSQL, 15 en MongoDB
2025-05-29 15:14:07.951 | INFO     | etl.extract:extract_table:155 - No hay cambios detectados en mesa desde la última sincronización
2025-05-29 15:14:07.952 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 15:14:07.952 | INFO     | etl.sync:sync_table:63 - No hay registros nuevos para mesa
2025-05-29 15:14:07.953 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.954 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para mesa, tenant 1
2025-05-29 15:14:07.954 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.954 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.01 segundos
2025-05-29 15:14:07.955 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:14:07.955 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de categoria para tenant 1
2025-05-29 15:14:07.955 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 15:14:07.956 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.957 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 19:13:34.301000
2025-05-29 15:14:07.957 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.958 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 15:14:07.959 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.959 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:14:07.960 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para categoria (última: 2025-05-29 19:13:34.301000)
2025-05-29 15:14:07.962 | INFO     | etl.extract:extract_table:149 - Análisis para categoria: 8 registros en PostgreSQL, 8 en MongoDB
2025-05-29 15:14:07.962 | INFO     | etl.extract:extract_table:155 - No hay cambios detectados en categoria desde la última sincronización
2025-05-29 15:14:07.963 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 15:14:07.963 | INFO     | etl.sync:sync_table:63 - No hay registros nuevos para categoria
2025-05-29 15:14:07.964 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.966 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para categoria, tenant 1
2025-05-29 15:14:07.966 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.967 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.01 segundos
2025-05-29 15:14:07.967 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:14:07.967 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de usuario para tenant 1
2025-05-29 15:14:07.968 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 15:14:07.969 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.969 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 19:13:34.321000
2025-05-29 15:14:07.970 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.971 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 15:14:07.971 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.972 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:14:07.972 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para usuario (última: 2025-05-29 19:13:34.321000)
2025-05-29 15:14:07.975 | INFO     | etl.extract:extract_table:149 - Análisis para usuario: 5 registros en PostgreSQL, 5 en MongoDB
2025-05-29 15:14:07.975 | INFO     | etl.extract:extract_table:155 - No hay cambios detectados en usuario desde la última sincronización
2025-05-29 15:14:07.975 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.00 segundos
2025-05-29 15:14:07.975 | INFO     | etl.sync:sync_table:63 - No hay registros nuevos para usuario
2025-05-29 15:14:07.976 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.978 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para usuario, tenant 1
2025-05-29 15:14:07.978 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.979 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.01 segundos
2025-05-29 15:14:07.979 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:14:07.979 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de cuenta_mesa para tenant 1
2025-05-29 15:14:07.979 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 15:14:07.981 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.981 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 19:13:48.825000
2025-05-29 15:14:07.982 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:07.983 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 15:14:07.984 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:07.984 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:14:07.985 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para cuenta_mesa (última: 2025-05-29 19:13:48.825000)
2025-05-29 15:14:07.998 | INFO     | etl.extract:extract_table:149 - Análisis para cuenta_mesa: 5000 registros en PostgreSQL, 5000 en MongoDB
2025-05-29 15:14:07.998 | INFO     | etl.extract:extract_table:155 - No hay cambios detectados en cuenta_mesa desde la última sincronización
2025-05-29 15:14:08.000 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.02 segundos
2025-05-29 15:14:08.000 | INFO     | etl.sync:sync_table:63 - No hay registros nuevos para cuenta_mesa
2025-05-29 15:14:08.001 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:08.003 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para cuenta_mesa, tenant 1
2025-05-29 15:14:08.003 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:08.003 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 15:14:08.003 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:14:08.005 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de reserva para tenant 1
2025-05-29 15:14:08.005 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 15:14:08.006 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:08.007 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 19:13:54.234000
2025-05-29 15:14:08.007 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:08.008 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 15:14:08.009 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:08.009 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:14:08.010 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para reserva (última: 2025-05-29 19:13:54.234000)
2025-05-29 15:14:08.018 | INFO     | etl.extract:extract_table:149 - Análisis para reserva: 3000 registros en PostgreSQL, 3000 en MongoDB
2025-05-29 15:14:08.019 | INFO     | etl.extract:extract_table:155 - No hay cambios detectados en reserva desde la última sincronización
2025-05-29 15:14:08.020 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.01 segundos
2025-05-29 15:14:08.020 | INFO     | etl.sync:sync_table:63 - No hay registros nuevos para reserva
2025-05-29 15:14:08.020 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:08.022 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para reserva, tenant 1
2025-05-29 15:14:08.022 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:08.022 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 15:14:08.023 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:14:08.023 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de venta para tenant 1
2025-05-29 15:14:08.024 | DEBUG    | utils:wrapper:81 - Ejecutando get_sync_status para tenant_id=1
2025-05-29 15:14:08.025 | DEBUG    | utils:wrapper:35 - Función get_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:08.025 | INFO     | etl.sync:sync_table:48 - Última sincronización: 2025-05-29 19:14:07.738000
2025-05-29 15:14:08.026 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:08.027 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 15:14:08.027 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:08.027 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:14:08.028 | INFO     | etl.extract:extract_table:129 - Sincronización incremental para venta (última: 2025-05-29 19:14:07.738000)
2025-05-29 15:14:08.041 | INFO     | etl.extract:extract_table:149 - Análisis para venta: 5000 registros en PostgreSQL, 5000 en MongoDB
2025-05-29 15:14:08.042 | INFO     | etl.extract:extract_table:155 - No hay cambios detectados en venta desde la última sincronización
2025-05-29 15:14:08.043 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.02 segundos
2025-05-29 15:14:08.044 | INFO     | etl.sync:sync_table:63 - No hay registros nuevos para venta
2025-05-29 15:14:08.044 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:14:08.046 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para venta, tenant 1
2025-05-29 15:14:08.046 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:14:08.047 | DEBUG    | utils:wrapper:35 - Función sync_table ejecutada en 0.02 segundos
2025-05-29 15:14:08.047 | DEBUG    | utils:wrapper:35 - Función sync_all_tables ejecutada en 0.30 segundos
2025-05-29 15:14:08.048 | INFO     | __main__:sync_scheduled:135 - Sincronización completada en 0.3s: 10 tablas exitosas, 0 errores, 0 omitidas, 0 registros procesados
2025-05-29 15:14:08.048 | INFO     | __main__:sync_scheduled:142 - Próxima sincronización programada a las 2025-05-29 15:29:08 (en 60 minutos)
2025-05-29 15:21:19.398 | INFO     | __main__:sync_scheduled:146 - Sincronización programada interrumpida por el usuario
2025-05-29 15:21:19.400 | INFO     | __main__:main:196 - Servicio finalizado. Cerrando conexiones...
2025-05-29 15:21:19.401 | INFO     | etl.extract:close:328 - Conexión a PostgreSQL cerrada
2025-05-29 15:21:19.403 | INFO     | db.mongo_client:close:194 - Conexión a MongoDB cerrada
2025-05-29 15:21:21.766 | INFO     | db.mongo_client:_connect:35 - Conexión a MongoDB establecida: mongodb://localhost:27017/
2025-05-29 15:21:21.767 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.04 segundos
2025-05-29 15:21:21.988 | INFO     | etl.extract:_connect:87 - Conexión a PostgreSQL establecida: postgresql://postgres:will@localhost:5432/microservicio_erp5
2025-05-29 15:21:21.989 | DEBUG    | utils:wrapper:35 - Función _connect ejecutada en 0.07 segundos
2025-05-29 15:21:21.991 | INFO     | __main__:main:160 - Iniciando Restaurant ML Microservice v0.1.0
2025-05-29 15:21:21.992 | INFO     | __main__:main:161 - Modo desarrollo: True
2025-05-29 15:21:21.993 | INFO     | __main__:test_connections:11 - Probando conexiones a bases de datos...
2025-05-29 15:21:21.994 | INFO     | __main__:test_connections:18 - Conexión a MongoDB funciona correctamente: versión 8.0.6
2025-05-29 15:21:21.997 | DEBUG    | utils:wrapper:35 - Función execute_query ejecutada en 0.00 segundos
2025-05-29 15:21:21.997 | INFO     | __main__:test_connections:27 - Conexión a PostgreSQL funciona correctamente
2025-05-29 15:21:21.999 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedidos
2025-05-29 15:21:22.001 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_hora_-1' creado en raw_pedidos
2025-05-29 15:21:22.002 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_detalle_id_1' creado en raw_pedido_detalles
2025-05-29 15:21:22.003 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_pedido_id_1' creado en raw_pedido_detalles
2025-05-29 15:21:22.005 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_pedido_detalles
2025-05-29 15:21:22.007 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en raw_productos
2025-05-29 15:21:22.008 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en raw_productos
2025-05-29 15:21:22.010 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_fecha_1_producto_id_1' creado en ventas_diarias
2025-05-29 15:21:22.011 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_producto_id_1' creado en ventas_diarias
2025-05-29 15:21:22.012 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_categoria_id_1' creado en ventas_diarias
2025-05-29 15:21:22.014 | INFO     | db.mongo_client:create_index:172 - Índice 'tenant_id_1_table_name_1' creado en sync_status
2025-05-29 15:21:22.014 | INFO     | db.models:create_indexes:145 - Índices creados para todas las colecciones
2025-05-29 15:21:22.015 | INFO     | __main__:main:182 - Modo desarrollo: Ejecutando sincronización inicial completa...
2025-05-29 15:21:22.015 | INFO     | __main__:test_sync:44 - Probando sincronización para tenant 1...
2025-05-29 15:21:22.015 | INFO     | __main__:test_sync:55 - Sincronizando tabla: pedido...
2025-05-29 15:21:22.016 | DEBUG    | utils:wrapper:81 - Ejecutando sync_table para tenant_id=1
2025-05-29 15:21:22.016 | INFO     | etl.sync:sync_table:39 - Iniciando sincronización de pedido para tenant 1
2025-05-29 15:21:22.017 | DEBUG    | utils:wrapper:81 - Ejecutando update_sync_status para tenant_id=1
2025-05-29 15:21:22.018 | INFO     | etl.load:update_sync_status:149 - Estado de sincronización actualizado para pedido, tenant 1
2025-05-29 15:21:22.019 | DEBUG    | utils:wrapper:35 - Función update_sync_status ejecutada en 0.00 segundos
2025-05-29 15:21:22.019 | DEBUG    | utils:wrapper:81 - Ejecutando extract_table para tenant_id=1
2025-05-29 15:21:22.019 | INFO     | etl.extract:extract_table:126 - Sincronización completa inicial para pedido
2025-05-29 15:21:22.079 | INFO     | etl.extract:_extract_all:215 - Extraídos 7449 registros de pedido para tenant 1
2025-05-29 15:21:22.080 | DEBUG    | utils:wrapper:35 - Función _extract_all ejecutada en 0.06 segundos
2025-05-29 15:21:22.081 | DEBUG    | utils:wrapper:35 - Función extract_table ejecutada en 0.06 segundos
2025-05-29 15:21:22.082 | DEBUG    | utils:wrapper:81 - Ejecutando batch_transform para tenant_id=1
2025-05-29 15:21:22.083 | DEBUG    | utils:wrapper:81 - Ejecutando transform_pedido para tenant_id=1
2025-05-29 15:21:22.106 | INFO     | etl.transform:transform_pedido:51 - Transformados 7449 registros de pedido
2025-05-29 15:21:22.107 | DEBUG    | utils:wrapper:35 - Función transform_pedido ejecutada en 0.02 segundos
2025-05-29 15:21:22.107 | DEBUG    | utils:wrapper:35 - Función batch_transform ejecutada en 0.02 segundos
2025-05-29 15:21:22.108 | DEBUG    | utils:wrapper:81 - Ejecutando load_records para tenant_id=1
2025-05-29 15:21:37.629 | INFO     | __main__:main:196 - Servicio finalizado. Cerrando conexiones...
2025-05-29 15:21:37.630 | INFO     | etl.extract:close:328 - Conexión a PostgreSQL cerrada
2025-05-29 15:21:37.634 | INFO     | db.mongo_client:close:194 - Conexión a MongoDB cerrada
